(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let r=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("rounded-2xl border border-[#64FFDA]/10 bg-[#112240]/40 backdrop-blur-lg text-white shadow-xl transition-all duration-300 hover:bg-[#112240]/60 hover:border-[#64FFDA]/30 hover:shadow-[0_0_20px_-5px_rgba(100,255,218,0.1)] group",e),...a}));r.displayName="Card";let i=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...a}));i.displayName="CardHeader";let l=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("h3",{ref:r,className:(0,s.cn)("font-bold text-xl tracking-tight text-white group-hover:text-accent transition-colors",e),...a}));l.displayName="CardTitle";let n=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("p",{ref:r,className:(0,s.cn)("text-sm text-white/60 font-medium",e),...a}));n.displayName="CardDescription";let d=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",e),...a}));d.displayName="CardContent",a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>d,"CardDescription",()=>n,"CardHeader",()=>i,"CardTitle",()=>l])},99682,e=>{"use strict";var t=e.i(71645);function a(e){let a=t.useRef({value:e,previous:e});return t.useMemo(()=>(a.current.value!==e&&(a.current.previous=a.current.value,a.current.value=e),a.current.previous),[e])}e.s(["usePrevious",()=>a])},93479,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let r=a.forwardRef(({className:e,type:a,...r},i)=>(0,t.jsx)("input",{type:a,className:(0,s.cn)("flex h-12 w-full rounded-full border border-white/10 bg-[#282828] px-4 py-3 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all shadow-inner hover:bg-[#333]",e),ref:i,...r}));r.displayName="Input",e.s(["Input",()=>r])},10204,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let r=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("label",{ref:r,className:(0,s.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...a}));r.displayName="Label",e.s(["Label",()=>r])},56909,e=>{"use strict";let t=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],56909)},16715,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},99375,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(81140),r=e.i(20783),i=e.i(30030),l=e.i(69340),n=e.i(99682),d=e.i(35804),o=e.i(48425),c="Switch",[u,h]=(0,i.createContextScope)(c),[m,f]=u(c),p=a.forwardRef((e,i)=>{let{__scopeSwitch:n,name:d,checked:u,defaultChecked:h,required:f,disabled:p,value:x="on",onCheckedChange:b,form:w,...y}=e,[j,N]=a.useState(null),k=(0,r.useComposedRefs)(i,e=>N(e)),C=a.useRef(!1),S=!j||w||!!j.closest("form"),[R,M]=(0,l.useControllableState)({prop:u,defaultProp:h??!1,onChange:b,caller:c});return(0,t.jsxs)(m,{scope:n,checked:R,disabled:p,children:[(0,t.jsx)(o.Primitive.button,{type:"button",role:"switch","aria-checked":R,"aria-required":f,"data-state":g(R),"data-disabled":p?"":void 0,disabled:p,value:x,...y,ref:k,onClick:(0,s.composeEventHandlers)(e.onClick,e=>{M(e=>!e),S&&(C.current=e.isPropagationStopped(),C.current||e.stopPropagation())})}),S&&(0,t.jsx)(v,{control:j,bubbles:!C.current,name:d,value:x,checked:R,required:f,disabled:p,form:w,style:{transform:"translateX(-100%)"}})]})});p.displayName=c;var x="SwitchThumb",b=a.forwardRef((e,a)=>{let{__scopeSwitch:s,...r}=e,i=f(x,s);return(0,t.jsx)(o.Primitive.span,{"data-state":g(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:a})});b.displayName=x;var v=a.forwardRef(({__scopeSwitch:e,control:s,checked:i,bubbles:l=!0,...o},c)=>{let u=a.useRef(null),h=(0,r.useComposedRefs)(u,c),m=(0,n.usePrevious)(i),f=(0,d.useSize)(s);return a.useEffect(()=>{let e=u.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(m!==i&&t){let a=new Event("click",{bubbles:l});t.call(e,i),e.dispatchEvent(a)}},[m,i,l]),(0,t.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i,...o,tabIndex:-1,ref:h,style:{...o.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function g(e){return e?"checked":"unchecked"}v.displayName="SwitchBubbleInput";var w=e.i(75157);let y=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)(p,{className:(0,w.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...a,ref:s,children:(0,t.jsx)(b,{className:(0,w.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));y.displayName=p.displayName,e.s(["Switch",()=>y],99375)},46138,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(36180);var s=e.i(98925),r=e.i(59141),i=e.i(22016),l=e.i(19455),n=e.i(93479),d=e.i(10204),o=e.i(99375),c=e.i(31278),u=e.i(56909),h=e.i(7233),m=e.i(27612),f=e.i(16715);let p=(0,e.i(75254).default)("bus",[["path",{d:"M8 6v6",key:"18i7km"}],["path",{d:"M15 6v6",key:"1sg6z9"}],["path",{d:"M2 12h19.6",key:"de5uta"}],["path",{d:"M18 18h3s.5-1.7.8-2.8c.1-.4.2-.8.2-1.2 0-.4-.1-.8-.2-1.2l-1.4-5C20.1 6.8 19.1 6 18 6H4a2 2 0 0 0-2 2v10h3",key:"1wwztk"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M9 18h5",key:"lrx6i"}],["circle",{cx:"16",cy:"18",r:"2",key:"1v4tcr"}]]);var x=e.i(15288),b=e.i(72498);function v(){let{classes:p}=(0,b.useMasterData)(),[v,w]=(0,a.useState)([]),[y,j]=(0,a.useState)({}),[N,k]=(0,a.useState)(!0),[C,S]=(0,a.useState)(!1),[R,M]=(0,a.useState)(!1),T=Object.values(p).map(e=>({id:e.id,name:e.name,order:e.order||99})).sort((e,t)=>e.order-t.order);(0,a.useEffect)(()=>{(async()=>{try{let e=(0,s.doc)(r.db,"config","fees"),t=await (0,s.getDoc)(e);if(t.exists()){let e=t.data();e.terms&&w(e.terms),e.transportFees&&j(e.transportFees)}}catch(e){console.error("Error fetching data:",e)}finally{k(!1)}})()},[]);let A=async()=>{S(!0);try{let t=(0,s.doc)(r.db,"config","fees");await (0,s.setDoc)(t,{terms:v,transportFees:y},{merge:!0});let{syncAllStudentLedgers:a}=await e.A(1715),i=await a(r.db);alert(`Fee structure saved and ${i} students synchronized successfully!`)}catch(e){console.error("Error saving fees:",e),alert("Failed to save.")}finally{S(!1)}},D=async()=>{if(confirm("This will synchronize fee structures for ALL students based on their class. This allows new fee terms to appear in their ledgers. Existing payments will remain safe. Continue?")){M(!0);try{let{syncAllStudentLedgers:t}=await e.A(1715),a=await t(r.db);alert(`Synced successfully for ${a} students.`)}catch(e){console.error("Sync failed:",e),alert("Sync Failed: "+e.message)}finally{M(!1)}}};return N?(0,t.jsx)("div",{className:"flex justify-center p-12",children:(0,t.jsx)(c.Loader2,{className:"w-6 h-6 animate-spin"})}):(0,t.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500 pb-20",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"font-display text-3xl font-bold",children:"Fee Management"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Configure term fees for each class and transportation."})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(l.Button,{asChild:!0,variant:"secondary",className:"h-9 border-white/10 bg-white/10 hover:bg-white/20 text-white",children:(0,t.jsx)(i.default,{href:"/admin/fees/custom",children:"Custom Fees"})}),(0,t.jsxs)(l.Button,{onClick:D,disabled:R||C,variant:"outline",className:"gap-2 border-emerald-500/20 bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20",children:[(0,t.jsx)(f.RefreshCw,{className:`w-4 h-4 ${R?"animate-spin":""}`}),R?"Syncing All...":"Sync All Students"]}),(0,t.jsxs)(l.Button,{onClick:()=>{w([...v,{id:Date.now().toString(),name:"New Term",dueDate:new Date().toISOString().split("T")[0],isActive:!0,amounts:{}}])},variant:"outline",className:"gap-2 border-white/10 bg-white/5",children:[(0,t.jsx)(h.Plus,{className:"w-4 h-4"})," Add Term"]}),(0,t.jsxs)(l.Button,{onClick:A,disabled:C,className:"gap-2 bg-accent text-accent-foreground",children:[C?(0,t.jsx)(c.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(u.Save,{className:"w-4 h-4"}),"Save Changes"]})]})]}),(0,t.jsx)("div",{className:"grid gap-6",children:v.map((e,a)=>(0,t.jsxs)(x.Card,{className:"p-6 bg-black/20 border-white/10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,t.jsx)(o.Switch,{checked:e.isActive,onCheckedChange:()=>{let e;(e=[...v])[a].isActive=!e[a].isActive,w(e)}}),(0,t.jsx)("div",{className:"flex-1 max-w-sm gap-2 flex items-center",children:(0,t.jsx)(n.Input,{value:e.name,onChange:e=>{var t;let s;return t=e.target.value,void((s=[...v])[a].name=t,w(s))},className:"font-bold text-lg h-auto py-1 px-2 -ml-2 bg-transparent border-transparent hover:border-white/10 focus:border-white/20 focus:bg-black/40 transition-all"})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n.Input,{type:"date",value:e.dueDate,onChange:e=>{let t=[...v];t[a].dueDate=e.target.value,w(t)},className:"w-40 bg-white/5 border-white/10"}),(0,t.jsx)(l.Button,{size:"icon",variant:"ghost",className:"text-red-500 hover:bg-red-500/10",onClick:()=>{let e;(e=[...v]).splice(a,1),w(e)},children:(0,t.jsx)(m.Trash2,{className:"w-4 h-4"})})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:T.map(s=>(0,t.jsxs)("div",{className:"space-y-1.5 p-3 rounded-lg bg-white/5 border border-white/5 hover:border-white/10 transition-all",children:[(0,t.jsx)(d.Label,{className:"text-xs text-muted-foreground uppercase",children:s.name}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-muted-foreground text-xs",children:"₹"}),(0,t.jsx)(n.Input,{type:"number",value:e.amounts?.[s.name]||"",onChange:e=>{var t,r;let i;return t=s.name,r=e.target.value,void((i=[...v])[a].amounts={...i[a].amounts,[t]:parseInt(r)||0},w(i))},className:"bg-black/20 border-white/10 h-8 text-sm pl-5",placeholder:"0"})]})]},s.id))})]},e.id))}),(0,t.jsx)(g,{transportFees:y,setTransportFees:j,saving:C}),0===v.length&&(0,t.jsx)("div",{className:"text-center py-20 text-muted-foreground border border-dashed border-white/10 rounded-xl",children:'No terms configured. Click "Add Term" to start.'})]})}function g({transportFees:e,setTransportFees:a,saving:s}){let{villages:r}=(0,b.useMasterData)(),i=Object.values(r).sort((e,t)=>e.name.localeCompare(t.name));return(0,t.jsxs)(x.Card,{className:"p-6 bg-black/20 border-white/10 mt-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,t.jsx)(p,{className:"w-5 h-5 text-yellow-500"}),"Transport Fees"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set annual transport fee based on village/route."})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:[i.map(s=>(0,t.jsxs)("div",{className:"space-y-1.5 p-3 rounded-lg bg-white/5 border border-white/5 hover:border-white/10 transition-all",children:[(0,t.jsx)(d.Label,{className:"text-xs text-muted-foreground uppercase truncate block",title:s.name,children:s.name}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-muted-foreground text-xs",children:"₹"}),(0,t.jsx)(n.Input,{type:"number",value:e[s.id]||"",onChange:t=>{var r,i;return r=s.id,i=t.target.value,void a({...e,[r]:parseInt(i)||0})},className:"bg-black/20 border-white/10 h-8 text-sm pl-5",placeholder:"0"})]})]},s.id)),0===i.length&&(0,t.jsx)("div",{className:"col-span-full text-muted-foreground text-sm",children:"No villages found. Add them in Master Data."})]})]})}e.s(["default",()=>v],46138)},1715,e=>{e.v(t=>Promise.all(["static/chunks/26ba210a23e8ce2c.js"].map(t=>e.l(t))).then(()=>t(24527)))}]);