(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,93479,e=>{"use strict";var s=e.i(43476),t=e.i(71645),r=e.i(75157);let a=t.forwardRef(({className:e,type:t,...a},i)=>(0,s.jsx)("input",{type:t,className:(0,r.cn)("flex h-12 w-full rounded-full border border-white/10 bg-[#282828] px-4 py-3 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all shadow-inner hover:bg-[#333]",e),ref:i,...a}));a.displayName="Input",e.s(["Input",()=>a])},29592,e=>{"use strict";var s=e.i(43476),t=e.i(71645),r=e.i(25913),a=e.i(75157);let i=(0,r.cva)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=t.forwardRef(({className:e,variant:t,...r},l)=>(0,s.jsx)("div",{ref:l,role:"alert",className:(0,a.cn)(i({variant:t}),e),...r}));l.displayName="Alert";let n=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("h5",{ref:r,className:(0,a.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));n.displayName="AlertTitle";let o=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("text-sm [&_p]:leading-relaxed",e),...t}));o.displayName="AlertDescription",e.s(["Alert",()=>l,"AlertDescription",()=>o,"AlertTitle",()=>n])},30634,e=>{"use strict";var s=e.i(43476),t=e.i(71645),r=e.i(19455),a=e.i(93479),i=e.i(29592),l=e.i(31278),n=e.i(27612),o=e.i(58041),d=e.i(78894),c=e.i(92270),m=e.i(69638),u=e.i(32341),g=e.i(18566);e.i(36180);var x=e.i(98925);e.i(1465);var f=e.i(34991),h=e.i(59141);function p(){let{user:e,signOut:p}=(0,u.useAuth)(),b=(0,g.useRouter)(),[v,j]=(0,t.useState)(""),[N,y]=(0,t.useState)(!1),[w,A]=(0,t.useState)("IDLE"),[E,L]=(0,t.useState)(""),T=async()=>{if("DELETE ALL DATA"===v.trim()){y(!0);try{if(!e){alert("Login required"),y(!1);return}L("Starting Client-Side Purge..."),await Promise.all(["master","siteContent","analytics","notifications","chats","presence","config","settings","demo_state"].map(e=>(0,f.remove)((0,f.ref)(h.rtdb,e))));let s=0;for(let e of["students","teachers","staff","usersBySchoolId","designations","student_fee_ledgers","payments","invoices","transactions","fee_structures","fee_types","attendance","leaves","class_timetables","teacher_schedules","substitutions","homework","homework_submissions","exam_results","grades","subjects","announcements","events","notifications","audit_logs","notices","reports","feedback","enquiries","applications","config","villages","classes","sections","leave_requests","payroll","salary_adjustments","salary_payments","expenses","custom_fees","master_classes","search_index","site_config","vouchers"]){let t=await (0,x.getDocs)((0,x.collection)(h.db,e));if(t.empty)continue;let r=(0,x.writeBatch)(h.db);t.docs.forEach(e=>{r.delete(e.ref),s++}),await r.commit()}let t=await (0,x.getDocs)((0,x.collection)(h.db,"users")),r=(0,x.writeBatch)(h.db),a=0;t.docs.forEach(s=>{let t=s.data(),i=t.email?.toLowerCase();s.id!==e.uid&&"spoorthy@school.local"!==i&&(r.delete(s.ref),a++)}),a>0&&await r.commit(),L(`Purge Complete! Deleted ${s} records and ${a} users via Client Connection.`),A("DONE")}catch(e){console.error("Client Purge Error:",e),alert("Error: "+e.message)}finally{y(!1)}}};return console.log("Rendering StoragePurgePage (Client Mode)"),(0,s.jsxs)("div",{className:"max-w-4xl space-y-8 animate-in fade-in duration-500 pb-20",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"font-display text-3xl font-bold",children:"Storage & Purge"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Manage system storage and perform data retention tasks."})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(0,s.jsxs)("div",{className:"bg-white/5 border border-white/10 p-6 rounded-xl",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)("div",{className:"p-2 bg-blue-500/10 text-blue-500 rounded-lg",children:(0,s.jsx)(o.Database,{className:"w-5 h-5"})}),(0,s.jsx)("h3",{className:"font-medium",children:"Total Storage"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:"-- / 5 GB"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Files, Backups, & Media"})]})}),(0,s.jsxs)("div",{className:"border border-red-500/30 bg-red-500/5 rounded-xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"bg-red-500/10 p-4 border-b border-red-500/20 flex items-center gap-2",children:[(0,s.jsx)(d.AlertTriangle,{className:"text-red-500 w-5 h-5"}),(0,s.jsx)("h2",{className:"font-bold text-red-500",children:"Danger Zone: Factory Reset"})]}),(0,s.jsx)("div",{className:"p-6 space-y-6",children:"IDLE"===w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.Alert,{variant:"destructive",className:"bg-red-500/10 border-red-500/20 text-red-200",children:[(0,s.jsx)(i.AlertTitle,{children:"This action is irreversible"}),(0,s.jsxs)(i.AlertDescription,{children:["Performing a Factory Reset will permanently delete ",(0,s.jsx)("strong",{children:"ALL"})," data including students, teachers, payments, and settings.",(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Only Admin Accounts will be preserved."})," Use this only for a fresh start."]})]}),(0,s.jsxs)("div",{className:"space-y-4 max-w-md",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"text-sm font-medium text-red-400",children:["Type ",(0,s.jsx)("span",{className:"font-mono font-bold select-all",children:"DELETE ALL DATA"})," to confirm"]}),(0,s.jsx)(a.Input,{value:v,onChange:e=>j(e.target.value),className:"bg-black/40 border-red-500/30 text-red-500 font-mono placeholder:text-red-500/30",placeholder:"DELETE ALL DATA"})]}),(0,s.jsxs)(r.Button,{variant:"destructive",className:"w-full gap-2",disabled:"DELETE ALL DATA"!==v.trim()||N,onClick:T,children:[N?(0,s.jsx)(l.Loader2,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(n.Trash2,{className:"w-4 h-4"}),N?"Purging via Client Connection...":"NUCLEAR RESET (CLIENT MODE)"]})]})]}):(0,s.jsxs)("div",{className:"text-center py-10 space-y-4 bg-green-500/10 rounded-lg border border-green-500/20",children:[(0,s.jsx)(m.CheckCircle,{className:"w-16 h-16 text-green-500 mx-auto"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-green-500",children:"System Reset Complete"}),(0,s.jsx)("p",{className:"text-green-400/80 font-mono text-sm max-w-lg mx-auto",children:E}),(0,s.jsxs)(r.Button,{onClick:async()=>{await p(),b.push("/login")},variant:"outline",className:"border-green-500/30 text-green-400 hover:bg-green-500/20",children:[(0,s.jsx)(c.LogOut,{className:"w-4 h-4 mr-2"}),"Logout & Refresh"]})]})})]})]})}e.s(["default",()=>p])}]);