(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19455,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(91918),r=e.i(75157);let i=s.forwardRef(({className:e,variant:s="default",size:i="default",asChild:d=!1,...l},o)=>{let n=d?a.Slot:"button";return(0,t.jsx)(n,{className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-full text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 tracking-wide",{"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:scale-105 active:scale-95 transition-transform":"default"===s,"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm":"destructive"===s,"border border-white/20 bg-transparent hover:bg-white/10 hover:text-accent-foreground":"outline"===s,"bg-secondary text-secondary-foreground hover:bg-secondary/80":"secondary"===s,"hover:bg-white/10 hover:text-accent font-normal":"ghost"===s,"text-primary underline-offset-4 hover:underline":"link"===s,"bg-gradient-to-r from-accent to-accent/80 text-black font-bold hover:brightness-110 border-0 shadow-lg hover:shadow-accent/20":"gradient"===s,"bg-accent text-black font-bold hover:bg-accent/90 hover:scale-105 active:scale-95 transition-transform shadow-lg":"spotify"===s,"h-10 px-6 py-2":"default"===i,"h-9 px-4 text-xs":"sm"===i,"h-12 px-8 text-base":"lg"===i,"h-14 px-10 text-lg":"xl"===i,"h-10 w-10":"icon"===i},e),ref:o,...l})});i.displayName="Button",e.s(["Button",()=>i])},15288,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75157);let r=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("rounded-2xl border border-[#64FFDA]/10 bg-[#112240]/40 backdrop-blur-lg text-white shadow-xl transition-all duration-300 hover:bg-[#112240]/60 hover:border-[#64FFDA]/30 hover:shadow-[0_0_20px_-5px_rgba(100,255,218,0.1)] group",e),...s}));r.displayName="Card";let i=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...s}));i.displayName="CardHeader";let d=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("h3",{ref:r,className:(0,a.cn)("font-bold text-xl tracking-tight text-white group-hover:text-accent transition-colors",e),...s}));d.displayName="CardTitle";let l=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-white/60 font-medium",e),...s}));l.displayName="CardDescription";let o=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent",s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>o,"CardDescription",()=>l,"CardHeader",()=>i,"CardTitle",()=>d])},3281,e=>{"use strict";let t=(0,e.i(75254).default)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);e.s(["Printer",()=>t],3281)},61911,e=>{"use strict";let t=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>t],61911)},96139,e=>{"use strict";let t=(0,e.i(75254).default)("coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);e.s(["Coffee",()=>t],96139)},57222,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(32341),r=e.i(15288),i=e.i(19455),d=e.i(87486),l=e.i(31278),o=e.i(61911),n=e.i(96139),c=e.i(3281);e.i(36180);var h=e.i(98925),u=e.i(59141),x=e.i(72498);function m(){let{user:e}=(0,a.useAuth)(),{subjects:m,classes:f,sections:p}=(0,x.useMasterData)(),[b,g]=(0,s.useState)(null),[y,w]=(0,s.useState)([]),[j,v]=(0,s.useState)(!0),[N,C]=(0,s.useState)(""),[D,k]=(0,s.useState)(""),[S,I]=(0,s.useState)({}),[T,A]=(0,s.useState)([]);(0,s.useEffect)(()=>{e&&(M(),R(),H())},[e]);let H=async()=>{try{let e=(0,h.query)((0,h.collection)(u.db,"notices"),(0,h.where)("type","==","HOLIDAY")),t=await (0,h.getDocs)(e);A(t.docs.map(e=>({id:e.id,...e.data()})))}catch(e){console.error(e)}},R=async()=>{try{let e=(0,h.query)((0,h.collection)(u.db,"teachers")),t=await (0,h.getDocs)(e),s={};t.docs.forEach(e=>{let t=e.data();t.schoolId&&(s[t.schoolId]=t.name),s[e.id]=t.name}),I(s)}catch(e){console.error("Error fetching teachers:",e)}},M=async()=>{try{let t=await fetch("/api/timetable/my-schedule",{headers:{Authorization:`Bearer ${await e?.getIdToken()}`}}),s=await t.json();s.success&&(g(s.data.weeklySchedule||{}),w(s.data.substitutions||[]),C(s.data.classId),k(s.data.sectionId))}catch(e){console.error(e)}finally{v(!1)}},$=e=>T.some(t=>{let s=t.date?.seconds?new Date(1e3*t.date.seconds):t.createdAt?.seconds?new Date(1e3*t.createdAt.seconds):new Date,a=t.expiresAt?.seconds?new Date(1e3*t.expiresAt.seconds):new Date;return s.setHours(0,0,0,0),a.setHours(23,59,59,999),e>=s&&e<=a}),E=(()=>{let e=new Date,t=e.toLocaleDateString("en-US",{weekday:"long"}).toUpperCase(),s=new Date,a=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`;if($(e))return{dayName:t,dateKey:a,slots:[],isHoliday:!0};if(!b||!b[t])return{dayName:t,slots:[]};let r=[],i=b[t]||{};for(let e=1;e<=8;e++){let t=i[e];if(!t)continue;let s=y.find(t=>t.date===a&&t.slotId===e);r.push({id:e,...t,substitution:s})}return{dayName:t,dateKey:a,slots:r,isHoliday:!1}})();return j?(0,t.jsx)("div",{className:"p-10 flex justify-center",children:(0,t.jsx)(l.Loader2,{className:"animate-spin"})}):(0,t.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto p-4 md:p-6 animate-in fade-in",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-display font-bold",children:"My Timetable"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:[f[N]?.name||`Class ${N}`,D&&p&&p[D]?` (${p[D].name})`:""]})]}),(0,t.jsxs)(i.Button,{onClick:()=>window.print(),variant:"outline",className:"gap-2 print:hidden bg-white/5 border-white/10 hover:bg-white/10 hover:text-white",children:[(0,t.jsx)(c.Printer,{className:"w-4 h-4"})," Print Timetable"]})]}),(0,t.jsxs)(r.Card,{className:`print:hidden overflow-hidden relative border-white/10 ${E.isHoliday?"bg-red-500/10 border-red-500/20":"bg-black/20"}`,children:[(0,t.jsx)("div",{className:`absolute top-0 left-0 w-1 h-full ${E.isHoliday?"bg-red-500":"bg-emerald-500"}`}),(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)(r.CardTitle,{className:"flex justify-between items-center",children:[(0,t.jsxs)("span",{children:["Today (",E.dayName,")"]}),(0,t.jsx)("span",{className:"text-sm font-normal text-muted-foreground",children:E.dateKey})]})}),(0,t.jsx)(r.CardContent,{children:E.isHoliday?(0,t.jsxs)("div",{className:"py-12 flex flex-col items-center justify-center text-red-400 gap-4",children:[(0,t.jsx)(n.Coffee,{className:"w-12 h-12 opacity-50"}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold uppercase tracking-widest",children:"Holiday"}),(0,t.jsx)("p",{className:"text-sm text-red-400/60 mt-1",children:"School is closed for today. Enjoy your break!"})]})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:0===E.slots.length?(0,t.jsx)("p",{className:"text-muted-foreground",children:"No classes scheduled for today."}):E.slots.map(e=>{let s=!!e.substitution,a=s&&"LEISURE"===e.substitution.resolutionType,r=a||"leisure"===e.subjectId?"leisure":e.subjectId,i=m[r]?.name||r;return(0,t.jsxs)("div",{className:`p-4 rounded-lg border flex flex-col gap-2 ${s?"bg-yellow-500/10 border-yellow-500/30":"bg-white/5 border-white/10"}`,children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("span",{className:"text-xs font-bold text-muted-foreground",children:["Period ",e.id]}),s&&(0,t.jsx)(d.Badge,{variant:"outline",className:"text-[10px] bg-yellow-500/20 text-yellow-500 border-yellow-500/50",children:"Changed"})]}),(0,t.jsx)("div",{className:"font-bold text-lg truncate",children:a||"leisure"===r?(0,t.jsxs)("span",{className:"flex items-center gap-2 text-emerald-400 font-medium",children:[(0,t.jsx)(n.Coffee,{className:"w-5 h-5"})," Free Period"]}):(0,t.jsx)("span",{className:"capitalize",children:i})}),!a&&"leisure"!==r&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(o.Users,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"truncate",children:s&&e.substitution.substituteTeacherId?S[e.substitution.substituteTeacherId]||e.substitution.substituteTeacherId:S[e.teacherId]||e.teacherId||"No Teacher"})]})]},e.id)})})})]}),(0,t.jsxs)(r.Card,{className:"bg-black/20 border-white/10",children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Weekly Schedule"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-white/10",children:[(0,t.jsx)("th",{className:"p-3 text-left",children:"Day"}),[1,2,3,4,5,6,7,8].map(e=>(0,t.jsxs)("th",{className:"p-3 text-center",children:["P",e]},e))]})}),(0,t.jsx)("tbody",{children:["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"].map((e,s)=>{let a=new Date,r=a.getDay(),i=new Date(a);i.setDate(a.getDate()+(s+1-r));let d=$(i);return(0,t.jsxs)("tr",{className:`border-b border-white/5 transition-colors ${d?"bg-red-500/5":"hover:bg-white/5"}`,children:[(0,t.jsxs)("td",{className:"p-3 font-medium text-muted-foreground flex flex-col",children:[(0,t.jsx)("span",{children:e.substring(0,3)}),(0,t.jsx)("span",{className:"text-[10px] opacity-40 font-normal",children:i.toLocaleDateString([],{month:"short",day:"numeric"})})]}),d?(0,t.jsx)("td",{colSpan:8,className:"p-3 text-center text-red-400/80 font-bold uppercase tracking-widest text-[10px]",children:"Holiday"}):[1,2,3,4,5,6,7,8].map(s=>{let a=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`,r=y.find(e=>e.date===a&&e.slotId===s),d=b?.[e]?.[s];if(r){let e="LEISURE"===r.resolutionType;return(0,t.jsxs)("td",{className:"p-3 text-center border-l border-white/5 bg-yellow-500/10",children:[(0,t.jsx)("div",{className:"font-semibold text-yellow-500",children:e?"Free Period":m[d?.subjectId]?.name||d?.subjectId}),!e&&(0,t.jsx)("div",{className:"text-[10px] text-yellow-500/60 font-medium",children:S[r.substituteTeacherId]||r.substituteTeacherId})]},s)}return d?"BREAK"===d.type?(0,t.jsx)("td",{className:"p-3 bg-white/5 text-center text-[10px] diagonal-stripe opacity-50"},s):(0,t.jsxs)("td",{className:"p-3 text-center border-l border-white/5",children:[(0,t.jsx)("div",{className:"font-semibold",children:"leisure"===d.subjectId?"Leisure":m[d.subjectId]?.name||d.subjectId}),(0,t.jsx)("div",{className:"text-[10px] text-muted-foreground",children:S[d.teacherId]||d.teacherId})]},s):(0,t.jsx)("td",{className:"p-3"},s)})]},e)})})]})})})]})]})}e.s(["default",()=>m])}]);