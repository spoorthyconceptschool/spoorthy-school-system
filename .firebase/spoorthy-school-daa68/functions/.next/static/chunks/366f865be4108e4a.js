(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7585,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(19455),i=e.i(15288),r=e.i(87316),n=e.i(72520),l=e.i(69638),o=e.i(78894),c=e.i(31278),d=e.i(7233),h=e.i(88699),x=e.i(27516),m=e.i(25652),u=e.i(61911),p=e.i(76639),g=e.i(87486),f=e.i(93479),b=e.i(10204),j=e.i(67489),w=e.i(32341),v=e.i(1851),y={};!function e(t,a,s,i){var r,n,l,o,c,d,h,x,m,u,p,g=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),f="function"==typeof Path2D&&"function"==typeof DOMMatrix;function b(){}function j(e){var s=a.exports.Promise,i=void 0!==s?s:t.Promise;return"function"==typeof i?new i(e):(e(b,b),null)}var w=(r=function(){if(!t.OffscreenCanvas)return!1;try{var e=new OffscreenCanvas(1,1),a=e.getContext("2d");a.fillRect(0,0,1,1);var s=e.transferToImageBitmap();a.createPattern(s,"no-repeat")}catch(e){return!1}return!0}(),n=new Map,{transform:function(e){if(r)return e;if(n.has(e))return n.get(e);var t=new OffscreenCanvas(e.width,e.height);return t.getContext("2d").drawImage(e,0,0),n.set(e,t),t},clear:function(){n.clear()}}),v=(c=Math.floor(1e3/60),d={},h=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(l=function(e){var t=Math.random();return d[t]=requestAnimationFrame(function a(s){h===s||h+c-1<s?(h=s,delete d[t],e()):d[t]=requestAnimationFrame(a)}),t},o=function(e){d[e]&&cancelAnimationFrame(d[e])}):(l=function(e){return setTimeout(e,c)},o=function(e){return clearTimeout(e)}),{frame:l,cancel:o}),y=(u={},function(){if(x)return x;if(!s&&g){var t=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {\n  if (msg.data.options) {\n    CONFETTI(msg.data.options).then(function () {\n      if (msg.data.callback) {\n        postMessage({ callback: msg.data.callback });\n      }\n    });\n  } else if (msg.data.reset) {\n    CONFETTI && CONFETTI.reset();\n  } else if (msg.data.resize) {\n    SIZE.width = msg.data.resize.width;\n    SIZE.height = msg.data.resize.height;\n  } else if (msg.data.canvas) {\n    SIZE.width = msg.data.canvas.width;\n    SIZE.height = msg.data.canvas.height;\n    CONFETTI = module.exports.create(msg.data.canvas);\n  }\n}"].join("\n");try{x=new Worker(URL.createObjectURL(new Blob([t])))}catch(e){return"u">typeof console&&"function"==typeof console.warn&&console.warn("ðŸŽŠ Could not load worker",e),null}var a=x;function i(e,t){a.postMessage({options:e||{},callback:t})}a.init=function(e){var t=e.transferControlToOffscreen();a.postMessage({canvas:t},[t])},a.fire=function(e,t,s){if(m)return i(e,null),m;var r=Math.random().toString(36).slice(2);return m=j(function(t){function n(e){e.data.callback===r&&(delete u[r],a.removeEventListener("message",n),m=null,w.clear(),s(),t())}a.addEventListener("message",n),i(e,r),u[r]=n.bind(null,{data:{callback:r}})})},a.reset=function(){for(var e in a.postMessage({reset:!0}),u)u[e](),delete u[e]}}return x}),N={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function S(e,t,a){var s;return s=e&&null!=e[t]?e[t]:N[t],a?a(s):s}function C(e){return e<0?0:Math.floor(e)}function M(e){return parseInt(e,16)}function k(e){return e.map(D)}function D(e){var t=String(e).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:M(t.substring(0,2)),g:M(t.substring(2,4)),b:M(t.substring(4,6))}}function z(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function T(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function E(e,a){var r,n=!e,l=!!S(a||{},"resize"),o=!1,c=S(a,"disableForReducedMotion",Boolean),d=g&&S(a||{},"useWorker")?y():null,h=n?z:T,x=!!e&&!!d&&!!e.__confetti_initialized,m="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function u(a){var u,p=c||S(a,"disableForReducedMotion",Boolean),g=S(a,"zIndex",Number);if(p&&m)return j(function(e){e()});n&&r?e=r.canvas:n&&!e&&((u=document.createElement("canvas")).style.position="fixed",u.style.top="0px",u.style.left="0px",u.style.pointerEvents="none",u.style.zIndex=g,e=u,document.body.appendChild(e)),l&&!x&&h(e);var b={width:e.width,height:e.height};function y(){if(d){var t={getBoundingClientRect:function(){if(!n)return e.getBoundingClientRect()}};h(t),d.postMessage({resize:{width:t.width,height:t.height}});return}b.width=b.height=null}function N(){r=null,l&&(o=!1,t.removeEventListener("resize",y)),n&&e&&(document.body.contains(e)&&document.body.removeChild(e),e=null,x=!1)}return(d&&!x&&d.init(e),x=!0,d&&(e.__confetti_initialized=!0),l&&!o&&(o=!0,t.addEventListener("resize",y,!1)),d)?d.fire(a,b,N):function(t,a,n){for(var l,o,c,d,x,m,u,p=S(t,"particleCount",C),g=S(t,"angle",Number),b=S(t,"spread",Number),y=S(t,"startVelocity",Number),N=S(t,"decay",Number),M=S(t,"gravity",Number),D=S(t,"drift",Number),z=S(t,"colors",k),T=S(t,"ticks",Number),E=S(t,"shapes"),I=S(t,"scalar"),A=!!S(t,"flat"),P=((l=S(t,"origin",Object)).x=S(l,"x",Number),l.y=S(l,"y",Number),l),L=p,O=[],B=e.width*P.x,R=e.height*P.y;L--;)O.push(function(e){var t=e.angle*(Math.PI/180),a=e.spread*(Math.PI/180);return{x:e.x,y:e.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*e.startVelocity+Math.random()*e.startVelocity,angle2D:-t+(.5*a-Math.random()*a),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:e.color,shape:e.shape,tick:0,totalTicks:e.ticks,decay:e.decay,drift:e.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*e.gravity,ovalScalar:.6,scalar:e.scalar,flat:e.flat}}({x:B,y:R,angle:g,spread:b,startVelocity:y,color:z[L%z.length],shape:E[Math.floor(Math.random()*(E.length-0))+0],ticks:T,decay:N,gravity:M,drift:D,scalar:I,flat:A}));return r?r.addFettis(O):(o=e,x=O.slice(),m=o.getContext("2d"),u=j(function(e){function t(){c=d=null,m.clearRect(0,0,a.width,a.height),w.clear(),n(),e()}c=v.frame(function e(){s&&(a.width!==i.width||a.height!==i.height)&&(a.width=o.width=i.width,a.height=o.height=i.height),a.width||a.height||(h(o),a.width=o.width,a.height=o.height),m.clearRect(0,0,a.width,a.height),(x=x.filter(function(e){return function(e,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var a,s,i,r,n,l,o,c,d,h,x,m,u,p,g,b,j=t.tick++/t.totalTicks,v=t.x+t.random*t.tiltCos,y=t.y+t.random*t.tiltSin,N=t.wobbleX+t.random*t.tiltCos,S=t.wobbleY+t.random*t.tiltSin;if(e.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-j)+")",e.beginPath(),f&&"path"===t.shape.type&&"string"==typeof t.shape.path&&Array.isArray(t.shape.matrix)){e.fill((a=t.shape.path,s=t.shape.matrix,i=t.x,r=t.y,n=.1*Math.abs(N-v),l=.1*Math.abs(S-y),o=Math.PI/10*t.wobble,c=new Path2D(a),(d=new Path2D).addPath(c,new DOMMatrix(s)),(h=new Path2D).addPath(d,new DOMMatrix([Math.cos(o)*n,Math.sin(o)*n,-Math.sin(o)*l,Math.cos(o)*l,i,r])),h))}else if("bitmap"===t.shape.type){var C=Math.PI/10*t.wobble,M=.1*Math.abs(N-v),k=.1*Math.abs(S-y),D=t.shape.bitmap.width*t.scalar,z=t.shape.bitmap.height*t.scalar,T=new DOMMatrix([Math.cos(C)*M,Math.sin(C)*M,-Math.sin(C)*k,Math.cos(C)*k,t.x,t.y]);T.multiplySelf(new DOMMatrix(t.shape.matrix));var E=e.createPattern(w.transform(t.shape.bitmap),"no-repeat");E.setTransform(T),e.globalAlpha=1-j,e.fillStyle=E,e.fillRect(t.x-D/2,t.y-z/2,D,z),e.globalAlpha=1}else if("circle"===t.shape)e.ellipse?e.ellipse(t.x,t.y,Math.abs(N-v)*t.ovalScalar,Math.abs(S-y)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):(x=t.x,m=t.y,u=Math.abs(N-v)*t.ovalScalar,p=Math.abs(S-y)*t.ovalScalar,g=Math.PI/10*t.wobble,b=2*Math.PI,e.save(),e.translate(x,m),e.rotate(g),e.scale(u,p),e.arc(0,0,1,0,b,void 0),e.restore());else if("star"===t.shape)for(var I=Math.PI/2*3,A=4*t.scalar,P=8*t.scalar,L=t.x,O=t.y,B=5,R=Math.PI/5;B--;)L=t.x+Math.cos(I)*P,O=t.y+Math.sin(I)*P,e.lineTo(L,O),I+=R,L=t.x+Math.cos(I)*A,O=t.y+Math.sin(I)*A,e.lineTo(L,O),I+=R;else e.moveTo(Math.floor(t.x),Math.floor(t.y)),e.lineTo(Math.floor(t.wobbleX),Math.floor(y)),e.lineTo(Math.floor(N),Math.floor(S)),e.lineTo(Math.floor(v),Math.floor(t.wobbleY));return e.closePath(),e.fill(),t.tick<t.totalTicks}(m,e)})).length?c=v.frame(e):t()}),d=t}),(r={addFettis:function(e){return x=x.concat(e),u},canvas:o,promise:u,reset:function(){c&&v.cancel(c),d&&d()}}).promise)}(a,b,N)}return u.reset=function(){d&&d.reset(),r&&r.reset()},u}function I(){return p||(p=E(null,{useWorker:!0,resize:!0})),p}a.exports=function(){return I().apply(this,arguments)},a.exports.reset=function(){I().reset()},a.exports.create=E,a.exports.shapeFromPath=function(e){if(!f)throw Error("path confetti are not supported in this browser");"string"==typeof e?s=e:(s=e.path,i=e.matrix);var t=new Path2D(s),a=document.createElement("canvas").getContext("2d");if(!i){for(var s,i,r,n,l=1e3,o=1e3,c=0,d=0,h=0;h<1e3;h+=2)for(var x=0;x<1e3;x+=2)a.isPointInPath(t,h,x,"nonzero")&&(l=Math.min(l,h),o=Math.min(o,x),c=Math.max(c,h),d=Math.max(d,x));r=c-l;var m=Math.min(10/r,10/(n=d-o));i=[m,0,0,m,-Math.round(r/2+l)*m,-Math.round(n/2+o)*m]}return{type:"path",path:s,matrix:i}},a.exports.shapeFromText=function(e){var t,a=1,s="#000000",i='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';"string"==typeof e?t=e:(t=e.text,a="scalar"in e?e.scalar:a,i="fontFamily"in e?e.fontFamily:i,s="color"in e?e.color:s);var r=10*a,n=""+r+"px "+i,l=new OffscreenCanvas(r,r),o=l.getContext("2d");o.font=n;var c=o.measureText(t),d=Math.ceil(c.actualBoundingBoxRight+c.actualBoundingBoxLeft),h=Math.ceil(c.actualBoundingBoxAscent+c.actualBoundingBoxDescent),x=c.actualBoundingBoxLeft+2,m=c.actualBoundingBoxAscent+2;d+=4,h+=4,(o=(l=new OffscreenCanvas(d,h)).getContext("2d")).font=n,o.fillStyle=s,o.fillText(t,x,m);var u=1/a;return{type:"bitmap",bitmap:l.transferToImageBitmap(),matrix:[u,0,0,u,-d*u/2,-h*u/2]}}}(function(){return"u">typeof window?window:"u">typeof self?self:this||{}}(),y,!1);let N=y.exports;function S(){let{user:e}=(0,w.useAuth)(),[y,S]=(0,a.useState)([]),[C,M]=(0,a.useState)(!0),[k,D]=(0,a.useState)(!1),[z,T]=(0,a.useState)(""),[E,I]=(0,a.useState)("SETUP"),[A,P]=(0,a.useState)(null),[L,O]=(0,a.useState)(!1),[B,R]=(0,a.useState)(""),[U,F]=(0,a.useState)(!1),[_,V]=(0,a.useState)(!1),[Y,H]=(0,a.useState)(null),[G,$]=(0,a.useState)({label:"",startDate:"",endDate:""}),[q,J]=(0,a.useState)(!1),X=async()=>{try{let t=await e?.getIdToken(),a=await fetch("/api/admin/academic-years/history",{headers:{Authorization:`Bearer ${t}`}});if(a.ok){let e=await a.json();S(e.years||[])}}catch(e){console.error("Failed to fetch years",e)}finally{M(!1)}};(0,a.useEffect)(()=>{e&&X()},[e]);let W=async()=>{if(B){F(!0);try{let t=await e?.getIdToken(),a=await fetch("/api/admin/academic-years/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({yearLabel:B})}),s=await a.json();s.success?(O(!1),R(""),X()):alert(s.error)}catch(e){alert(e.message)}finally{F(!1)}}},Z=async()=>{if(z){I("EXECUTING");try{let t=await e?.getIdToken(),a=await fetch("/api/admin/academic-years/start-new",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({newYearLabel:z})}),s=await a.json();s.success?(P(s.stats),I("DONE"),N({particleCount:150,spread:80,origin:{y:.6},colors:["#3b82f6","#10b981","#ffffff"]}),await X()):(alert("Error: "+s.error),I("SETUP"))}catch(e){alert("Error: "+e.message),I("SETUP")}}},K=e=>{H(e),$({label:e.year,startDate:e.startDate?new Date(e.startDate).toISOString().split("T")[0]:"",endDate:e.endDate?new Date(e.endDate).toISOString().split("T")[0]:""}),V(!0)},Q=async()=>{if(Y){J(!0);try{let t={targetYear:Y.year,newLabel:G.label,startDate:G.startDate?new Date(G.startDate).toISOString():null,endDate:G.endDate?new Date(G.endDate).toISOString():null},a=await e?.getIdToken(),s=await fetch("/api/admin/academic-years/update",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(t)}),i=await s.json();i.success?(V(!1),H(null),X()):alert(i.error)}catch(e){alert(e.message)}finally{J(!1)}}},ee=y.find(e=>e.isActive),et=y.filter(e=>e.isUpcoming),ea=y.filter(e=>!e.isActive&&!e.isUpcoming).sort((e,t)=>t.year.localeCompare(e.year));return(0,t.jsxs)("div",{className:"space-y-4 md:space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-end gap-3 md:gap-0",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-0.5 md:mb-1",children:[(0,t.jsx)(x.History,{className:"w-4 h-4 md:w-5 md:h-5 text-blue-400"}),(0,t.jsx)("h2",{className:"text-base md:text-xl font-bold text-white",children:"Academic Lifecycle"})]}),(0,t.jsx)("p",{className:"text-[10px] md:text-sm text-slate-400",children:"Archiving, student promotion, and multi-year management."})]}),(0,t.jsxs)("div",{className:"flex gap-2 md:gap-3",children:[(0,t.jsxs)(s.Button,{onClick:()=>O(!0),variant:"outline",className:"bg-slate-900/50 border-slate-800 text-slate-300 hover:text-white h-8 md:h-10 text-[10px] md:text-sm px-2 md:px-4",children:[(0,t.jsx)(d.Plus,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"})," Define New Year"]}),(0,t.jsxs)(s.Button,{onClick:()=>{T(et[0]?.year||""),D(!0),I("SETUP")},variant:"default",className:"bg-blue-600 hover:bg-blue-500 text-white shadow-xl shadow-blue-500/20 h-8 md:h-10 text-[10px] md:text-sm px-2 md:px-4",disabled:0===et.length,children:[(0,t.jsx)(m.TrendingUp,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"})," Start Transition"]})]})]}),ee&&(0,t.jsxs)(i.Card,{className:"overflow-hidden border-white/10 bg-gradient-to-br from-indigo-900/20 via-zinc-900/40 to-black/40 backdrop-blur-xl relative group shadow-2xl ring-1 ring-white/5",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-indigo-500/10 via-transparent to-transparent opacity-50"}),(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",className:"absolute top-3 right-3 z-10 text-zinc-500 hover:text-white hover:bg-white/10 w-8 h-8 rounded-full transition-all",onClick:()=>K(ee),children:(0,t.jsx)(h.Pencil,{className:"w-3.5 h-3.5"})}),(0,t.jsxs)(i.CardContent,{className:"p-5 md:p-8 flex items-center justify-between relative z-0",children:[(0,t.jsxs)("div",{className:"space-y-3 md:space-y-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-center gap-3 mb-2",children:(0,t.jsx)(g.Badge,{className:"bg-emerald-500/10 text-emerald-400 border-emerald-500/20 px-2.5 py-0.5 text-[9px] font-bold tracking-widest uppercase shadow-[0_0_10px_rgba(16,185,129,0.2)]",children:"Live Session"})}),(0,t.jsx)("h3",{className:"text-3xl md:text-6xl font-mono font-bold text-white tracking-tighter drop-shadow-xl",children:ee.year})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-4 md:gap-8 pt-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-zinc-400 bg-black/20 px-3 py-1.5 rounded-full border border-white/5",children:[(0,t.jsx)(r.Calendar,{className:"w-3.5 h-3.5 text-indigo-400"}),(0,t.jsxs)("span",{className:"text-[10px] md:text-xs font-medium",children:["Started ",ee.startDate?(0,v.format)(new Date(ee.startDate),"MMM d, yyyy"):"Recently"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-zinc-400 bg-black/20 px-3 py-1.5 rounded-full border border-white/5",children:[(0,t.jsx)(u.Users,{className:"w-3.5 h-3.5 text-indigo-400"}),(0,t.jsx)("span",{className:"text-[10px] md:text-xs font-medium",children:"Full Enrolment"})]})]})]}),(0,t.jsxs)("div",{className:"hidden md:flex flex-col items-center gap-2",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-b from-emerald-500/20 to-emerald-500/5 border border-emerald-500/20 flex items-center justify-center shadow-[0_0_15px_rgba(16,185,129,0.15)]",children:(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-emerald-400 animate-pulse box-shadow-[0_0_8px_#34d399]"})}),(0,t.jsx)("span",{className:"text-[10px] uppercase tracking-widest text-emerald-500/80 font-bold",children:"Active"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:gap-8",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("h3",{className:"text-[10px] md:text-xs font-bold text-zinc-500 uppercase tracking-widest pl-1 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"})," Planned Sessions"]}),(0,t.jsx)("div",{className:"space-y-2",children:et.length>0?et.map(e=>(0,t.jsxs)("div",{className:"p-3 md:p-4 rounded-xl border border-white/5 bg-zinc-900/30 flex items-center justify-between group hover:bg-zinc-900/50 hover:border-indigo-500/20 transition-all cursor-default",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 md:gap-4",children:[(0,t.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-indigo-500/10 flex items-center justify-center text-indigo-400 border border-indigo-500/10 group-hover:scale-110 transition-transform",children:(0,t.jsx)(d.Plus,{className:"w-4 h-4 md:w-5 md:h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-mono text-sm md:text-base font-bold text-zinc-200 group-hover:text-white transition-colors",children:e.year}),(0,t.jsx)("p",{className:"text-[9px] text-zinc-500 hidden md:block",children:"Scheduled for future deployment"})]})]}),(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-600 hover:text-zinc-300 hover:bg-white/5 rounded-lg",onClick:()=>K(e),children:(0,t.jsx)(h.Pencil,{className:"w-3.5 h-3.5"})})]},e.year)):(0,t.jsx)("div",{className:"p-6 border border-dashed border-zinc-800 rounded-xl text-center",children:(0,t.jsx)("p",{className:"text-zinc-600 text-[10px] md:text-xs",children:"No future academic years defined."})})})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("h3",{className:"text-[10px] md:text-xs font-bold text-zinc-500 uppercase tracking-widest pl-1 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-zinc-600"})," Archives"]}),(0,t.jsx)("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:ea.map(e=>(0,t.jsxs)("div",{className:"p-3 md:p-4 rounded-xl border border-white/5 bg-black/20 flex items-center justify-between group grayscale hover:grayscale-0 transition-all hover:bg-zinc-900/40",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-mono text-sm md:text-base font-bold text-zinc-500 group-hover:text-zinc-300 transition-colors",children:e.year}),(0,t.jsx)("div",{className:"text-[9px] text-zinc-700 group-hover:text-zinc-500 uppercase tracking-wider",children:e.endDate?(0,v.format)(new Date(e.endDate),"MMM yyyy"):"Closed"})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"hidden sm:flex gap-4 text-right",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-[9px] text-zinc-600 uppercase",children:"Promoted"}),(0,t.jsx)("div",{className:"text-xs font-bold text-zinc-400 group-hover:text-emerald-400 transition-colors",children:e.stats?.promoted||0})]})}),(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-700 hover:text-white hover:bg-white/5 rounded-lg",onClick:()=>K(e),children:(0,t.jsx)(h.Pencil,{className:"w-3.5 h-3.5"})})]})]},e.year))})]})]}),(0,t.jsx)(p.Dialog,{open:L,onOpenChange:O,children:(0,t.jsxs)(p.DialogContent,{className:"bg-slate-950 border-slate-800 text-white sm:max-w-md",children:[(0,t.jsxs)(p.DialogHeader,{children:[(0,t.jsx)(p.DialogTitle,{children:"Define New Session"}),(0,t.jsx)(p.DialogDescription,{className:"text-slate-400",children:"Add a future academic year to the planning queue."})]}),(0,t.jsxs)("div",{className:"py-4",children:[(0,t.jsx)(b.Label,{className:"text-slate-400 mb-2 block",children:"Year Label"}),(0,t.jsx)(f.Input,{value:B,onChange:e=>R(e.target.value),placeholder:"e.g. 2027-2028",className:"bg-slate-900 border-slate-800 text-lg py-6"})]}),(0,t.jsxs)(p.DialogFooter,{children:[(0,t.jsx)(s.Button,{variant:"ghost",onClick:()=>O(!1),children:"Cancel"}),(0,t.jsx)(s.Button,{onClick:W,disabled:!B||U,className:"bg-blue-600 text-white hover:bg-blue-500",children:U?(0,t.jsx)(c.Loader2,{className:"animate-spin"}):"Confirm Year"})]})]})}),(0,t.jsx)(p.Dialog,{open:_,onOpenChange:V,children:(0,t.jsxs)(p.DialogContent,{className:"bg-slate-950 border-slate-800 text-white sm:max-w-md",children:[(0,t.jsxs)(p.DialogHeader,{children:[(0,t.jsx)(p.DialogTitle,{children:"Refine Academic Details"}),(0,t.jsxs)(p.DialogDescription,{className:"text-slate-400",children:["Modify properties for the ",Y?.year," session."]})]}),(0,t.jsxs)("div",{className:"py-4 space-y-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{className:"text-slate-500 uppercase text-[10px] tracking-widest font-bold",children:"Year Identifier"}),(0,t.jsx)(f.Input,{value:G.label,onChange:e=>$({...G,label:e.target.value}),className:"bg-slate-900 border-slate-800"})]}),(!Y?.isUpcoming||Y?.isActive)&&(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{className:"text-slate-500 uppercase text-[10px] tracking-widest font-bold",children:"Session Start"}),(0,t.jsx)(f.Input,{type:"date",value:G.startDate,onChange:e=>$({...G,startDate:e.target.value}),className:"bg-slate-900 border-slate-800"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{className:"text-slate-500 uppercase text-[10px] tracking-widest font-bold",children:"Archival Date"}),(0,t.jsx)(f.Input,{type:"date",value:G.endDate,onChange:e=>$({...G,endDate:e.target.value}),className:"bg-slate-900 border-slate-800"})]})]}),Y?.isUpcoming&&(0,t.jsx)("div",{className:"p-4 bg-blue-500/5 border border-blue-500/10 rounded-lg text-xs text-blue-300",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(l.CheckCircle,{className:"w-4 h-4 shrink-0"}),(0,t.jsx)("span",{children:"Date selection is managed automatically during the transition process. Only the label can be changed at this stage."})]})})]}),(0,t.jsxs)(p.DialogFooter,{children:[(0,t.jsx)(s.Button,{variant:"ghost",className:"text-slate-400",onClick:()=>V(!1),children:"Cancel"}),(0,t.jsx)(s.Button,{onClick:Q,disabled:!G.label||q,className:"bg-blue-600 text-white",children:q?(0,t.jsx)(c.Loader2,{className:"animate-spin"}):"Persist Changes"})]})]})}),(0,t.jsx)(p.Dialog,{open:k,onOpenChange:e=>{(e||"EXECUTING"!==E)&&D(e)},children:(0,t.jsxs)(p.DialogContent,{className:"bg-slate-950 border-slate-800 text-white sm:max-w-xl",children:[(0,t.jsxs)(p.DialogHeader,{children:[(0,t.jsxs)(p.DialogTitle,{className:"text-2xl font-bold flex items-center gap-2",children:[(0,t.jsx)(m.TrendingUp,{className:"text-blue-500"}),"Academic Transition"]}),(0,t.jsxs)(p.DialogDescription,{className:"text-slate-400",children:["Move system from ",(0,t.jsx)("strong",{children:ee?.year})," to a new session."]})]}),"SETUP"===E&&(0,t.jsxs)("div",{className:"space-y-6 py-4",children:[(0,t.jsxs)("div",{className:"p-5 bg-amber-500/10 border border-amber-500/20 rounded-xl text-sm text-amber-200 flex gap-4",children:[(0,t.jsx)(o.AlertTriangle,{className:"w-6 h-6 shrink-0 text-amber-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{className:"block mb-2 text-amber-400 uppercase tracking-widest text-xs",children:"Automated Lifecycle Actions:"}),(0,t.jsxs)("ul",{className:"space-y-2 text-xs opacity-90",children:[(0,t.jsxs)("li",{className:"flex gap-2",children:[(0,t.jsx)(n.ArrowRight,{className:"w-3 h-3 text-amber-500 shrink-0 mt-0.5"})," ",(0,t.jsx)("strong",{children:"Student Promotion"}),": Promoted students move to next class level."]}),(0,t.jsxs)("li",{className:"flex gap-2",children:[(0,t.jsx)(n.ArrowRight,{className:"w-3 h-3 text-amber-500 shrink-0 mt-0.5"})," ",(0,t.jsx)("strong",{children:"Fee Carryover"}),": Pending balances are added to new year's ledger."]}),(0,t.jsxs)("li",{className:"flex gap-2",children:[(0,t.jsx)(n.ArrowRight,{className:"w-3 h-3 text-amber-500 shrink-0 mt-0.5"})," ",(0,t.jsx)("strong",{children:"Staffing Preservation"}),": Subject and teacher assignments are cloned."]})]})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{className:"text-slate-400 uppercase text-[10px] tracking-widest pl-1",children:"Target Entry Year"}),(0,t.jsxs)(j.Select,{value:z,onValueChange:T,children:[(0,t.jsx)(j.SelectTrigger,{className:"bg-slate-900 border-slate-800 h-14 text-xl font-mono",children:(0,t.jsx)(j.SelectValue,{placeholder:"Select Year..."})}),(0,t.jsx)(j.SelectContent,{className:"bg-slate-950 border-slate-800",children:et.map(e=>(0,t.jsx)(j.SelectItem,{value:e.year,className:"text-lg font-mono",children:e.year},e.year))})]})]})})]}),"EXECUTING"===E&&(0,t.jsxs)("div",{className:"py-20 flex flex-col items-center justify-center space-y-6 text-center",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(c.Loader2,{className:"w-20 h-20 animate-spin text-blue-500 opacity-20"}),(0,t.jsx)(m.TrendingUp,{className:"w-10 h-10 text-blue-400 absolute inset-0 m-auto animate-pulse"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-2xl font-bold text-white tracking-tight",children:"Syncing Lifecycle Hub..."}),(0,t.jsx)("p",{className:"text-sm text-slate-400 mt-2 max-w-xs",children:"Bulk updating students, cloning assignments, and calculating fee carryovers."})]})]}),"DONE"===E&&(0,t.jsxs)("div",{className:"py-12 flex flex-col items-center justify-center space-y-6 text-center",children:[(0,t.jsx)("div",{className:"w-24 h-24 bg-emerald-500/10 rounded-full flex items-center justify-center border border-emerald-500/20 shadow-2xl shadow-emerald-500/10",children:(0,t.jsx)(l.CheckCircle,{className:"w-12 h-12 text-emerald-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-3xl font-black text-white tracking-tight italic",children:"SYSTEM ADVANCED!"}),(0,t.jsxs)("p",{className:"text-slate-400 mt-2",children:["Successful transition to ",(0,t.jsx)("span",{className:"text-white font-bold",children:z}),"."]}),(0,t.jsxs)("div",{className:"mt-8 flex gap-4 justify-center",children:[(0,t.jsxs)("div",{className:"bg-white/5 px-4 py-2 rounded-lg border border-white/5",children:[(0,t.jsx)("div",{className:"text-[10px] uppercase text-slate-500",children:"Promoted"}),(0,t.jsx)("div",{className:"text-lg font-bold text-emerald-400",children:A?.promoted})]}),(0,t.jsxs)("div",{className:"bg-white/5 px-4 py-2 rounded-lg border border-white/5",children:[(0,t.jsx)("div",{className:"text-[10px] uppercase text-slate-500",children:"Retained"}),(0,t.jsx)("div",{className:"text-lg font-bold text-blue-400",children:A?.retained})]})]})]})]}),(0,t.jsxs)(p.DialogFooter,{className:"bg-slate-900/50 p-6 border-t border-slate-800 rounded-b-xl",children:["SETUP"===E&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Button,{variant:"ghost",className:"text-slate-400",onClick:()=>D(!1),children:"Cancel"}),(0,t.jsx)(s.Button,{onClick:Z,disabled:!z,className:"bg-blue-600 hover:bg-blue-500 text-white px-8",children:"Initiate Deployment"})]}),"DONE"===E&&(0,t.jsx)(s.Button,{onClick:()=>{D(!1),window.location.reload()},className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white",children:"Enter New Session"})]})]})})]})}y.exports.create;var C=e.i(59141),M=e.i(69074),k=e.i(56909),D=e.i(73708),z=e.i(75254);let T=(0,z.default)("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]]);var E=e.i(95468),I=e.i(80691),A=e.i(72498);function P(){let{branding:e}=(0,A.useMasterData)(),[r,n]=(0,a.useState)(!1),[l,o]=(0,a.useState)(""),[d,h]=(0,a.useState)(""),[x,m]=(0,a.useState)(""),[u,p]=(0,a.useState)(""),[g,j]=(0,a.useState)(!1),[w,v]=(0,a.useState)(!1),[y,N]=(0,a.useState)(""),[S,z]=(0,a.useState)(""),[P,L]=(0,a.useState)(!1),[O,B]=(0,a.useState)(!1);(0,a.useEffect)(()=>{e&&(o(e.schoolName||""),h(e.address||""),m(e.schoolLogo||""),p(e.principalSignature||""))},[e]);let R=async(e,t)=>{let a=await C.auth.currentUser?.getIdToken(),s=new FormData;s.append("file",e),s.append("type",t);let i=await fetch("/api/admin/media/upload",{method:"POST",headers:{Authorization:`Bearer ${a}`},body:s}),r=await i.json();if(!i.ok||!r.success)throw Error(r.error||"Upload failed");return r.url},U=async(t,a)=>{let s="logo"===a;s?(j(!0),N(URL.createObjectURL(t))):(v(!0),z(URL.createObjectURL(t)));try{let e=await R(t,a);s?(m(e),(0,I.toast)({title:"Logo Ready",description:"Cloud storage sync complete.",type:"success"})):(p(e),(0,I.toast)({title:"Signature Ready",description:"Cloud storage sync complete.",type:"success"}))}catch(t){(0,I.toast)({title:"Upload Blocked",description:"Cannot reach storage. Please try pasting a direct URL using the button above.",type:"error"}),s?(N(""),m(e.schoolLogo||"")):(z(""),p(e.principalSignature||""))}finally{s?j(!1):v(!1)}},F=(e,t)=>{e.target.files&&e.target.files[0]&&U(e.target.files[0],t)},_=async()=>{n(!0);try{let e=await C.auth.currentUser?.getIdToken(),t=await fetch("/api/admin/settings/branding",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({schoolName:l,address:d,schoolLogo:x,principalSignature:u})}),a=await t.json();if(!t.ok||!a.success)throw Error(a.error);N(""),z(""),(0,I.toast)({title:"Settings Saved",description:"Branding updated successfully!",type:"success"})}catch(e){(0,I.toast)({title:"Save Failed",description:e.message,type:"error"})}finally{n(!1)}},V=g||w,Y=l!==(e.schoolName||"")||d!==(e.address||"")||x!==(e.schoolLogo||"")||u!==(e.principalSignature||"");return(0,t.jsxs)(i.Card,{className:"bg-zinc-900/40 border-white/10 overflow-hidden shadow-2xl relative backdrop-blur-xl ring-1 ring-white/5",children:[(r||g||w)&&(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-0.5 z-50 overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-indigo-500 animate-pulse shadow-[0_0_10px_#6366f1]",style:{width:"100%"}})}),(0,t.jsx)(i.CardHeader,{className:"bg-white/5 border-b border-white/5 pb-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-indigo-500/10 rounded-lg border border-indigo-500/20",children:(0,t.jsx)(T,{className:"w-5 h-5 text-indigo-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(i.CardTitle,{className:"text-base md:text-lg font-bold text-white tracking-tight",children:"Organization Identity"}),(0,t.jsx)(i.CardDescription,{className:"text-zinc-400 text-xs mt-0.5",children:"Manage official school branding and assets."})]})]})}),(0,t.jsxs)(i.CardContent,{className:"p-4 md:p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 md:gap-6 pb-4 md:pb-6 border-b border-white/5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{className:"text-[10px] md:text-xs font-semibold uppercase tracking-wider text-zinc-500 flex items-center gap-1.5",children:"School Name"}),(0,t.jsx)(f.Input,{value:l,onChange:e=>o(e.target.value),className:"bg-zinc-950/50 border-white/10 h-10 md:h-11 rounded-lg focus:ring-indigo-500/20 focus:border-indigo-500/50 transition-all text-white font-medium text-xs md:text-sm placeholder:text-zinc-700",placeholder:"e.g. Spoorthy Concept School"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{className:"text-[10px] md:text-xs font-semibold uppercase tracking-wider text-zinc-500 flex items-center gap-1.5",children:"Address Line"}),(0,t.jsx)(f.Input,{value:d,onChange:e=>h(e.target.value),className:"bg-zinc-950/50 border-white/10 h-10 md:h-11 rounded-lg focus:ring-indigo-500/20 focus:border-indigo-500/50 transition-all text-white font-medium text-xs md:text-sm placeholder:text-zinc-700",placeholder:"City, State, Country"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 md:gap-8",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(b.Label,{className:"text-xs md:text-sm font-semibold text-zinc-300",children:"School Logo"}),(0,t.jsx)(s.Button,{variant:"ghost",size:"sm",onClick:()=>L(!P),className:"text-[10px] font-medium text-zinc-500 hover:text-indigo-400 h-6 px-2 hover:bg-transparent",children:P?"Upload File":"Paste URL"})]}),P?(0,t.jsx)(f.Input,{value:x,onChange:e=>m(e.target.value),className:"bg-zinc-950/50 border-white/10 h-10 rounded-lg font-mono text-[10px] md:text-xs text-zinc-300",placeholder:"https://..."}):(0,t.jsxs)("div",{className:"border border-dashed border-zinc-700/50 rounded-xl p-4 flex flex-col items-center justify-center gap-3 bg-zinc-900/30 hover:bg-zinc-900/50 hover:border-indigo-500/30 transition-all relative group h-32 md:h-48 overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute inset-0 opacity-[0.03] bg-[radial-gradient(#fff_1px,transparent_1px)] [background-size:8px_8px] pointer-events-none"}),(0,t.jsx)("div",{className:"w-16 h-16 md:w-24 md:h-24 relative flex items-center justify-center bg-zinc-950 rounded-xl border border-white/5 shadow-inner",children:y||x?(0,t.jsxs)("div",{className:"relative w-full h-full p-2",children:[(0,t.jsx)("img",{src:y||x,alt:"Logo",className:"w-full h-full object-contain"}),!g&&x&&(0,t.jsx)("div",{className:"absolute -bottom-1 -right-1 bg-emerald-500 rounded-full p-0.5 shadow-lg ring-2 ring-black",children:(0,t.jsx)(E.CheckCircle2,{className:"w-3 h-3 text-white"})})]}):(0,t.jsx)(D.Image,{className:"w-8 h-8 md:w-10 md:h-10 text-zinc-800"})}),g&&(0,t.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-[2px] z-10 flex items-center justify-center rounded-xl",children:(0,t.jsx)(c.Loader2,{className:"w-6 h-6 animate-spin text-indigo-500"})}),!g&&(0,t.jsxs)(s.Button,{variant:"secondary",size:"sm",className:"relative pointer-events-none h-7 md:h-9 px-3 text-[10px] md:text-xs bg-zinc-800 text-zinc-300 border border-white/5 shadow-sm",children:[(0,t.jsx)(M.Upload,{className:"w-3 h-3 mr-1.5"}),(0,t.jsx)("span",{className:"hidden md:inline",children:"Select File"})," ",(0,t.jsx)("span",{className:"md:hidden",children:"Upload"})]}),(0,t.jsx)("input",{type:"file",accept:"image/*",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20",onChange:e=>F(e,"logo"),disabled:g})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(b.Label,{className:"text-xs md:text-sm font-semibold text-zinc-300",children:"Principal Signature"}),(0,t.jsx)(s.Button,{variant:"ghost",size:"sm",onClick:()=>B(!O),className:"text-[10px] font-medium text-zinc-500 hover:text-indigo-400 h-6 px-2 hover:bg-transparent",children:O?"Upload File":"Paste URL"})]}),O?(0,t.jsx)(f.Input,{value:u,onChange:e=>p(e.target.value),className:"bg-zinc-950/50 border-white/10 h-10 rounded-lg font-mono text-[10px] md:text-xs text-zinc-300",placeholder:"https://..."}):(0,t.jsxs)("div",{className:"border border-dashed border-zinc-700/50 rounded-xl p-4 flex flex-col items-center justify-center gap-3 bg-zinc-900/30 hover:bg-zinc-900/50 hover:border-indigo-500/30 transition-all relative group h-32 md:h-48 overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute inset-0 opacity-[0.03] bg-[radial-gradient(#fff_1px,transparent_1px)] [background-size:8px_8px] pointer-events-none"}),(0,t.jsx)("div",{className:"w-24 h-12 md:w-36 md:h-20 relative flex items-center justify-center bg-white rounded-lg border border-white/10 shadow-sm",children:S||u?(0,t.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center p-2",children:[(0,t.jsx)("img",{src:S||u,alt:"Signature",className:"w-full h-full object-contain"}),!w&&u&&(0,t.jsx)("div",{className:"absolute -bottom-1 -right-1 bg-emerald-500 rounded-full p-0.5 shadow-lg ring-2 ring-black",children:(0,t.jsx)(E.CheckCircle2,{className:"w-3 h-3 text-white"})})]}):(0,t.jsx)("span",{className:"text-zinc-200 text-[10px] font-mono italic",children:"NO SIGNATURE"})}),w&&(0,t.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-[2px] z-10 flex items-center justify-center rounded-xl",children:(0,t.jsx)(c.Loader2,{className:"w-6 h-6 animate-spin text-indigo-500"})}),!w&&(0,t.jsxs)(s.Button,{variant:"secondary",size:"sm",className:"relative pointer-events-none h-7 md:h-9 px-3 text-[10px] md:text-xs bg-zinc-800 text-zinc-300 border border-white/5 shadow-sm",children:[(0,t.jsx)(M.Upload,{className:"w-3 h-3 mr-1.5"}),(0,t.jsx)("span",{className:"hidden md:inline",children:"Select File"})," ",(0,t.jsx)("span",{className:"md:hidden",children:"Upload"})]}),(0,t.jsx)("input",{type:"file",accept:"image/*",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20",onChange:e=>F(e,"signature"),disabled:w})]})]})]}),(0,t.jsx)("div",{className:"flex justify-end pt-4 border-t border-white/5",children:(0,t.jsxs)(s.Button,{onClick:_,disabled:r||V||!Y,className:"bg-indigo-600 hover:bg-indigo-500 text-white w-full md:w-auto px-8 h-10 md:h-11 rounded-lg font-semibold text-xs md:text-sm shadow-lg shadow-indigo-500/20 transition-all active:scale-95",children:[r?(0,t.jsx)(c.Loader2,{className:"animate-spin mr-2 w-4 h-4"}):(0,t.jsx)(k.Save,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})}var L=e.i(98919),O=e.i(84614);let B=(0,z.default)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var R=e.i(34161),U=e.i(27612);e.i(36180);var F=e.i(98925),_=e.i(81418);function V({isOpen:e,onClose:i,onSuccess:r}){let[n,l]=(0,a.useState)({name:"",email:"",password:"",role:"MANAGER"}),[o,d]=(0,a.useState)(!1),h=async e=>{e.preventDefault(),d(!0);try{let e=await fetch("/api/admin/users/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),t=await e.json();if(!e.ok)throw Error(t.error);(0,I.toast)({title:"User Created",description:`System access granted to ${n.name} as ${n.role}`,type:"success"}),l({name:"",email:"",password:"",role:"MANAGER"}),r(),i()}catch(e){(0,I.toast)({title:"Creation Failed",description:e.message||"Something went wrong.",type:"error"})}finally{d(!1)}};return(0,t.jsx)(p.Dialog,{open:e,onOpenChange:i,children:(0,t.jsxs)(p.DialogContent,{className:"bg-black/95 border-white/10 text-white sm:max-w-[425px]",children:[(0,t.jsx)(p.DialogHeader,{children:(0,t.jsxs)(p.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(_.ShieldCheck,{className:"text-accent",size:20}),"Add System User"]})}),(0,t.jsxs)("form",{onSubmit:h,className:"space-y-4 py-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Full Name"}),(0,t.jsx)(f.Input,{required:!0,value:n.name,onChange:e=>l({...n,name:e.target.value}),className:"bg-white/5 border-white/10",placeholder:"e.g. John Doe"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Email Address"}),(0,t.jsx)(f.Input,{required:!0,type:"email",value:n.email,onChange:e=>l({...n,email:e.target.value}),className:"bg-white/5 border-white/10",placeholder:"user@school.com"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Initial Password"}),(0,t.jsx)(f.Input,{required:!0,type:"text",value:n.password,onChange:e=>l({...n,password:e.target.value}),className:"bg-white/5 border-white/10 font-mono",placeholder:"Secure password"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"System Role"}),(0,t.jsxs)(j.Select,{value:n.role,onValueChange:e=>l({...n,role:e}),children:[(0,t.jsx)(j.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(j.SelectValue,{placeholder:"Select Role"})}),(0,t.jsxs)(j.SelectContent,{className:"bg-black border-white/10 text-white",children:[(0,t.jsx)(j.SelectItem,{value:"MANAGER",children:"Manager"}),(0,t.jsx)(j.SelectItem,{value:"ADMIN",children:"Administrator"}),(0,t.jsx)(j.SelectItem,{value:"TIMETABLE_EDITOR",children:"Timetable Editor"})]})]}),(0,t.jsxs)("p",{className:"text-[10px] text-muted-foreground mt-1",children:["MANAGER"===n.role&&"Can manage academic operations but cannot access payroll or system settings.","ADMIN"===n.role&&"Full system access including payroll, settings, and user management.","TIMETABLE_EDITOR"===n.role&&"Restricted to timetable and faculty coverage management."]})]}),(0,t.jsx)(p.DialogFooter,{className:"mt-4 pt-4 border-t border-white/5",children:(0,t.jsx)(s.Button,{type:"submit",disabled:o,className:"w-full bg-white text-black hover:bg-zinc-200",children:o?(0,t.jsx)(c.Loader2,{className:"w-4 h-4 animate-spin"}):"Gant System Access"})})]})]})})}var Y=e.i(55146),H=e.i(75157),G=e.i(51537),$=e.i(87828);function q(){let{user:e}=(0,w.useAuth)(),[r,n]=(0,a.useState)([]),[l,o]=(0,a.useState)(!0),[c,h]=(0,a.useState)(!1),[x,m]=(0,a.useState)(null),[u,p]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=(0,F.query)((0,F.collection)(C.db,"users"),(0,F.orderBy)("role")),t=(0,F.onSnapshot)(e,e=>{n(e.docs.map(e=>({id:e.id,...e.data()})).filter(e=>["ADMIN","MANAGER","TIMETABLE_EDITOR"].includes(e.role))),o(!1)});return()=>t()},[]);let f=async t=>{if(x&&e&&!(await fetch("/api/admin/user-actions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await e.getIdToken()}`},body:JSON.stringify({targetId:x.id,role:x.role,action:"DEACTIVATE",reason:t})})).ok)throw Error("Failed to deactivate user")},b=async t=>{if(x&&e&&!(await fetch("/api/admin/user-actions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await e.getIdToken()}`},body:JSON.stringify({targetId:x.id,role:x.role,action:"DELETE_HARD",reason:t})})).ok)throw Error("Failed to permanently delete user")};return(0,t.jsxs)(i.Card,{className:"bg-black/20 border-white/10 backdrop-blur-md",children:[(0,t.jsxs)(i.CardHeader,{className:"flex flex-row items-center justify-between border-b border-white/5 pb-4",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)(i.CardTitle,{className:"text-xl font-bold flex items-center gap-2",children:[(0,t.jsx)(L.Shield,{className:"text-accent",size:20}),"System Access Control"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-widest font-bold",children:"Manage administrative accounts"})]}),(0,t.jsxs)(s.Button,{onClick:()=>h(!0),size:"sm",className:"bg-white text-black hover:bg-zinc-200",children:[(0,t.jsx)(d.Plus,{size:16,className:"mr-1"})," Add User"]})]}),(0,t.jsx)(i.CardContent,{className:"pt-6",children:(0,t.jsx)("div",{className:"space-y-3",children:l?(0,t.jsx)("div",{className:"p-10 text-center animate-pulse text-muted-foreground",children:"Syncing access matrix..."}):0===r.length?(0,t.jsx)("div",{className:"p-10 text-center border border-dashed border-white/5 rounded-xl text-muted-foreground italic",children:"No secondary system users found."}):r.map(e=>(0,t.jsxs)("div",{className:(0,H.cn)("flex items-center justify-between p-4 rounded-xl bg-white/5 border border-white/5 hover:border-white/10 transition-all group","inactive"===e.status&&"opacity-50 grayscale"),children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/5 flex items-center justify-center border border-white/10 group-hover:border-accent/30 transition-colors",children:(0,t.jsx)(O.User,{size:18,className:"text-white/40 group-hover:text-accent transition-colors"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-bold text-sm text-white flex items-center gap-2",children:[e.name||e.email,"inactive"===e.status&&(0,t.jsx)("span",{className:"text-[9px] bg-red-500/10 text-red-500 px-1 rounded uppercase",children:"Inactive"})]}),(0,t.jsx)("div",{className:"text-[10px] font-mono text-white/40",children:e.email})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(g.Badge,{className:(0,H.cn)("text-[9px] font-black uppercase tracking-tighter py-0 h-5 border-none","ADMIN"===e.role?"bg-accent/10 text-accent":"MANAGER"===e.role?"bg-blue-500/10 text-blue-400":"bg-purple-500/10 text-purple-400"),children:e.role}),(0,t.jsxs)(Y.DropdownMenu,{children:[(0,t.jsx)(Y.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-white/40 hover:text-white",children:(0,t.jsx)(B,{size:16})})}),(0,t.jsxs)(Y.DropdownMenuContent,{align:"end",className:"bg-zinc-900 border-white/10 text-white",children:[(0,t.jsxs)(Y.DropdownMenuItem,{className:"gap-2 text-xs font-bold text-amber-500",onClick:()=>{m(e),p("password")},children:[(0,t.jsx)(R.Key,{size:14})," Reset Password"]}),(0,t.jsxs)(Y.DropdownMenuItem,{className:"gap-2 text-xs font-bold text-red-500",onClick:()=>{m(e),p("delete")},children:[(0,t.jsx)(U.Trash2,{size:14})," Revoke Access"]})]})]})]})]},e.id))})}),(0,t.jsx)(V,{isOpen:c,onClose:()=>h(!1),onSuccess:()=>{}}),x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(G.DeleteUserModal,{isOpen:"delete"===u,onClose:()=>{p(null),m(null)},user:{id:x.id,schoolId:x.email,name:x.name||"System User",role:x.role},checkEligibility:async()=>({canDelete:!0}),onDeactivate:f,onDelete:b}),(0,t.jsx)($.AdminChangePasswordModal,{isOpen:"password"===u,onClose:()=>{p(null),m(null)},user:{uid:x.id,schoolId:x.email,name:x.name||"System User",role:x.role}})]})]})}var J=e.i(18566),X=e.i(51737),W=e.i(22016);function Z(){let{user:e}=(0,w.useAuth)();(0,J.useRouter)();let[i,r]=(0,a.useState)(null),[n,l]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{if(!e)return;let t=(0,F.onSnapshot)((0,F.doc)(C.db,"users",e.uid),e=>{r(e.exists()?e.data().role:null),l(!1)});return()=>t()},[e]),n)?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-[60vh] gap-4",children:[(0,t.jsx)(c.Loader2,{className:"w-8 h-8 animate-spin text-accent"}),(0,t.jsx)("p",{className:"text-muted-foreground animate-pulse",children:"Verifying credentials..."})]}):i&&!["ADMIN","SUPER_ADMIN","OWNER","DEVELOPER"].includes(i.toUpperCase())?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-[60vh] gap-6 text-center animate-in zoom-in-95 duration-500",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-full bg-rose-500/10 flex items-center justify-center border border-rose-500/20 shadow-2xl shadow-rose-500/20",children:(0,t.jsx)(X.ShieldAlert,{className:"w-10 h-10 text-rose-500"})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h1",{className:"text-3xl font-display font-bold text-white",children:"Restricted Access"}),(0,t.jsx)("p",{className:"text-muted-foreground max-w-md mx-auto",children:"This terminal is restricted to Level 1 Administrators. Your current clearance does not permit modification of system-wide settings."})]}),(0,t.jsx)(s.Button,{asChild:!0,variant:"outline",className:"border-white/10 hover:bg-white/5",children:(0,t.jsx)(W.default,{href:"/admin",children:"Return to Dashboard"})})]}):(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:gap-8 p-3 md:p-8 max-w-7xl mx-auto pb-20",children:[(0,t.jsxs)("div",{className:"flex-none",children:[(0,t.jsxs)("h1",{className:"text-xl md:text-3xl font-display font-bold text-white italic tracking-tight",children:["System ",(0,t.jsx)("span",{className:"text-accent underline decoration-accent/20",children:"Settings"})]}),(0,t.jsx)("p",{className:"text-[10px] md:text-sm text-muted-foreground uppercase tracking-widest font-bold opacity-50",children:"L1 Administrative Control Panel"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-8 items-start",children:[(0,t.jsxs)("div",{className:"w-full space-y-4 md:space-y-8",children:[(0,t.jsx)(P,{}),(0,t.jsx)(q,{})]}),(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)(S,{})})]})]})}e.s(["default",()=>Z],7585)}]);