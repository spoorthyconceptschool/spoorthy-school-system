(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,88760,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),n=e.i(32341),r=e.i(31278),i=e.i(75157),l=e.i(60289),o=e.i(51501),d=e.i(61911),c=e.i(75254);let u=(0,c.default)("banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);var m=e.i(52754),h=e.i(78583),p=e.i(45423),x=e.i(10980),f=e.i(3116),b=e.i(39616);let g=(0,c.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var y=e.i(92270),w=e.i(63059),v=e.i(52008),j=e.i(46897),N=e.i(82293),k=e.i(54385),F=e.i(27612),S=e.i(22016),A=e.i(46932);e.i(36180);var C=e.i(98925),D=e.i(59141),M=e.i(72498);let I=[{label:"Overview",icon:l.LayoutDashboard,href:"/admin",exact:!0},{type:"separator",label:"Entities"},{label:"Students",icon:o.GraduationCap,href:"/admin/students"},{label:"Staff & HR",icon:d.Users,href:"/admin/faculty"},{label:"Groups",icon:d.Users,href:"/admin/groups"},{label:"Attendance",icon:N.UserCheck,href:"/admin/attendance"},{type:"separator",label:"Financials"},{label:"Fees",icon:u,href:"/admin/fees"},{label:"Payroll",icon:m.Wallet,href:"/admin/salary"},{type:"separator",label:"Operations"},{label:"Schedules",icon:f.Clock,href:"/admin/timetable/manage"},{label:"Academics",icon:x.BookOpen,href:"/admin/homework"},{label:"Exams & Halls",icon:k.ClipboardCheck,href:"/admin/exams"},{type:"separator",label:"Master Data"},{label:"Classes",icon:v.Layers,href:"/admin/master-data/classes-sections"},{label:"Subjects",icon:x.BookOpen,href:"/admin/master-data/subjects"},{label:"Villages",icon:j.MapPin,href:"/admin/master-data/villages"},{type:"separator",label:"System Control"},{label:"Settings",icon:b.Settings,href:"/admin/settings"},{label:"Notices",icon:p.Bell,href:"/admin/notices"},{label:"Content",icon:h.FileText,href:"/admin/cms"},{label:"Purge Data",icon:F.Trash2,href:"/admin/purge-data"}];function E({mobile:e=!1,onItemClick:r}){let l=(0,a.usePathname)(),[o,d]=(0,s.useState)(!1),{user:c,signOut:u}=(0,n.useAuth)(),{branding:m}=(0,M.useMasterData)(),[h,p]=(0,s.useState)(null),[x,f]=(0,s.useState)(0);(0,s.useEffect)(()=>{if(!c)return;let e=(0,C.query)((0,C.collection)(D.db,"leave_requests"),(0,C.where)("status","==","PENDING")),t=(0,C.onSnapshot)(e,e=>{f(e.size)});return()=>t()},[c]),(0,s.useEffect)(()=>{if(!c)return void p(null);let e=sessionStorage.getItem(`role_${c.uid}`);e&&p(e);let t=(0,C.onSnapshot)((0,C.doc)(D.db,"users",c.uid),e=>{if(e.exists()){let t=e.data().role;p(t),sessionStorage.setItem(`role_${c.uid}`,t)}});return()=>t()},[c]);let b=I.filter(e=>{let t="MANAGER"===h?["/admin","/admin/students","/admin/attendance","/admin/fees","/admin/exams","/admin/faculty","/admin/master-data","/admin/timetable/manage"]:"TIMETABLE_EDITOR"===h?["/admin","/admin/timetable/manage","/admin/faculty","/admin/master-data/subjects","/admin/master-data/classes-sections"]:null;return!("MANAGER"===h&&"separator"===e.type&&["System Control"].includes(e.label||""))&&("separator"===e.type||!t||t.some(t=>e.href===t||"/admin"!==t&&e.href?.startsWith(t)))});return(0,t.jsxs)(A.motion.aside,{initial:!1,animate:{width:e?"100%":o?"80px":"260px"},className:(0,i.cn)("flex flex-col h-full bg-[#0A192F]/40 backdrop-blur-xl border-r border-[#64FFDA]/10 z-50 text-white transition-all duration-300 shadow-xl",!e&&"sticky top-0"),children:[(0,t.jsxs)("div",{className:"h-24 flex items-center justify-between px-4 pt-4 border-b border-[#64FFDA]/5",children:[(!o||e)&&(0,t.jsxs)(A.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center gap-3 select-none overflow-hidden",children:[(0,t.jsx)("div",{className:"w-10 h-10 md:w-12 md:h-12 shrink-0 rounded-xl bg-white flex items-center justify-center p-1.5 border border-white/20 shadow-lg",children:m.schoolLogo?(0,t.jsx)("img",{src:m.schoolLogo,alt:"Logo",className:"w-full h-full object-contain"}):(0,t.jsx)("div",{className:"w-full h-full bg-[#64FFDA]/10 flex items-center justify-center text-[#64FFDA] font-bold font-mono text-xl",children:"S"})}),(0,t.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,t.jsx)("span",{className:"font-black text-[10px] tracking-[0.2em] text-[#64FFDA] uppercase truncate leading-none mb-1",children:"Control Center"}),(0,t.jsx)("span",{className:"font-bold text-sm tracking-tight text-white md:truncate md:max-w-[140px]",children:m.schoolName||"Spoorthy School"})]})]}),!e&&(0,t.jsx)("button",{onClick:()=>d(!o),className:"p-2 hover:bg-[#64FFDA]/10 rounded text-[#64FFDA]/50 hover:text-[#64FFDA] transition-colors ml-auto",children:o?(0,t.jsx)(w.ChevronRight,{size:18}):(0,t.jsx)(g,{size:18})})]}),(0,t.jsx)("nav",{className:"flex-1 overflow-y-auto py-6 px-3 space-y-1 scrollbar-thin scrollbar-thumb-[#64FFDA]/10 hover:scrollbar-thumb-[#64FFDA]/30",children:b.map((s,a)=>{if("separator"===s.type)return o&&!e?(0,t.jsx)("div",{className:"h-4"},a):(0,t.jsx)("div",{className:"px-3 pt-6 pb-2 text-[10px] font-bold text-[#8892B0] uppercase tracking-widest font-mono whitespace-nowrap overflow-hidden",children:s.label},a);let n=s.exact?l===s.href:s.href&&l.startsWith(s.href);return(0,t.jsx)(S.default,{href:s.href,onClick:()=>r?.(),children:(0,t.jsxs)("div",{className:(0,i.cn)("flex items-center gap-4 px-3 py-3 rounded-md transition-all duration-200 group relative font-medium text-sm border border-transparent",n?"bg-[#64FFDA]/10 text-[#64FFDA] border-[#64FFDA]/20 shadow-[0_0_15px_-5px_#64FFDA]":"text-[#8892B0] hover:text-[#E6F1FF] hover:bg-white/5"),children:[s.icon&&(0,t.jsx)(s.icon,{size:20,strokeWidth:n?2.5:2,className:(0,i.cn)("shrink-0 transition-colors",n?"text-[#64FFDA]":"text-[#8892B0] group-hover:text-[#E6F1FF]")}),(!o||e)&&(0,t.jsxs)("div",{className:"flex-1 flex items-center justify-between min-w-0",children:[(0,t.jsx)("span",{className:(0,i.cn)("truncate font-mono text-xs",n?"font-bold":""),children:s.label}),"Staff & HR"===s.label&&x>0&&(0,t.jsxs)(A.motion.span,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},className:"flex h-5 min-w-[20px] items-center justify-center rounded-full bg-red-500 px-1 text-[10px] font-bold text-white shadow-[0_0_10px_rgba(239,68,68,0.5)]",children:[x,(0,t.jsx)("span",{className:"absolute inset-0 rounded-full bg-red-500 animate-ping opacity-25"})]})]}),o&&!e&&"Staff & HR"===s.label&&x>0&&(0,t.jsx)("div",{className:"absolute top-1 right-1 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-[#0A192F] shadow-[0_0_8px_rgba(239,68,68,0.8)]",children:(0,t.jsx)("div",{className:"absolute inset-0 rounded-full bg-red-500 animate-ping opacity-40"})})]})},s.href)})}),(0,t.jsx)("div",{className:"p-4 border-t border-[#64FFDA]/10 bg-transparent",children:(0,t.jsxs)("button",{onClick:u,className:(0,i.cn)("flex items-center gap-3 px-3 py-3 rounded-md transition-colors w-full text-left text-[#8892B0] hover:text-[#FF5555] hover:bg-[#FF5555]/10",o&&!e?"justify-center px-0":""),children:[(0,t.jsx)(y.LogOut,{size:18,className:"shrink-0"}),(!o||e)&&(0,t.jsx)("span",{className:"text-xs font-bold font-mono uppercase",children:"Log Out"})]})})]})}var L=e.i(7233),R=e.i(84614),T=e.i(59208),$=e.i(19455),z=e.i(55146),P=e.i(80691),B=e.i(58041);let O=(0,c.default)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);var _=e.i(51737),U=e.i(55436);function q(){let[e,a]=(0,s.useState)(!1),[n,l]=(0,s.useState)(!1),[o,d]=(0,s.useState)(!1),c=async()=>{if(!o){d(!0),setTimeout(()=>d(!1),3e3);return}l(!0),d(!1),console.log("Starting setupLogins...");try{let e=await fetch("/api/admin/demo/setup-logins",{method:"POST"}),t=await e.json();if(console.log("Setup Logins API Response:",t),t.success)(0,P.toast)({title:"Logins Ready",description:t.message,type:"success"});else throw Error(t.error||"API failed without error message")}catch(e){console.error("Setup Logins Error:",e),(0,P.toast)({title:"Failed",description:e.message,type:"error"})}finally{l(!1)}},u=async()=>{console.log("Ultimate Seed initiated. Requesting ecosystem rebuild..."),a(!0);try{let e=await fetch("/api/admin/demo/super-seed"),t=await e.json();if(t.success)console.log("Ultimate Seed Response:",t),(0,P.toast)({title:"System Rebuilt",description:`Successfully seeded master data, students, teachers, and finances in ${t.duration}.`,type:"success"}),setTimeout(()=>window.location.reload(),1500);else throw Error(t.error||"Seeding API failed")}catch(e){console.error("Seed Data Error:",e),(0,P.toast)({title:"Seed Failed",description:e.message,type:"error"})}finally{a(!1)}};return(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)($.Button,{onClick:u,variant:"outline",className:"border-dashed",disabled:e||n,children:[e?(0,t.jsx)(r.Loader2,{className:"w-4 h-4 animate-spin mr-2"}):(0,t.jsx)(B.Database,{className:"w-4 h-4 mr-2"}),"Seed Data"]}),(0,t.jsxs)($.Button,{onClick:c,variant:"outline",className:(0,i.cn)("transition-all duration-300",o?"border-amber-500 text-amber-500 animate-pulse":"border-emerald-500/50 text-emerald-500"),disabled:e||n,children:[n?(0,t.jsx)(r.Loader2,{className:"w-4 h-4 animate-spin mr-2"}):o?(0,t.jsx)(_.ShieldAlert,{className:"w-4 h-4 mr-2"}):(0,t.jsx)(O,{className:"w-4 h-4 mr-2"}),o?"Confirm?":"Setup Logins"]}),(0,t.jsxs)($.Button,{onClick:async()=>{if(window.confirm("This will rebuild the global search index. Continue?")){a(!0);try{let e=await D.auth.currentUser?.getIdToken(),t=await fetch("/api/admin/search/reindex",{method:"POST",headers:{Authorization:`Bearer ${e}`}}),s=await t.json();if(s.success)(0,P.toast)({title:"Re-indexing Started",description:s.message,type:"success"});else throw Error(s.error)}catch(e){(0,P.toast)({title:"Re-index Failed",description:e.message,type:"error"})}finally{a(!1)}}},variant:"outline",className:"border-blue-500/50 text-blue-400",disabled:e||n,children:[(0,t.jsx)(U.Search,{className:"w-4 h-4 mr-2"}),"Reindex Search"]})]})}var V=e.i(26999),G=["color"],H=(0,s.forwardRef)(function(e,t){var a=e.color,n=function(e,t){if(null==e)return{};var s,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)s=r[a],t.indexOf(s)>=0||(n[s]=e[s]);return n}(e,G);return(0,s.createElement)("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n,{ref:t}),(0,s.createElement)("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:void 0===a?"currentColor":a,fillRule:"evenodd",clipRule:"evenodd"}))}),K=e.i(25913);let W=V.Root,Z=V.Trigger;V.Close;let X=({...e})=>(0,t.jsx)(V.Portal,{...e});X.displayName=V.Portal.displayName;let J=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)(V.Overlay,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s,ref:a}));J.displayName=V.Overlay.displayName;let Q=(0,K.cva)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Y=s.forwardRef(({side:e="right",className:s,children:a,...n},r)=>(0,t.jsxs)(X,{children:[(0,t.jsx)(J,{}),(0,t.jsxs)(V.Content,{ref:r,className:(0,i.cn)(Q({side:e}),s),...n,children:[a,(0,t.jsxs)(V.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,t.jsx)(H,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));Y.displayName=V.Content.displayName;let ee=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)(V.Title,{ref:a,className:(0,i.cn)("text-lg font-semibold text-foreground",e),...s}));ee.displayName=V.Title.displayName;let et=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)(V.Description,{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",e),...s}));et.displayName=V.Description.displayName;var es=e.i(92161);function ea(){let[e,a]=(0,s.useState)(!1);return(0,t.jsxs)(W,{open:e,onOpenChange:a,children:[(0,t.jsx)(Z,{asChild:!0,children:(0,t.jsx)($.Button,{variant:"ghost",size:"icon",className:"lg:hidden mr-2 text-white/70 hover:text-white hover:bg-white/10",children:(0,t.jsx)(es.Menu,{className:"w-6 h-6"})})}),(0,t.jsxs)(Y,{side:"left",className:"p-0 bg-transparent border-none w-72",children:[(0,t.jsx)(ee,{className:"sr-only",children:"Admin Navigation Menu"}),(0,t.jsx)(et,{className:"sr-only",children:"Access school management modules and settings"}),(0,t.jsx)("div",{className:"h-full w-full bg-[#0A192F]/95 backdrop-blur-3xl border-r border-[#64FFDA]/10 shadow-2xl",children:(0,t.jsx)(E,{mobile:!0,onItemClick:()=>a(!1)})})]})]})}var en=e.i(37727),er=e.i(61659);let ei=(0,c.default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),el=[{id:"nav-dashboard",entityId:"nav-dashboard",type:"action",title:"Admin Dashboard",subtitle:"Go to Home / Overview",url:"/admin",keywords:["home","main","dashboard","admin","stats","overview"]},{id:"nav-students",entityId:"nav-students",type:"action",title:"Student Directory",subtitle:"Manage Students / Admissions",url:"/admin/students",keywords:["student","students","admission","enroll","enrollment","list","directory","register","profile"]},{id:"nav-students-add",entityId:"nav-students-add",type:"action",title:"Add New Student",subtitle:"Open Admission Form",url:"/admin/students?action=add",keywords:["add student","new admission","register student","create student"]},{id:"nav-students-import",entityId:"nav-students-import",type:"action",title:"Import Students",subtitle:"Bulk Upload via CSV",url:"/admin/students?action=import",keywords:["import","bulk","upload","csv","excel","migrate"]},{id:"nav-teachers",entityId:"nav-teachers",type:"action",title:"Faculty Registry",subtitle:"Manage Teachers & Staff",url:"/admin/teachers",keywords:["teacher","teachers","staff","faculty","employees","educators","mentors"]},{id:"nav-staff",entityId:"nav-staff",type:"action",title:"Support Staff",subtitle:"Manage Non-Teaching Staff",url:"/admin/staff",keywords:["staff","helper","driver","cleaner","security","admin staff"]},{id:"nav-payroll",entityId:"nav-payroll",type:"action",title:"Payroll & Salary",subtitle:"Process Staff Salaries",url:"/admin/salary",keywords:["salary","payroll","pay","wages","payslip","payment","bank","account","ctc"]},{id:"nav-leaves",entityId:"nav-leaves",type:"action",title:"Leave Management",subtitle:"Approve/Reject Requests",url:"/admin/leaves",keywords:["leave","request","approve","reject","permission","vacation","sick","casual","application"]},{id:"nav-fees",entityId:"nav-fees",type:"action",title:"Fee Management",subtitle:"Fee Dashboard & Collection",url:"/admin/fees",keywords:["fees","fee","payment","collection","finance","accounts","revenue"]},{id:"nav-fees-structures",entityId:"nav-fees-structures",type:"action",title:"Fee Structures",subtitle:"Configure Class Fees",url:"/admin/fees/structures",keywords:["structure","fee set","tuition","term","setup fees","amount"]},{id:"nav-fees-pending",entityId:"nav-fees-pending",type:"action",title:"Pending Dues Report",subtitle:"View Defaulters & Arrears",url:"/admin/fees/pending",keywords:["pending","due","dues","arrears","defaulters","unpaid","balance","outstanding","remind"]},{id:"nav-fees-custom",entityId:"nav-fees-custom",type:"action",title:"Custom Fees (Transport)",subtitle:"Manage Village/Transport Fees",url:"/admin/fees/custom",keywords:["custom","transport","bus","van","village","route","charges","optional"]},{id:"nav-timetable",entityId:"nav-timetable",type:"action",title:"Class Timetables",subtitle:"Manage Schedules & Periods",url:"/admin/timetable",keywords:["timetable","schedule","routine","period","class time","subject plan"]},{id:"nav-exams",entityId:"nav-exams",type:"action",title:"Examination Control",subtitle:"Schedule Exams & Marks",url:"/admin/exams",keywords:["exam","test","mark","grade","result","schedule","date sheet","hall ticket"]},{id:"nav-homework",entityId:"nav-homework",type:"action",title:"Homework & Diary",subtitle:"Assign & Review Tasks",url:"/admin/homework",keywords:["homework","diary","assignment","work","task","project"]},{id:"nav-attendance",entityId:"nav-attendance",type:"action",title:"Attendance Tracker",subtitle:"Student & Staff Attendance",url:"/admin/attendance",keywords:["attendance","present","absent","roll call","register","daily"]},{id:"nav-master",entityId:"nav-master",type:"action",title:"Master Data Center",subtitle:"Configure School Data",url:"/admin/master-data",keywords:["master","data","config","setup"]},{id:"nav-classes",entityId:"nav-classes",type:"action",title:"Classes & Sections",subtitle:"Manage Grade Levels",url:"/admin/master-data/classes-sections",keywords:["class","grade","standard","section","division","stream"]},{id:"nav-subjects",entityId:"nav-subjects",type:"action",title:"Subjects & Curriculum",subtitle:"Manage Subjects",url:"/admin/master-data/subjects",keywords:["subject","book","course","syllabus","topic"]},{id:"nav-villages",entityId:"nav-villages",type:"action",title:"Villages & Routes",subtitle:"Manage Transport Locations",url:"/admin/master-data/villages",keywords:["village","location","place","stop","area","address"]},{id:"nav-cms",entityId:"nav-cms",type:"action",title:"Website Manager",subtitle:"Edit School Website",url:"/admin/cms",keywords:["cms","website","content","news","event","gallery","photo","banner","public"]},{id:"nav-settings",entityId:"nav-settings",type:"action",title:"Settings",subtitle:"Profile & System",url:"/admin/settings",keywords:["setting","password","profile","account","security","logout","change"]}];async function eo(e,t=5){if(!e||e.length<2)return[];let s=e.toLowerCase().trim(),a=[],n=function(e){let t=e.toLowerCase().trim();if(t.length<2)return[];let s=[],a=t.split(/\s+/).filter(e=>e.length>1);el.forEach(e=>{let n=0;e.keywords.forEach(e=>{e===t?n+=100:e.includes(t)?n+=50:t.includes(e)&&(n+=40)});let r=0;a.forEach(t=>{(e.keywords.some(e=>e.includes(t))||e.title.toLowerCase().includes(t)||e.subtitle.toLowerCase().includes(t))&&r++}),r===a.length?n+=30:r>0&&(n+=10*r),n>15&&s.push({...e,metadata:{score:n}})}),s.sort((e,t)=>(t.metadata?.score||0)-(e.metadata?.score||0));let n=t.match(/class\s+(\d+|[a-zA-Z]+)/i),r=["time","schedule","routine","period"].some(e=>t.includes(e)),i=["student","list","directory","children"].some(e=>t.includes(e)),l=["exam","test","mark","result"].some(e=>t.includes(e)),o=["fee","due","pending","paid"].some(e=>t.includes(e));if(n){let e=n[1];r&&s.unshift({id:`intent-timetable-${e}`,entityId:`intent-timetable-${e}`,type:"action",title:`Timetable: Class ${e}`,subtitle:`View schedule for Class ${e}`,url:`/admin/timetable?class=${e}`,keywords:["timetable","class",e]}),i&&s.unshift({id:`intent-students-${e}`,entityId:`intent-students-${e}`,type:"action",title:`Student List: Class ${e}`,subtitle:`View students in Class ${e}`,url:`/admin/students?class=${e}`,keywords:["students","class",e]}),l&&s.unshift({id:`intent-exams-${e}`,entityId:`intent-exams-${e}`,type:"action",title:`Exams: Class ${e}`,subtitle:`View exam schedule/marks for Class ${e}`,url:`/admin/exams?class=${e}`,keywords:["exam","class",e]}),o&&s.unshift({id:`intent-fees-${e}`,entityId:`intent-fees-${e}`,type:"action",title:`Fee Status: Class ${e}`,subtitle:`View fee reports for Class ${e}`,url:`/admin/fees?class=${e}`,keywords:["fee","class",e]})}return s.slice(0,5)}(s);a.push(...n);try{let e=(0,C.query)((0,C.collection)(D.db,"search_index"),(0,C.where)("keywords","array-contains",s),(0,C.limit)(t)),n=(await (0,C.getDocs)(e)).docs.map(e=>e.data());a.push(...n)}catch(e){console.error("Global search failed:",e)}return a}function ed(){let e=(0,a.useRouter)(),[n,l]=(0,s.useState)(!1),[o,d]=(0,s.useState)(""),[c,u]=(0,s.useState)([]),[m,p]=(0,s.useState)(!1),x=function(e,t){let[a,n]=(0,s.useState)(e);return(0,s.useEffect)(()=>{let t=setTimeout(()=>n(e),200);return()=>clearTimeout(t)},[e,200]),a}(o,0),[f,b]=(0,s.useState)(-1),g=(0,s.useRef)(null),y=(0,s.useRef)(null);(0,s.useEffect)(()=>{(async()=>{if(x.length<2){u([]),l(!1);return}p(!0);try{let e=await eo(x);u(e),b(-1),l(!0)}catch(e){console.error(e)}finally{p(!1)}})()},[x]),(0,s.useEffect)(()=>{let e=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),g.current?.focus())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);let v=t=>{"action"===t.type&&t.url.includes("?")?window.location.href=t.url:e.push(t.url),l(!1),d("")};return(0,s.useEffect)(()=>{let e=e=>{y.current&&!y.current.contains(e.target)&&l(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,t.jsxs)("div",{ref:y,className:"relative w-full max-w-xl group",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(U.Search,{className:(0,i.cn)("absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 transition-colors",n?"text-accent":"text-muted-foreground")}),(0,t.jsx)("input",{ref:g,type:"text",value:o,onChange:e=>d(e.target.value),onFocus:()=>{c.length>0&&o.length>=2&&l(!0)},onKeyDown:e=>{("ArrowDown"===e.key||"ArrowUp"===e.key)&&(e.preventDefault(),!n&&c.length>0&&l(!0)),n&&0!==c.length&&("ArrowDown"===e.key?(e.preventDefault(),b(e=>e<c.length-1?e+1:e)):"ArrowUp"===e.key?(e.preventDefault(),b(e=>e>0?e-1:e)):"Enter"===e.key?(e.preventDefault(),f>=0&&v(c[f])):"Escape"===e.key&&(l(!1),g.current?.blur()))},placeholder:"Search global...",className:"w-full h-10 bg-white/5 border border-white/10 rounded-full pl-10 pr-10 text-sm text-foreground focus:outline-none focus:ring-1 focus:ring-accent/50 focus:border-accent/50 transition-all placeholder:text-muted-foreground/50"}),(0,t.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center",children:m?(0,t.jsx)(r.Loader2,{className:"w-4 h-4 animate-spin text-accent"}):o?(0,t.jsx)("button",{onClick:()=>{d(""),u([]),l(!1)},className:"text-muted-foreground hover:text-white",children:(0,t.jsx)(en.X,{className:"w-4 h-4"})}):(0,t.jsxs)("kbd",{className:"hidden md:flex pointer-events-none h-5 select-none items-center gap-1 rounded border border-white/10 bg-white/5 px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100",children:[(0,t.jsx)("span",{className:"text-xs",children:"âŒ˜"}),"K"]})})]}),n&&o.length>=2&&(0,t.jsx)("div",{className:"absolute top-12 left-0 right-0 z-50 bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl overflow-hidden animate-in fade-in slide-in-from-top-2",children:0!==c.length||m?(0,t.jsx)("div",{className:"py-2 max-h-[60vh] overflow-y-auto",children:c.map((e,s)=>(0,t.jsxs)("button",{onClick:()=>v(e),className:(0,i.cn)("w-full text-left px-4 py-3 flex items-center gap-3 transition-colors",s===f?"bg-accent/10":"hover:bg-white/5"),children:[(0,t.jsx)("div",{className:(0,i.cn)("w-8 h-8 rounded-full flex items-center justify-center border border-white/10 bg-white/5",s===f?"border-accent/20 bg-accent/20":""),children:(e=>{switch(e){case"student":return(0,t.jsx)(R.User,{className:"w-4 h-4 text-blue-400"});case"payment":return(0,t.jsx)(er.CreditCard,{className:"w-4 h-4 text-green-400"});case"teacher":return(0,t.jsx)(R.User,{className:"w-4 h-4 text-purple-400"});case"action":return(0,t.jsx)(ei,{className:"w-4 h-4 text-amber-400"});default:return(0,t.jsx)(h.FileText,{className:"w-4 h-4 text-gray-400"})}})(e.type)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium text-sm text-foreground truncate",children:e.title}),"student"===e.type&&(0,t.jsx)("span",{className:"text-[10px] uppercase tracking-wider bg-blue-500/10 text-blue-400 px-1.5 rounded",children:"Student"}),"payment"===e.type&&(0,t.jsx)("span",{className:"text-[10px] uppercase tracking-wider bg-green-500/10 text-green-400 px-1.5 rounded",children:"Fee"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.subtitle})]}),s===f&&(0,t.jsx)(w.ChevronRight,{className:"w-4 h-4 text-accent"})]},e.id))}):(0,t.jsxs)("div",{className:"p-4 text-center text-sm text-muted-foreground",children:['No results found for "',o,'"']})})]})}var ec=e.i(32731);function eu(){let{user:e,signOut:a}=(0,n.useAuth)(),{academicYears:r,selectedYear:l,setSelectedYear:o}=(0,M.useMasterData)(),{history:d,clearHistory:c,removeFromHistory:u}=(0,P.useToastStore)(),[m,p]=(0,s.useState)(!1),[x,f]=(0,s.useState)("ADMIN"),[b,g]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{g(!0)},[]),(0,s.useEffect)(()=>{if(!e)return;let t=(0,C.onSnapshot)((0,C.doc)(D.db,"users",e.uid),e=>{e.exists()&&f(e.data().role)});return()=>t()},[e]),(0,s.useEffect)(()=>{let e=document.querySelector("main");if(!e)return;let t=()=>{p(e.scrollTop>20)};return e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[]),(0,t.jsx)("header",{className:`h-16 sticky top-0 z-40 transition-all duration-300 flex items-center justify-between px-2 md:px-4 ${m?"bg-[#0A192F]/80 backdrop-blur-md border-b border-[#64FFDA]/10 shadow-lg":"bg-[#0A192F] md:bg-transparent"}`,children:b?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ea,{}),(0,t.jsx)("div",{className:"flex-1 min-w-0 max-w-[140px] xs:max-w-[180px] sm:max-w-xl mx-1 md:mx-4",children:(0,t.jsx)(ed,{})}),(0,t.jsxs)("div",{className:"flex items-center gap-1 md:gap-4 shrink-0 px-1",children:[(0,t.jsxs)("div",{className:"hidden sm:flex items-center gap-2 mr-2",children:[(0,t.jsxs)(z.DropdownMenu,{children:[(0,t.jsx)(z.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)($.Button,{variant:"outline",size:"sm",className:(0,i.cn)("h-9 gap-2 rounded-full border-[#64FFDA]/20 px-4 bg-[#0A192F]/40 transition-all",r[l]?.active?"text-[#64FFDA]/80 hover:bg-[#64FFDA]/10":"text-amber-400 border-amber-500/30 bg-amber-500/10 hover:bg-amber-500/20"),children:[(0,t.jsx)(T.CalendarClock,{size:16}),(0,t.jsx)("span",{className:"text-xs font-bold font-mono",children:l})]})}),(0,t.jsxs)(z.DropdownMenuContent,{align:"end",className:"bg-[#0A192F]/95 backdrop-blur-xl border border-[#64FFDA]/20 text-white min-w-[150px]",children:[(0,t.jsx)(z.DropdownMenuLabel,{className:"text-[10px] uppercase tracking-widest opacity-50",children:"Academic Session"}),(0,t.jsx)(z.DropdownMenuSeparator,{className:"bg-white/10"}),Object.values(r).sort((e,t)=>t.id.localeCompare(e.id)).map(e=>(0,t.jsxs)(z.DropdownMenuItem,{onClick:()=>o(e.id),className:(0,i.cn)("cursor-pointer text-xs font-bold font-mono flex items-center justify-between",l===e.id?"bg-[#64FFDA]/20 text-[#64FFDA]":"hover:bg-white/5",!e.active&&"text-zinc-400"),children:[e.id,e.active&&(0,t.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_5px_#10b981]"})]},e.id))]})]}),(0,t.jsx)(q,{}),(0,t.jsxs)($.Button,{variant:"outline",size:"sm",className:"h-9 gap-2 rounded-full border-[#64FFDA]/20 hover:bg-[#64FFDA]/10 hover:text-[#64FFDA] px-4 bg-[#0A192F]/40 text-[#64FFDA]/80",children:[(0,t.jsx)(L.Plus,{size:16}),(0,t.jsx)("span",{className:"text-xs font-bold",children:"Action"})]})]}),(0,t.jsx)(ec.NotificationCenter,{role:x}),(0,t.jsxs)(z.DropdownMenu,{children:[(0,t.jsx)(z.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)("button",{className:"w-9 h-9 rounded-full bg-[#0A192F]/40 p-0.5 border border-[#64FFDA]/20 hover:scale-105 transition-transform overflow-hidden shadow-lg",children:(0,t.jsx)("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-[#64FFDA] to-purple-600 flex items-center justify-center text-[10px] font-bold text-black",children:e?.email?.charAt(0).toUpperCase()||"U"})})}),(0,t.jsxs)(z.DropdownMenuContent,{align:"end",className:"w-56 bg-[#0A192F]/90 backdrop-blur-xl border border-[#64FFDA]/20 text-white p-1 shadow-2xl rounded-xl mt-2",children:[(0,t.jsx)(z.DropdownMenuLabel,{className:"px-3 py-2 text-sm font-bold opacity-50 uppercase tracking-widest",children:"Account"}),(0,t.jsx)(z.DropdownMenuSeparator,{className:"bg-white/10 mx-1"}),(0,t.jsxs)(z.DropdownMenuItem,{className:"focus:bg-white/10 focus:text-white cursor-pointer rounded-lg px-3 py-2 text-sm font-medium",children:[(0,t.jsx)(R.User,{className:"mr-3 h-4 w-4"}),(0,t.jsx)("span",{children:"Profile"})]}),(0,t.jsxs)(z.DropdownMenuItem,{className:"focus:bg-white/10 focus:text-white cursor-pointer rounded-lg px-3 py-2 text-sm font-medium",children:[(0,t.jsx)(h.FileText,{className:"mr-3 h-4 w-4"}),(0,t.jsx)("span",{children:"Billing"})]}),(0,t.jsx)(z.DropdownMenuSeparator,{className:"bg-white/10 mx-1"}),(0,t.jsx)(z.DropdownMenuItem,{onClick:a,className:"text-white hover:bg-white/10 focus:bg-white/10 focus:text-white cursor-pointer rounded-lg px-3 py-2 text-sm font-medium",children:(0,t.jsx)("span",{children:"Log out"})})]})]})]})]}):null})}function em({children:e}){let{user:i,loading:l}=(0,n.useAuth)(),o=(0,a.useRouter)();return(0,s.useEffect)(()=>{l||i||o.push("/login?redirect="+encodeURIComponent(window.location.pathname))},[i,l,o]),(0,t.jsxs)("div",{className:"flex h-screen bg-gradient-to-br from-[#0A192F] via-[#112240] to-[#0A192F] text-foreground font-sans overflow-hidden",children:[(0,t.jsx)("div",{className:"hidden lg:flex h-full shrink-0",children:(0,t.jsx)(E,{})}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col relative min-w-0 overflow-hidden",children:[(0,t.jsx)(eu,{}),(0,t.jsx)("main",{className:"flex-1 p-1 md:p-2 overflow-y-auto scrollbar-thin scrollbar-thumb-white/10 hover:scrollbar-thumb-white/20",children:(0,t.jsx)("div",{className:"max-w-none space-y-4 md:space-y-6 px-1 md:px-2",children:!i&&l?(0,t.jsx)("div",{className:"flex items-center justify-center h-[60vh]",children:(0,t.jsx)(r.Loader2,{className:"w-8 h-8 animate-spin text-accent"})}):i?e:null})})]})]})}e.s(["default",()=>em],88760)}]);