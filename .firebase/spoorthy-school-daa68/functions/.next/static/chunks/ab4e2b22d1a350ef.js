(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,64367,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),l=e.i(77572),r=e.i(19455),i=e.i(7233),d=e.i(84614),n=e.i(63727),c=e.i(55436),o=e.i(34161),x=e.i(27612),h=e.i(12426),m=e.i(43432),u=e.i(93479);e.i(36180);var p=e.i(98925),g=e.i(59141),b=e.i(10204),j=e.i(76639),f=e.i(67489),w=e.i(31278),N=e.i(43531),y=e.i(72498),v=e.i(80691),S=e.i(32341);function k({isOpen:e,onClose:a,onSuccess:l}){let{user:i}=(0,S.useAuth)(),{subjects:d}=(0,y.useMasterData)(),[n,c]=(0,s.useState)([]),[o,x]=(0,s.useState)("");(0,s.useEffect)(()=>{if(!i)return;let e=(0,p.onSnapshot)((0,p.doc)(g.db,"users",i.uid),e=>{e.exists()&&x(e.data().role)});return()=>e()},[i]);let[h,m]=(0,s.useState)({name:"",mobile:"",age:"",address:"",salary:"",qualifications:"",primarySubject:"",secondarySubject:"",classTeacherClass:"",classTeacherSection:""}),[k,C]=(0,s.useState)(!1),[T,I]=(0,s.useState)(null);(0,s.useEffect)(()=>{e&&(I(null),m({name:"",mobile:"",age:"",address:"",salary:"",qualifications:"",primarySubject:"",secondarySubject:"",classTeacherClass:"",classTeacherSection:""}),c(Object.values(d||{}).filter(e=>!1!==e.isActive).sort((e,t)=>e.name.localeCompare(t.name))))},[e,d]);let D=async e=>{e.preventDefault(),C(!0);try{let e=[];h.primarySubject&&e.push(h.primarySubject),h.secondarySubject&&h.secondarySubject!==h.primarySubject&&e.push(h.secondarySubject);let t=await fetch("/api/admin/teachers/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...h,age:Number(h.age),salary:"MANAGER"===o?0:Number(h.salary),subjects:e,classTeacherOf:h.classTeacherClass?{classId:h.classTeacherClass,sectionId:h.classTeacherSection||"A"}:null})}),s=await t.json();if(!t.ok)throw Error(s.error);(0,v.toast)({title:"Teacher Created",description:`Successfully created account for ${h.name}`,type:"success"}),I({teacherId:s.teacherId,password:h.mobile}),l()}catch(e){(0,v.toast)({title:"Creation Failed",description:e.message||"Could not create teacher account.",type:"error"})}finally{C(!1)}};return(0,t.jsx)(j.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(j.DialogContent,{className:"bg-black/95 border-white/10 text-white sm:max-w-[600px]",children:[(0,t.jsx)(j.DialogHeader,{children:(0,t.jsx)(j.DialogTitle,{children:"Add New Teacher"})}),T?(0,t.jsxs)("div",{className:"py-6 text-center space-y-6",children:[(0,t.jsx)("div",{className:"mx-auto w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center text-blue-500",children:(0,t.jsx)(N.Check,{className:"w-8 h-8"})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold text-blue-400",children:"Teacher Account Created"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"The teacher can now login using these credentials."})]}),(0,t.jsxs)("div",{className:"bg-white/5 p-6 rounded-xl border border-white/10 max-w-sm mx-auto space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-sm uppercase tracking-wider",children:"Teacher ID"}),(0,t.jsx)("span",{className:"font-mono font-bold text-xl",children:T.teacherId})]}),(0,t.jsx)("div",{className:"h-px bg-white/10"}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-sm uppercase tracking-wider",children:"Password"}),(0,t.jsx)("span",{className:"font-mono font-bold text-xl",children:T.password})]})]}),(0,t.jsx)(r.Button,{onClick:a,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:"Done"})]}):(0,t.jsxs)("form",{onSubmit:D,className:"grid grid-cols-2 gap-4 py-2",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Full Name"}),(0,t.jsx)(u.Input,{required:!0,value:h.name,onChange:e=>m({...h,name:e.target.value}),className:"bg-white/5 border-white/10"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Mobile (Login Password)"}),(0,t.jsx)(u.Input,{required:!0,type:"tel",maxLength:10,value:h.mobile,onChange:e=>m({...h,mobile:e.target.value}),className:"bg-white/5 border-white/10 font-mono"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Age"}),(0,t.jsx)(u.Input,{required:!0,type:"number",min:"18",value:h.age,onChange:e=>m({...h,age:e.target.value}),className:"bg-white/5 border-white/10"})]}),"MANAGER"!==o&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Monthly Salary (₹)"}),(0,t.jsx)(u.Input,{required:!0,type:"number",value:h.salary,onChange:e=>m({...h,salary:e.target.value}),className:"bg-white/5 border-white/10"})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Primary Subject"}),(0,t.jsxs)(f.Select,{value:h.primarySubject,onValueChange:e=>m({...h,primarySubject:e}),children:[(0,t.jsx)(f.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(f.SelectValue,{placeholder:"Select"})}),(0,t.jsx)(f.SelectContent,{children:n.map(e=>(0,t.jsxs)(f.SelectItem,{value:e.name||"Unknown",children:[e.name||"Unknown"," (",e.code||"?",")"]},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Secondary Subject (Optional)"}),(0,t.jsxs)(f.Select,{value:h.secondarySubject,onValueChange:e=>m({...h,secondarySubject:e}),children:[(0,t.jsx)(f.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(f.SelectValue,{placeholder:"None"})}),(0,t.jsxs)(f.SelectContent,{children:[(0,t.jsx)(f.SelectItem,{value:"NONE",children:"None"}),n.filter(e=>e.name!==h.primarySubject).map(e=>(0,t.jsxs)(f.SelectItem,{value:e.name||"Unknown",children:[e.name||"Unknown"," (",e.code||"?",")"]},e.id))]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Address"}),(0,t.jsx)(u.Input,{required:!0,value:h.address,onChange:e=>m({...h,address:e.target.value}),className:"bg-white/5 border-white/10"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Qualifications"}),(0,t.jsx)(u.Input,{required:!0,value:h.qualifications,onChange:e=>m({...h,qualifications:e.target.value}),className:"bg-white/5 border-white/10",placeholder:"e.g. B.Ed, M.Sc"})]}),(0,t.jsxs)("div",{className:"pt-4 border-t border-white/10",children:[(0,t.jsx)(b.Label,{className:"text-xs text-muted-foreground uppercase mb-2 block",children:"Class Teacher Assignment"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)(f.Select,{value:h.classTeacherClass,onValueChange:e=>m({...h,classTeacherClass:e}),children:[(0,t.jsx)(f.SelectTrigger,{className:"bg-white/5 border-white/10 text-xs",children:(0,t.jsx)(f.SelectValue,{placeholder:"Class"})}),(0,t.jsxs)(f.SelectContent,{children:[(0,t.jsx)(f.SelectItem,{value:"NONE",children:"None"}),Object.values((0,y.useMasterData)().classes).sort((e,t)=>e.order-t.order).map(e=>(0,t.jsx)(f.SelectItem,{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)(f.Select,{value:h.classTeacherSection,onValueChange:e=>m({...h,classTeacherSection:e}),children:[(0,t.jsx)(f.SelectTrigger,{className:"bg-white/5 border-white/10 text-xs",children:(0,t.jsx)(f.SelectValue,{placeholder:"Section"})}),(0,t.jsx)(f.SelectContent,{children:Object.values((0,y.useMasterData)().sections).map(e=>(0,t.jsx)(f.SelectItem,{value:e.id,children:e.name},e.id))})]})]})]})]}),(0,t.jsx)(j.DialogFooter,{className:"col-span-2 mt-4",children:(0,t.jsx)(r.Button,{type:"submit",disabled:k,className:"w-full bg-white text-black hover:bg-zinc-200",children:k?(0,t.jsx)(w.Loader2,{className:"w-4 h-4 animate-spin"}):"Create Teacher Account"})})]})]})})}var C=e.i(75254);let T=(0,C.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function I({isOpen:e,onClose:a,onSuccess:l}){let{user:i}=(0,S.useAuth)(),[d,n]=(0,s.useState)([]),[c,o]=(0,s.useState)(!1),[x,h]=(0,s.useState)("");(0,s.useEffect)(()=>{if(!i)return;let e=(0,p.onSnapshot)((0,p.doc)(g.db,"users",i.uid),e=>{e.exists()&&h(e.data().role)});return()=>e()},[i]);let[m,N]=(0,s.useState)({roleId:"",name:"",mobile:"",address:""}),[y,k]=(0,s.useState)(!1),[C,I]=(0,s.useState)("");(0,s.useEffect)(()=>{e&&(I(""),N({roleId:"",name:"",mobile:"",address:""}),D())},[e]);let D=async()=>{o(!0);try{let e=(0,p.query)((0,p.collection)(g.db,"master_staff_roles"),(0,p.where)("hasLogin","==",!1)),t=await (0,p.getDocs)(e);n(t.docs.map(e=>({id:e.id,...e.data()})))}catch(e){console.error(e),(0,v.toast)({title:"Error",description:"Could not fetch roles.",type:"error"})}finally{o(!1)}},E=async e=>{e.preventDefault(),k(!0);try{let e=d.find(e=>e.id===m.roleId);if(!e)throw Error("Invalid Role");let t=await fetch("/api/admin/staff/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roleId:m.roleId,roleName:e.name,roleCode:e.code,baseSalary:e.basicSalary,name:m.name,mobile:m.mobile,address:m.address})}),s=await t.json();if(!t.ok)throw Error(s.error);(0,v.toast)({title:"Staff Created",description:`Created staff record for ${m.name}`,type:"success"}),I(s.staffId),l()}catch(e){(0,v.toast)({title:"Creation Failed",description:e.message||"Something went wrong.",type:"error"})}finally{k(!1)}},A=d.find(e=>e.id===m.roleId);return(0,t.jsx)(j.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(j.DialogContent,{className:"bg-black/95 border-white/10 text-white sm:max-w-[425px]",children:[(0,t.jsx)(j.DialogHeader,{children:(0,t.jsx)(j.DialogTitle,{children:"Add Non-Teaching Staff"})}),C?(0,t.jsxs)("div",{className:"py-6 text-center space-y-4",children:[(0,t.jsx)("div",{className:"mx-auto w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center text-green-500",children:(0,t.jsx)(T,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-green-400",children:"Staff Created!"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2",children:"Staff ID Generated:"}),(0,t.jsx)("p",{className:"text-2xl font-mono font-bold tracking-wider mt-1",children:C})]}),(0,t.jsx)(r.Button,{onClick:a,className:"w-full bg-white text-black hover:bg-zinc-200",children:"Done"})]}):(0,t.jsxs)("form",{onSubmit:E,className:"space-y-4 py-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Job Role"}),(0,t.jsxs)(f.Select,{value:m.roleId,onValueChange:e=>N({...m,roleId:e}),disabled:c,children:[(0,t.jsx)(f.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(f.SelectValue,{placeholder:c?"Loading roles...":"Select Role"})}),(0,t.jsx)(f.SelectContent,{className:"bg-black border-white/10 text-white",children:d.map(e=>(0,t.jsxs)(f.SelectItem,{value:e.id,children:[e.name," (",e.code,")"]},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Full Name"}),(0,t.jsx)(u.Input,{required:!0,value:m.name,onChange:e=>N({...m,name:e.target.value}),className:"bg-white/5 border-white/10",placeholder:"e.g. Ramesh Kumar"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Mobile Number"}),(0,t.jsx)(u.Input,{required:!0,type:"tel",pattern:"[0-9]{10}",value:m.mobile,onChange:e=>N({...m,mobile:e.target.value}),className:"bg-white/5 border-white/10 font-mono",placeholder:"e.g. 9876543210",maxLength:10})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b.Label,{children:"Address"}),(0,t.jsx)(u.Input,{required:!0,value:m.address,onChange:e=>N({...m,address:e.target.value}),className:"bg-white/5 border-white/10",placeholder:"Residential Address"})]}),A&&"MANAGER"!==x&&(0,t.jsxs)("div",{className:"p-3 rounded bg-white/5 border border-white/10 text-sm flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Standard Basic Salary:"}),(0,t.jsxs)("span",{className:"font-mono font-bold",children:["₹",A.basicSalary?.toLocaleString()]})]}),(0,t.jsx)(j.DialogFooter,{className:"mt-4",children:(0,t.jsx)(r.Button,{type:"submit",disabled:y||!m.roleId,className:"w-full bg-white text-black hover:bg-zinc-200",children:y?(0,t.jsx)(w.Loader2,{className:"w-4 h-4 animate-spin"}):"Create Staff Record"})})]})]})})}var D=e.i(87828),E=e.i(55146),A=e.i(51537),L=e.i(83211),R=e.i(75157),B=e.i(87486),M=e.i(69049);function U({hideHeader:e=!1,onTabChange:b}){let j=(0,a.useRouter)(),{user:w}=(0,S.useAuth)(),[N,y]=(0,s.useState)("");(0,s.useEffect)(()=>{if(!w)return;let e=(0,p.onSnapshot)((0,p.doc)(g.db,"users",w.uid),e=>{e.exists()&&y(e.data().role)});return()=>e()},[w]);let[v,C]=(0,s.useState)("teachers");(0,s.useEffect)(()=>{b?.(v)},[v,b]);let[T,U]=(0,s.useState)([]),[O,P]=(0,s.useState)([]),[z,V]=(0,s.useState)(!0),[q,F]=(0,s.useState)(""),[Y,G]=(0,s.useState)("ALL"),[$,H]=(0,s.useState)([]),[_,J]=(0,s.useState)(!1),[K,Q]=(0,s.useState)(!1),[W,X]=(0,s.useState)(null),[Z,ee]=(0,s.useState)(!1),[et,es]=(0,s.useState)(null),[ea,el]=(0,s.useState)(!1),[er,ei]=(0,s.useState)(null),[ed,en]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=(0,p.query)((0,p.collection)(g.db,"teachers"),(0,p.orderBy)("schoolId")),t=(0,p.onSnapshot)(e,e=>{U(e.docs.map(e=>({id:e.id,...e.data()}))),V(!1)}),s=(0,p.query)((0,p.collection)(g.db,"staff"),(0,p.orderBy)("schoolId")),a=(0,p.onSnapshot)(s,e=>{P(e.docs.map(e=>({id:e.id,...e.data()}))),V(!1)}),l=(0,p.query)((0,p.collection)(g.db,"master_staff_roles"),(0,p.orderBy)("name")),r=(0,p.onSnapshot)(l,e=>{H(Array.from(new Map(e.docs.map(e=>({id:e.id,...e.data()})).map(e=>[e.code,e])).values()))});return()=>{t(),a(),r()}},[]);let ec=T.filter(e=>e.name?.toLowerCase().includes(q.toLowerCase())||e.schoolId?.toLowerCase().includes(q.toLowerCase())||e.mobile?.includes(q)),eo=O.filter(e=>{let t=e.name?.toLowerCase().includes(q.toLowerCase())||e.schoolId?.toLowerCase().includes(q.toLowerCase())||e.mobile?.includes(q),s="ALL"===Y||e.roleCode===Y;return t&&s});return(0,t.jsxs)("div",{className:(0,R.cn)("space-y-6 animate-in fade-in duration-500 max-w-7xl mx-auto pb-20",e?"p-0":"p-4 md:p-0"),children:[!e&&(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between pt-2 md:pt-4 gap-4 md:gap-6 px-2 md:px-0",children:[(0,t.jsxs)("div",{className:"space-y-0.5 md:space-y-1",children:[(0,t.jsx)("h1",{className:"text-2xl md:text-5xl font-display font-bold bg-gradient-to-r from-white to-white/60 bg-clip-text text-transparent italic leading-tight",children:"Faculty Registry"}),(0,t.jsxs)("p",{className:"text-muted-foreground text-[10px] md:text-lg tracking-tight uppercase font-black opacity-50",children:["Managing ",(0,t.jsxs)("span",{className:"text-white",children:[T.length+O.length," professional staff"]})," members"]})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(r.Button,{onClick:()=>"teachers"===v?J(!0):Q(!0),className:"h-10 md:h-12 flex-1 md:flex-initial bg-white text-black hover:bg-zinc-200 rounded-xl font-black uppercase tracking-tighter px-4 md:px-6 shadow-lg shadow-white/10 text-xs md:text-sm",children:[(0,t.jsx)(i.Plus,{className:"w-3.5 h-3.5 md:w-4 md:h-4 mr-2 stroke-[3]"})," Add ","teachers"===v?"Teacher":"Staff"]})})]}),(0,t.jsxs)(l.Tabs,{value:v,onValueChange:C,className:"space-y-4 md:space-y-6",children:[(0,t.jsxs)("div",{className:"px-2 md:px-0 space-y-3 md:space-y-4",children:[(0,t.jsxs)(l.TabsList,{className:"bg-black/40 border border-white/10 p-1 h-auto rounded-xl md:rounded-2xl backdrop-blur-md w-full sm:w-fit grid grid-cols-2",children:[(0,t.jsx)(l.TabsTrigger,{value:"teachers",className:"data-[state=active]:bg-white data-[state=active]:text-black rounded-lg md:rounded-xl py-1.5 md:py-2.5 font-bold transition-all text-xs md:text-sm",children:"Teachers"}),(0,t.jsx)(l.TabsTrigger,{value:"staff",className:"data-[state=active]:bg-white data-[state=active]:text-black rounded-lg md:rounded-xl py-1.5 md:py-2.5 font-bold transition-all text-xs md:text-sm",children:"Staff"})]}),(0,t.jsx)("div",{className:"bg-black/20 p-3 md:p-5 rounded-xl md:rounded-2xl border border-white/10 backdrop-blur-md space-y-3 md:space-y-4 shadow-2xl",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 md:gap-4",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(c.Search,{className:"absolute left-3 md:left-4 top-1/2 -translate-y-1/2 w-3.5 h-3.5 md:w-4 md:h-4 text-muted-foreground"}),(0,t.jsx)(u.Input,{placeholder:"Search name, ID, or mobile...",value:q,onChange:e=>F(e.target.value),className:"pl-9 md:pl-11 h-10 md:h-12 bg-white/5 border-white/10 rounded-lg md:rounded-xl focus:ring-accent/30 text-xs md:text-sm"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:["staff"===v&&(0,t.jsxs)(f.Select,{value:Y,onValueChange:G,children:[(0,t.jsx)(f.SelectTrigger,{className:"flex-1 md:w-[180px] h-10 md:h-12 bg-white/5 border-white/10 rounded-lg md:rounded-xl text-xs md:text-sm",children:(0,t.jsx)(f.SelectValue,{placeholder:"All Roles"})}),(0,t.jsxs)(f.SelectContent,{className:"bg-zinc-900 border-white/10 text-white",children:[(0,t.jsx)(f.SelectItem,{value:"ALL",children:"All Roles"}),$.filter(e=>!e.hasLogin).map(e=>(0,t.jsx)(f.SelectItem,{value:e.code,children:e.name},e.code))]})]}),(q||"ALL"!==Y)&&(0,t.jsx)(r.Button,{variant:"ghost",onClick:()=>{F(""),G("ALL")},className:"h-10 md:h-12 px-3 md:px-6 text-[8px] md:text-[10px] font-black uppercase tracking-widest text-muted-foreground hover:text-white rounded-lg md:rounded-xl border border-dashed border-white/10 transition-all shrink-0",children:"Clear"})]})]})})]}),(0,t.jsx)(l.TabsContent,{value:"teachers",className:"space-y-4 outline-none",children:(0,t.jsx)(M.DataTable,{data:ec,isLoading:z,onRowClick:e=>j.push(`/admin/teachers/${e.id}`),columns:[{key:"name",header:"Faculty Info",render:e=>(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-9 h-9 rounded-xl bg-white/5 flex items-center justify-center border border-white/5 group-hover:border-accent/30 transition-colors",children:(0,t.jsx)(d.User,{size:16,className:"text-white/40 group-hover:text-accent transition-colors"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-bold text-sm text-white group-hover:text-accent transition-colors leading-tight",children:e.name}),(0,t.jsx)("span",{className:"text-[10px] font-mono text-white/40 tracking-tighter uppercase",children:e.schoolId})]})]})},{key:"mobile",header:"Contact",render:e=>(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-white/60",children:[(0,t.jsx)(m.Phone,{size:12,className:"text-white/20"}),(0,t.jsx)("span",{className:"font-mono",children:e.mobile})]})},{key:"password",header:"Secret Key",render:e=>(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-[10px] text-amber-500/80 bg-amber-500/5 px-2 py-1 rounded border border-amber-500/10 w-fit",children:[(0,t.jsx)(o.Key,{size:10,className:"text-amber-500"}),(0,t.jsx)("span",{className:"font-mono tracking-wider font-bold",children:e.recoveryPassword||e.mobile})]})},{key:"salary",header:"Base Salary",headerClassName:"text-right",cellClassName:"text-right",render:e=>"MANAGER"===N?(0,t.jsx)("span",{className:"text-white/20",children:"••••••"}):(0,t.jsxs)("span",{className:"font-mono font-black text-sm text-emerald-400",children:["₹",e.salary?.toLocaleString()||"0"]})},{key:"status",header:"Status",headerClassName:"text-center",cellClassName:"text-center",render:e=>(0,t.jsx)(B.Badge,{className:(0,R.cn)("text-[9px] font-black uppercase tracking-tighter py-0 h-5 border-none transition-all","ACTIVE"===e.status?"bg-emerald-500/10 text-emerald-400":"bg-red-500/10 text-red-400"),children:e.status})}],actions:e=>(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)(E.DropdownMenuItem,{onClick:()=>{e.uid?(X({uid:e.uid,schoolId:e.schoolId,name:e.name,role:"TEACHER"}),ee(!0)):alert("UID Missing")},className:"rounded-lg gap-2 text-xs font-bold text-amber-500 hover:text-amber-400 transition-colors",children:[(0,t.jsx)(o.Key,{size:14})," Reset Password"]}),"MANAGER"!==N&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(E.DropdownMenuItem,{onClick:()=>{ei({id:e.id,name:e.name,schoolId:e.schoolId,role:"TEACHER",currentSalary:e.salary||0}),en(!0)},className:"rounded-lg gap-2 text-xs font-bold text-emerald-500 hover:text-emerald-400 transition-colors",children:[(0,t.jsx)(h.DollarSign,{size:14})," Adjust Salary"]}),(0,t.jsxs)(E.DropdownMenuItem,{onClick:()=>{es({id:e.id,schoolId:e.schoolId,name:e.name,role:"teacher",uid:e.uid,collectionName:"teachers"}),el(!0)},className:"rounded-lg gap-2 text-xs font-bold text-red-500 hover:text-red-400 transition-colors",children:[(0,t.jsx)(x.Trash2,{size:14})," Remove Faculty"]})]})]})})}),(0,t.jsx)(l.TabsContent,{value:"staff",className:"space-y-4 outline-none",children:(0,t.jsx)(M.DataTable,{data:eo,isLoading:z,onRowClick:e=>j.push(`/admin/staff/${e.id}`),columns:[{key:"name",header:"Staff Info",render:e=>(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-9 h-9 rounded-xl bg-white/5 flex items-center justify-center border border-white/5 group-hover:border-blue-400/30 transition-colors",children:(0,t.jsx)(n.Briefcase,{size:16,className:"text-white/40 group-hover:text-blue-400 transition-colors"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-bold text-sm text-white group-hover:text-blue-400 transition-colors leading-tight",children:e.name}),(0,t.jsx)("span",{className:"text-[10px] font-mono text-white/40 tracking-tighter uppercase",children:e.schoolId})]})]})},{key:"role",header:"Role & Placement",render:e=>{let s=$.find(t=>t.code===e.roleCode);return(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("span",{className:"text-[10px] uppercase font-black text-muted-foreground tracking-tighter bg-white/5 px-2 py-0.5 rounded border border-white/5 w-fit lowercase",children:s?.name||e.roleCode||"Staff"}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-[10px] text-white/30",children:[(0,t.jsx)(m.Phone,{size:10,className:"opacity-40"}),(0,t.jsx)("span",{className:"font-mono",children:e.mobile})]})]})}},{key:"baseSalary",header:"Base Salary",headerClassName:"text-right",cellClassName:"text-right",render:e=>"MANAGER"===N?(0,t.jsx)("span",{className:"text-white/20",children:"••••••"}):(0,t.jsxs)("span",{className:"font-mono font-black text-sm text-emerald-400",children:["₹",e.baseSalary?.toLocaleString()||"0"]})},{key:"status",header:"Status",headerClassName:"text-center",cellClassName:"text-center",render:e=>(0,t.jsx)(B.Badge,{className:(0,R.cn)("text-[9px] font-black uppercase tracking-tighter py-0 h-5 border-none transition-all","ACTIVE"===e.status?"bg-emerald-500/10 text-emerald-400":"bg-red-500/10 text-red-400"),children:e.status})}],actions:e=>(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)(E.DropdownMenuItem,{onClick:()=>{e.uid?(X({uid:e.uid,schoolId:e.schoolId,name:e.name,role:"STAFF"}),ee(!0)):alert("UID Missing")},className:"rounded-lg gap-2 text-xs font-bold text-amber-500 hover:text-amber-400 transition-colors",children:[(0,t.jsx)(o.Key,{size:14})," Reset Password"]}),"MANAGER"!==N&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(E.DropdownMenuItem,{onClick:()=>{ei({id:e.id,name:e.name,schoolId:e.schoolId,role:"STAFF",currentSalary:e.baseSalary||0,roleCode:e.roleCode}),en(!0)},className:"rounded-lg gap-2 text-xs font-bold text-emerald-500 hover:text-emerald-400 transition-colors",children:[(0,t.jsx)(h.DollarSign,{size:14})," Adjust Salary"]}),(0,t.jsxs)(E.DropdownMenuItem,{onClick:()=>{es({id:e.id,schoolId:e.schoolId,name:e.name,role:"admin",uid:e.uid,collectionName:"staff"}),el(!0)},className:"rounded-lg gap-2 text-xs font-bold text-red-500 hover:text-red-400 transition-colors",children:[(0,t.jsx)(x.Trash2,{size:14})," Remove Staff"]})]})]})})})]}),(0,t.jsx)(k,{isOpen:_,onClose:()=>J(!1),onSuccess:()=>{}}),(0,t.jsx)(I,{isOpen:K,onClose:()=>Q(!1),onSuccess:()=>{}}),(0,t.jsx)(D.AdminChangePasswordModal,{isOpen:Z,onClose:()=>ee(!1),user:W,onSuccess:()=>{}}),(0,t.jsx)(L.AdjustSalaryModal,{isOpen:ed,onClose:()=>en(!1),person:er,onSuccess:()=>{}}),et&&(0,t.jsx)(A.DeleteUserModal,{isOpen:ea,onClose:()=>{el(!1),es(null)},user:et,checkEligibility:async()=>({canDelete:!0}),onDeactivate:async e=>{try{await (0,p.updateDoc)((0,p.doc)(g.db,et.collectionName,et.id),{status:"INACTIVE",deactivationReason:e,updatedAt:new Date().toISOString()})}catch(e){throw console.error(e),e}},onDelete:async e=>{if(!w)return void alert("Not authenticated");let t=await w.getIdToken(),s=await fetch("/api/admin/users/delete",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({targetUid:et.uid,schoolId:et.schoolId,role:et.role.toUpperCase(),collectionName:et.collectionName})}),a=await s.json();if(!a.success)throw Error(a.error)}})]})}var O=e.i(37727);let P=(0,C.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),z=(0,C.default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);var V=e.i(10980),q=e.i(97764);function F(){let{user:e}=(0,S.useAuth)(),[a,l]=(0,s.useState)([]),[i,d]=(0,s.useState)(!0),[n,c]=(0,s.useState)(null),[o,x]=(0,s.useState)(null),[h,m]=(0,s.useState)(null),[u,b]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=(0,p.query)((0,p.collection)(g.db,"leave_requests"),(0,p.orderBy)("createdAt","desc")),t=(0,p.onSnapshot)(e,e=>{l(e.docs.map(e=>({id:e.id,...e.data()}))),d(!1)},e=>{console.error("Leaves Listener Error:",e),d(!1)});return()=>t()},[]);let f=async e=>{x(e),b(!0),m(null);try{let t=(0,p.query)((0,p.collection)(g.db,"teachers"),(0,p.where)("uid","==",e.teacherId),(0,p.limit)(1)),s=await (0,p.getDocs)(t);if(!s.empty){let e=s.docs[0].data(),t=e.schoolId||e.teacherId||e.id||s.docs[0].id,a=await (0,p.getDoc)((0,p.doc)(g.db,"teacher_schedules",`2025-2026_${t}`));a.exists()&&m(a.data().schedule||{})}}catch(e){console.error("Impact Fetch Error",e)}finally{b(!1)}},y=async(t,s)=>{if(!e)return void alert("System is Verifying your identity... Please try again.");if(confirm("REVERT"===s?"This will remove all coverage assignments for this leave. Move back to Pending?":`Are you sure you want to ${s.toLowerCase()} this leave?`)){c(t);try{let a=await e.getIdToken(),l=await fetch("/api/admin/leaves/approve",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({leaveId:t,action:s})}),r=await l.json();r.success||alert("Error: "+r.error)}catch(e){alert(e.message)}finally{c(null)}}};return(0,t.jsx)("div",{className:"space-y-3 md:space-y-6 max-w-none p-0 animate-in fade-in",children:(0,t.jsxs)("div",{className:"mobile-dense-table overflow-hidden",children:[(0,t.jsx)(M.DataTable,{data:a,isLoading:i,columns:[{key:"teacherName",header:"Staff",render:e=>(0,t.jsx)("div",{className:"font-bold text-white truncate max-w-[60px] md:max-w-none text-[9px] md:text-sm",children:e.teacherName})},{key:"dates",header:"Term",render:e=>(0,t.jsxs)("div",{className:"text-white/70 leading-tight",children:[(0,t.jsx)("div",{className:"text-[8px] md:text-sm whitespace-nowrap",children:e.fromDate===e.toDate?(0,q.formatDateToDDMMYYYY)(e.fromDate):`${(0,q.formatDateToDDMMYYYY)(e.fromDate).split("/").slice(0,2).join("/")}..`}),(0,t.jsx)(B.Badge,{variant:"outline",className:"h-3 md:h-4 text-[7px] md:text-[10px] border-white/10 text-white/40 px-1 py-0 px-0.5",children:e.type.slice(0,4)})]})},{key:"reason",header:"Cause",render:e=>(0,t.jsx)("div",{className:"text-[8px] md:text-sm max-w-[50px] md:max-w-xs truncate text-white/50 italic",title:e.reason,children:e.reason})},{key:"status",header:"Status",render:e=>(0,t.jsxs)("div",{className:"scale-[0.8] md:scale-100 origin-left",children:["PENDING"===e.status&&(0,t.jsx)(B.Badge,{className:"bg-yellow-500/10 text-yellow-500 border border-yellow-500/20 py-0 px-1 text-[8px] md:text-xs",children:"Pend"}),"APPROVED"===e.status&&(0,t.jsx)(B.Badge,{className:"bg-emerald-500/10 text-emerald-500 border border-emerald-500/20 py-0 px-1 text-[8px] md:text-xs",children:"Appr"}),"REJECTED"===e.status&&(0,t.jsx)(B.Badge,{className:"bg-red-500/10 text-red-400 border border-red-500/20 py-0 px-1 text-[8px] md:text-xs",children:"Rej"})]})}],actions:e=>(0,t.jsxs)("div",{className:"flex flex-col gap-1 p-1",children:[(0,t.jsxs)(j.Dialog,{children:[(0,t.jsx)(j.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(r.Button,{size:"sm",variant:"ghost",className:"w-full justify-start gap-2 h-8 hover:bg-zinc-800 text-white/70",onClick:()=>f(e),children:[(0,t.jsx)(z,{className:"w-4 h-4"})," Impact Analysis"]})}),(0,t.jsxs)(j.DialogContent,{className:"bg-[#0A192F] border-white/10 text-white max-w-md",children:[(0,t.jsxs)(j.DialogHeader,{children:[(0,t.jsxs)(j.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(V.BookOpen,{className:"w-5 h-5 text-accent"}),"Classes Affected"]}),(0,t.jsx)(j.DialogDescription,{className:"text-white/60",children:"Teacher schedule for this leave period."})]}),(0,t.jsx)("div",{className:"space-y-4 py-4",children:u?(0,t.jsx)("div",{className:"flex justify-center p-8",children:(0,t.jsx)(w.Loader2,{className:"animate-spin text-accent"})}):h&&0!==Object.keys(h).length?(0,t.jsx)("div",{className:"space-y-4 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"].map(e=>{let s=h[e];return s&&0!==Object.keys(s).length?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(B.Badge,{variant:"outline",className:"border-accent/20 text-accent text-[10px] uppercase tracking-wider",children:e}),(0,t.jsx)("div",{className:"grid gap-2",children:Object.entries(s).map(([e,s])=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 rounded bg-white/5 border border-white/10",children:[(0,t.jsxs)("div",{className:"text-xs font-mono text-white/50",children:["Period ",e]}),(0,t.jsxs)("div",{className:"text-sm font-bold text-white",children:["Class ",s.classId]})]},e))})]},e):null})}):(0,t.jsx)("div",{className:"text-center p-8 text-white/40 italic",children:"No classes scheduled for this teacher."})})]})]}),"PENDING"===e.status?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.Button,{size:"sm",variant:"ghost",className:"w-full justify-start gap-2 h-8 hover:bg-emerald-500/10 text-emerald-400 font-bold",onClick:()=>y(e.id,"APPROVE"),disabled:n===e.id,children:[n===e.id?(0,t.jsx)(w.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(N.Check,{className:"w-4 h-4"}),"Approve Leave"]}),(0,t.jsxs)(r.Button,{size:"sm",variant:"ghost",className:"w-full justify-start gap-2 h-8 hover:bg-red-500/10 text-red-400 font-bold",onClick:()=>y(e.id,"REJECT"),disabled:n===e.id,children:[(0,t.jsx)(O.X,{className:"w-4 h-4"})," Reject Leave"]})]}):(0,t.jsxs)(r.Button,{size:"sm",variant:"ghost",className:"w-full justify-start gap-2 h-8 text-white/40 hover:text-white",onClick:()=>y(e.id,"REVERT"),disabled:n===e.id,children:[n===e.id?(0,t.jsx)(w.Loader2,{className:"w-3 h-3 animate-spin"}):(0,t.jsx)(P,{className:"w-3 h-3"}),"Revert Status"]})]})}),0===a.length&&!i&&(0,t.jsx)("div",{className:"text-center py-12 text-white/30 italic bg-black/10 rounded-xl border border-dashed border-white/10 text-sm",children:"No leave requests found."})]})})}var Y=e.i(15288),G=e.i(69638),$=e.i(96139);function H(){let[e,a]=(0,s.useState)([]),[l,i]=(0,s.useState)(!0),[d,n]=(0,s.useState)([]),[c,o]=(0,s.useState)(!1),[x,h]=(0,s.useState)(null),[m,u]=(0,s.useState)("SUBSTITUTE"),[b,N]=(0,s.useState)(""),[y,v]=(0,s.useState)(!1),[S,k]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=(0,p.query)((0,p.collection)(g.db,"coverage_tasks"),(0,p.orderBy)("createdAt","desc"),(0,p.limit)(100)),t=(0,p.onSnapshot)(e,e=>{a(e.docs.map(e=>({id:e.id,...e.data()}))),i(!1)},e=>{console.warn("Task Listener Error, falling back...",e);let t=(0,p.query)((0,p.collection)(g.db,"coverage_tasks"),(0,p.limit)(100));(0,p.onSnapshot)(t,e=>{a(e.docs.map(e=>({id:e.id,...e.data()}))),i(!1)})}),s=(0,p.query)((0,p.collection)(g.db,"teachers"),(0,p.where)("status","==","ACTIVE")),l=(0,p.onSnapshot)(s,e=>{n(e.docs.map(e=>({id:e.id,...e.data()})))});return()=>{t(),l()}},[]);let C=e=>{if(!e)return"N/A";let t=d.find(t=>t.id===e||t.schoolId===e||t.uid===e);return t?.name||e},I=async()=>{if(x){v(!0);try{let e=await fetch("/api/admin/timetable/coverage/resolve",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await g.auth.currentUser?.getIdToken()}`},body:JSON.stringify({taskId:x.id,resolutionType:m,substituteTeacherId:"SUBSTITUTE"===m?b:null})}),t=await e.json();t.success?h(null):alert(t.error)}catch(e){alert(e.message)}finally{v(!1)}}};return(0,t.jsxs)("div",{className:"space-y-4 md:space-y-6 max-w-none p-0 animate-in fade-in pb-20",children:[(0,t.jsx)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 px-1",children:(0,t.jsx)("div",{className:"flex items-center gap-2 w-full md:w-auto",children:(0,t.jsxs)("div",{className:"flex items-center gap-1 bg-white/5 p-1 rounded-xl border border-white/10 backdrop-blur-md",children:[(0,t.jsx)(r.Button,{variant:c?"ghost":"default",size:"sm",onClick:()=>o(!1),className:(0,R.cn)("text-[10px] h-8 px-4 font-black uppercase tracking-widest transition-all rounded-lg",c?"text-white/40 hover:text-white":"bg-accent text-black"),children:"Pending"}),(0,t.jsx)(r.Button,{variant:c?"default":"ghost",size:"sm",onClick:()=>o(!0),className:(0,R.cn)("text-[10px] h-8 px-4 font-black uppercase tracking-widest transition-all rounded-lg",c?"bg-accent text-black":"text-white/40 hover:text-white"),children:"Resolved"})]})})}),S&&(0,t.jsx)("div",{className:"p-4 bg-red-500/10 border border-red-500/20 text-red-500 rounded-xl text-sm mb-6",children:S}),l?(0,t.jsx)("div",{className:"p-10 flex justify-center",children:(0,t.jsx)(w.Loader2,{className:"animate-spin text-blue-500"})}):(0,t.jsx)("div",{className:"grid grid-cols-1 gap-3",children:0===e.filter(e=>c?"RESOLVED"===e.status:"PENDING"===e.status).length?(0,t.jsxs)("div",{className:"py-20 text-center border border-dashed border-white/10 rounded-xl bg-white/5",children:[(0,t.jsx)($.Coffee,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4 opacity-20"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["No ",c?"resolved":"pending"," coverage tasks ",c?"yet":"at the moment","."]})]}):e.filter(e=>c?"RESOLVED"===e.status:"PENDING"===e.status).map(e=>{let s=e.originalTeacherId,a=e.day||(e.date?new Date(e.date).toLocaleDateString("en-US",{weekday:"long"}).toUpperCase():"N/A");return(0,t.jsx)(Y.Card,{className:"bg-black/20 border-white/10 overflow-hidden hover:bg-white/5 transition-all group backdrop-blur-md rounded-2xl relative",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between p-3 md:p-5 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[(0,t.jsx)("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-xl bg-red-500/10 border border-red-500/20 flex items-center justify-center text-red-400 font-black text-[10px] flex-col shrink-0 italic shadow-inner",children:(0,t.jsxs)("span",{children:[e.date?.split("-")?.[1]||"??","/",e.date?.split("-")?.[2]||"??"]})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("h4",{className:"font-bold text-sm md:text-lg text-white group-hover:text-accent transition-colors leading-tight truncate",children:C(s)}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-[10px] text-muted-foreground flex-wrap font-bold uppercase tracking-widest opacity-60",children:[(0,t.jsx)("span",{className:"text-accent/60",children:a}),(0,t.jsx)("span",{className:"w-1 h-1 rounded-full bg-white/20"}),(0,t.jsxs)("span",{children:["Period ",e.slotId]}),(0,t.jsx)("span",{className:"w-1 h-1 rounded-full bg-white/20"}),(0,t.jsx)("span",{children:e.classId})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between md:justify-end w-full md:w-auto gap-3 border-t md:border-t-0 border-white/5 pt-3 md:pt-0",children:["PENDING"===e.status&&e.suggestedSubstituteId&&(0,t.jsxs)("div",{className:"text-left md:text-right md:mr-2 md:border-r border-white/10 md:pr-4",children:[(0,t.jsx)("div",{className:"text-[8px] text-blue-400 uppercase font-black tracking-widest mb-0.5",children:"Recommendation"}),(0,t.jsx)("div",{className:"text-xs font-bold text-white/90",children:"LEISURE"===e.suggestedType?"Leisure":C(e.suggestedSubstituteId)})]}),"RESOLVED"===e.status&&(0,t.jsxs)("div",{className:"text-left md:text-right md:mr-2",children:[(0,t.jsx)("div",{className:"text-[8px] text-muted-foreground uppercase font-black tracking-widest mb-0.5 opacity-40",children:"Resolved Status"}),(0,t.jsxs)("div",{className:"text-xs font-bold text-emerald-400 flex items-center gap-1.5",children:[(0,t.jsx)(G.CheckCircle,{className:"w-3 h-3"}),e.resolution?.type==="LEISURE"?"Leisure Mode":`Covered By ${C(e.resolution?.substituteTeacherId||"")}`]})]}),(0,t.jsxs)(j.Dialog,{open:x?.id===e.id,onOpenChange:e=>!e&&h(null),children:[(0,t.jsx)(j.DialogTrigger,{asChild:!0,children:(0,t.jsx)(r.Button,{size:"sm",onClick:()=>{h(e),"RESOLVED"===e.status&&e.resolution?(u("SUBSTITUTION"===e.resolution.type?"SUBSTITUTE":"LEISURE"),N(e.resolution.substituteTeacherId||"")):(u(e.suggestedType||"SUBSTITUTE"),N(e.suggestedSubstituteId||""))},className:(0,R.cn)("h-9 px-4 text-[10px] font-black uppercase tracking-widest rounded-xl transition-all","RESOLVED"===e.status?"bg-white/5 text-white/40 hover:text-white border border-white/10":"bg-blue-600 hover:bg-blue-700 text-white shadow-lg shadow-blue-900/20"),children:"RESOLVED"===e.status?"Manage":"Action"})}),(0,t.jsxs)(j.DialogContent,{className:"bg-[#0A192F] border-white/10 text-white rounded-2xl shadow-2xl shadow-black/50",children:[(0,t.jsxs)(j.DialogHeader,{children:[(0,t.jsxs)(j.DialogTitle,{className:"text-xl font-bold flex items-center gap-2 italic",children:[(0,t.jsx)(T,{className:"text-accent"})," Resolve Coverage"]}),(0,t.jsx)(j.DialogDescription,{className:"text-[10px] text-muted-foreground uppercase font-black tracking-widest opacity-60",children:"Choose how to handle this academic period."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"flex gap-2 p-1 bg-white/5 rounded-xl border border-white/10",children:[(0,t.jsxs)(r.Button,{variant:"SUBSTITUTE"===m?"default":"outline",onClick:()=>u("SUBSTITUTE"),className:(0,R.cn)("flex-1 h-10 text-[10px] font-black uppercase tracking-widest rounded-lg transition-all","SUBSTITUTE"===m?"bg-accent text-black hover:bg-accent/90":"bg-transparent text-white/40 border-none hover:text-white hover:bg-white/5"),children:[(0,t.jsx)(T,{className:"w-3.5 h-3.5 mr-2"})," Substitute"]}),(0,t.jsxs)(r.Button,{variant:"LEISURE"===m?"default":"outline",onClick:()=>u("LEISURE"),className:(0,R.cn)("flex-1 h-10 text-[10px] font-black uppercase tracking-widest rounded-lg transition-all","LEISURE"===m?"bg-accent text-black hover:bg-accent/90":"bg-transparent text-white/40 border-none hover:text-white hover:bg-white/5"),children:[(0,t.jsx)($.Coffee,{className:"w-3.5 h-3.5 mr-2"})," Leisure"]})]}),"SUBSTITUTE"===m&&(0,t.jsxs)("div",{className:"space-y-4 pt-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,t.jsx)("label",{className:"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1",children:"Select Substitute Teacher"}),(0,t.jsxs)("div",{className:"text-[8px] px-2 py-0.5 rounded-full bg-blue-500/10 text-blue-400 border border-blue-500/20 font-black uppercase tracking-tighter",children:["Recommended: ",C(e.suggestedSubstituteId||"")]})]}),(0,t.jsxs)(f.Select,{value:b,onValueChange:N,children:[(0,t.jsx)(f.SelectTrigger,{className:"h-12 bg-black/40 border-white/10 rounded-xl font-bold focus:ring-accent/20",children:(0,t.jsx)(f.SelectValue,{placeholder:"Choose Teacher"})}),(0,t.jsx)(f.SelectContent,{className:"bg-[#0A192F] border-white/10 text-white",children:d.filter(t=>(t.schoolId||t.id)!==e.originalTeacherId).map(e=>(0,t.jsx)(f.SelectItem,{value:e.schoolId||e.id,className:"focus:bg-accent focus:text-black font-bold text-xs",children:e.name},e.id))})]})]})]}),(0,t.jsx)(j.DialogFooter,{className:"pt-2",children:(0,t.jsx)(r.Button,{onClick:I,disabled:y||"SUBSTITUTE"===m&&!b,className:"w-full h-12 bg-accent text-black hover:bg-accent/90 font-black uppercase tracking-widest text-xs rounded-xl shadow-lg shadow-accent/20",children:y?(0,t.jsx)(w.Loader2,{className:"animate-spin w-4 h-4"}):"Finalize Resolution"})})]})]})]})]})},e.id)})})]})}var _=e.i(61911),J=e.i(87316),K=e.i(51737);function Q(){let e=(0,a.useSearchParams)(),[d,n]=(0,s.useState)(e.get("tab")||"directory"),[c,o]=(0,s.useState)("teachers"),[x,h]=(0,s.useState)(!1),[m,u]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let t=e.get("tab");t&&n(t)},[e]),(0,t.jsxs)("div",{className:"space-y-6 md:space-y-10 animate-in fade-in duration-500 pb-20",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 px-2 md:px-0",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h1",{className:"text-2xl md:text-5xl font-display font-bold bg-gradient-to-r from-white to-white/60 bg-clip-text text-transparent italic leading-tight",children:"Faculty & HR"}),(0,t.jsxs)("p",{className:"text-muted-foreground text-[10px] md:text-sm tracking-tight uppercase font-black opacity-50",children:["Consolidated Management: ",(0,t.jsx)("span",{className:"text-accent",children:"Directory • Leaves • Coverage"})]})]}),"directory"===d&&(0,t.jsxs)(r.Button,{onClick:()=>"teachers"===c?h(!0):u(!0),className:"h-10 md:h-12 bg-white text-black hover:bg-zinc-200 rounded-xl font-black uppercase tracking-tighter px-4 md:px-6 shadow-lg shadow-white/10 text-xs md:text-sm",children:[(0,t.jsx)(i.Plus,{className:"w-3.5 h-3.5 md:w-4 md:h-4 mr-2 stroke-[3]"})," Add ","teachers"===c?"Teacher":"Staff"]})]}),(0,t.jsxs)(l.Tabs,{value:d,onValueChange:n,className:"space-y-6",children:[(0,t.jsx)("div",{className:"px-2 md:px-0 bg-black/20 p-1 rounded-2xl border border-white/5 backdrop-blur-md sticky top-0 z-10 mx-2 md:mx-0",children:(0,t.jsxs)(l.TabsList,{className:"bg-transparent h-auto w-full grid grid-cols-3 gap-1",children:[(0,t.jsxs)(l.TabsTrigger,{value:"directory",className:"data-[state=active]:bg-white data-[state=active]:text-black rounded-xl py-2 md:py-3 font-bold transition-all text-[10px] md:text-sm flex flex-col md:flex-row items-center gap-1 md:gap-2",children:[(0,t.jsx)(_.Users,{size:14,className:"md:w-4 md:h-4"}),(0,t.jsx)("span",{children:"Directory"})]}),(0,t.jsxs)(l.TabsTrigger,{value:"leaves",className:"data-[state=active]:bg-white data-[state=active]:text-black rounded-xl py-2 md:py-3 font-bold transition-all text-[10px] md:text-sm flex flex-col md:flex-row items-center gap-1 md:gap-2",children:[(0,t.jsx)(J.Calendar,{size:14,className:"md:w-4 md:h-4"}),(0,t.jsx)("span",{children:"Leaves"})]}),(0,t.jsxs)(l.TabsTrigger,{value:"coverage",className:"data-[state=active]:bg-white data-[state=active]:text-black rounded-xl py-2 md:py-3 font-bold transition-all text-[10px] md:text-sm flex flex-col md:flex-row items-center gap-1 md:gap-2",children:[(0,t.jsx)(K.ShieldAlert,{size:14,className:"md:w-4 md:h-4"}),(0,t.jsx)("span",{children:"Coverage"})]})]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(l.TabsContent,{value:"directory",className:"outline-none m-0",children:(0,t.jsx)("div",{className:"bg-transparent",children:(0,t.jsx)(U,{hideHeader:!0,onTabChange:o})})}),(0,t.jsx)(l.TabsContent,{value:"leaves",className:"outline-none m-0 px-2 md:px-0",children:(0,t.jsx)(F,{})}),(0,t.jsx)(l.TabsContent,{value:"coverage",className:"outline-none m-0 px-2 md:px-0",children:(0,t.jsx)(H,{})})]})]}),(0,t.jsx)(k,{isOpen:x,onClose:()=>h(!1),onSuccess:()=>{}}),(0,t.jsx)(I,{isOpen:m,onClose:()=>u(!1),onSuccess:()=>{}})]})}function W(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,t.jsx)(w.Loader2,{className:"animate-spin text-accent"})}),children:(0,t.jsx)(Q,{})})}e.s(["default",()=>W],64367)}]);