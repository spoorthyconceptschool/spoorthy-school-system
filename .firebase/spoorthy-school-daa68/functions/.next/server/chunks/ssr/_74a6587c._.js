module.exports=[91119,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-2xl border border-[#64FFDA]/10 bg-[#112240]/40 backdrop-blur-lg text-white shadow-xl transition-all duration-300 hover:bg-[#112240]/60 hover:border-[#64FFDA]/30 hover:shadow-[0_0_20px_-5px_rgba(100,255,218,0.1)] group",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("font-bold text-xl tracking-tight text-white group-hover:text-accent transition-colors",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-white/60 font-medium",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},99570,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(11011),e=a.i(68114);let f=c.forwardRef(({className:a,variant:c="default",size:f="default",asChild:g=!1,...h},i)=>{let j=g?d.Slot:"button";return(0,b.jsx)(j,{className:(0,e.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-full text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 tracking-wide",{"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:scale-105 active:scale-95 transition-transform":"default"===c,"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm":"destructive"===c,"border border-white/20 bg-transparent hover:bg-white/10 hover:text-accent-foreground":"outline"===c,"bg-secondary text-secondary-foreground hover:bg-secondary/80":"secondary"===c,"hover:bg-white/10 hover:text-accent font-normal":"ghost"===c,"text-primary underline-offset-4 hover:underline":"link"===c,"bg-gradient-to-r from-accent to-accent/80 text-black font-bold hover:brightness-110 border-0 shadow-lg hover:shadow-accent/20":"gradient"===c,"bg-accent text-black font-bold hover:bg-accent/90 hover:scale-105 active:scale-95 transition-transform shadow-lg":"spotify"===c,"h-10 px-6 py-2":"default"===f,"h-9 px-4 text-xs":"sm"===f,"h-12 px-8 text-base":"lg"===f,"h-14 px-10 text-lg":"xl"===f,"h-10 w-10":"icon"===f},a),ref:i,...h})});f.displayName="Button",a.s(["Button",()=>f])},66718,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,type:c,...e},f)=>(0,b.jsx)("input",{type:c,className:(0,d.cn)("flex h-12 w-full rounded-full border border-white/10 bg-[#282828] px-4 py-3 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all shadow-inner hover:bg-[#333]",a),ref:f,...e}));e.displayName="Input",a.s(["Input",()=>e])},77994,a=>{"use strict";var b=a.i(72131);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},5784,a=>{"use strict";let b=(0,a.i(70106).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);a.s(["ChevronDown",()=>b],5784)},210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},14548,a=>{"use strict";let b=(0,a.i(70106).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);a.s(["Save",()=>b],14548)},73335,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(69387);var d=a.i(60574),e=a.i(20237),f=a.i(91410),g=a.i(99570),h=a.i(91119),i=a.i(66718),j=a.i(80701),k=a.i(96221),l=a.i(210),m=a.i(14548),n=a.i(50944);function o({params:a}){let{id:o}=(0,c.use)(a),p=(0,n.useRouter)(),{classes:q,sections:r,subjects:s,classSections:t,classSubjects:u,loading:v}=(0,f.useMasterData)(),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)([]),[I,J]=(0,c.useState)({}),[K,L]=(0,c.useState)("100"),[M,N]=(0,c.useState)({}),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(!1);(0,c.useEffect)(()=>{(async()=>{try{let a=await (0,d.getDoc)((0,d.doc)(e.db,"exams",o));a.exists()?x({id:a.id,...a.data()}):p.push("/teacher/exams")}catch(a){console.error(a)}finally{z(!1)}})()},[o]);let S=Object.values(t).filter(a=>a.classId===A&&a.active).map(a=>r[a.sectionId]).filter(Boolean),T=Object.keys(u[A]||{}).filter(a=>u[A][a]&&s[a]).map(a=>s[a]),U=async()=>{if(!A||!C||!E)return void alert("Please select Class, Section and Subject");P(!0);try{let a=(0,d.query)((0,d.collection)(e.db,"students"),(0,d.where)("classId","==",A),(0,d.where)("sectionId","==",C),(0,d.where)("status","==","ACTIVE")),b=(await (0,d.getDocs)(a)).docs.map(a=>({id:a.id,...a.data()}));b.sort((a,b)=>{let c=parseInt(a.rollNo)||9999,d=parseInt(b.rollNo)||9999;return c-d||a.studentName.localeCompare(b.studentName)}),H(b);let c={},f={},g=b.map(async a=>{let b=`${o}_${a.id}`,g=await (0,d.getDoc)((0,d.doc)(e.db,"exam_results",b));if(g.exists()){let b=g.data(),d=b.subjects?.[E];d&&(c[a.id]=d.obtained,f[a.id]=d.remarks||"")}});await Promise.all(g),J(c),N(f)}catch(a){console.error(a),alert("Error loading students")}finally{P(!1)}},V=async()=>{if(E){R(!0);try{let a=(0,d.writeBatch)(e.db);for(let b of G){let c=`${o}_${b.id}`,f=(0,d.doc)(e.db,"exam_results",c),g=I[b.id],h=M[b.id]||"";if(""===g||void 0===g)continue;let i={[`subjects.${E}`]:{obtained:g,maxMarks:K,remarks:h},examId:o,studentId:b.id,studentName:b.studentName,classId:A,className:q[A]?.name,sectionId:C,sectionName:r[C]?.name,rollNo:b.rollNo||""};a.set(f,i,{merge:!0})}await a.commit(),alert("Marks saved successfully!")}catch(a){console.error(a),alert("Error saving: "+a.message)}finally{R(!1)}}};return y||v?(0,b.jsx)("div",{className:"flex justify-center p-20",children:(0,b.jsx)(k.Loader2,{className:"animate-spin"})}):w?(0,b.jsxs)("div",{className:"max-w-7xl mx-auto p-6 space-y-6 animate-in fade-in",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",onClick:()=>p.push("/teacher/exams"),children:(0,b.jsx)(l.ArrowLeft,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold font-display",children:w.name}),(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:"Marks Entry Preview"})]})]}),(0,b.jsxs)(h.Card,{className:"bg-black/20 border-white/10",children:[(0,b.jsx)(h.CardHeader,{className:"pb-4",children:(0,b.jsx)(h.CardTitle,{className:"text-lg",children:"Select Class & Subject"})}),(0,b.jsx)(h.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,b.jsxs)("div",{className:"space-y-2 w-[200px]",children:[(0,b.jsx)("label",{className:"text-xs font-bold text-muted-foreground uppercase",children:"Class"}),(0,b.jsxs)(j.Select,{value:A,onValueChange:a=>{B(a),D(""),F("")},children:[(0,b.jsx)(j.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,b.jsx)(j.SelectValue,{placeholder:"Class"})}),(0,b.jsx)(j.SelectContent,{children:Object.values(q).map(a=>(0,b.jsx)(j.SelectItem,{value:a.id,children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2 w-[200px]",children:[(0,b.jsx)("label",{className:"text-xs font-bold text-muted-foreground uppercase",children:"Section"}),(0,b.jsxs)(j.Select,{value:C,onValueChange:D,disabled:!A,children:[(0,b.jsx)(j.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,b.jsx)(j.SelectValue,{placeholder:"Section"})}),(0,b.jsx)(j.SelectContent,{children:S.map(a=>(0,b.jsx)(j.SelectItem,{value:a.id,children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2 w-[200px]",children:[(0,b.jsx)("label",{className:"text-xs font-bold text-muted-foreground uppercase",children:"Subject"}),(0,b.jsxs)(j.Select,{value:E,onValueChange:F,disabled:!A,children:[(0,b.jsx)(j.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,b.jsx)(j.SelectValue,{placeholder:"Subject"})}),(0,b.jsx)(j.SelectContent,{children:T.map(a=>(0,b.jsx)(j.SelectItem,{value:a.id,children:a.name},a.id))})]})]}),(0,b.jsx)(g.Button,{onClick:U,disabled:O||!A||!C||!E,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:O?(0,b.jsx)(k.Loader2,{className:"animate-spin"}):"Load Data"})]})})]}),G.length>0&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center bg-white/5 p-4 rounded-lg border border-white/10",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("span",{className:"font-bold text-lg",children:[G.length," Students Found"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Max Marks:"}),(0,b.jsx)(i.Input,{className:"w-20 h-8 bg-black border-white/20 text-center",value:K,onChange:a=>L(a.target.value)})]})]}),(0,b.jsxs)(g.Button,{onClick:V,disabled:Q,className:"bg-blue-600 hover:bg-blue-700 text-white gap-2",children:[Q?(0,b.jsx)(k.Loader2,{className:"animate-spin w-4 h-4"}):(0,b.jsx)(m.Save,{className:"w-4 h-4"}),"Save All Marks"]})]}),(0,b.jsx)("div",{className:"rounded-lg border border-white/10 overflow-hidden bg-black/20",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-white/5 font-bold text-muted-foreground",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"p-4 text-left w-20",children:"Roll No"}),(0,b.jsx)("th",{className:"p-4 text-left",children:"Student Name"}),(0,b.jsx)("th",{className:"p-4 text-center w-32",children:"Obtained Marks"}),(0,b.jsx)("th",{className:"p-4 text-left",children:"Remarks"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-white/5",children:G.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-white/[0.02] transition-colors",children:[(0,b.jsx)("td",{className:"p-4 font-mono text-xs",children:a.rollNo||"-"}),(0,b.jsx)("td",{className:"p-4 font-bold",children:a.studentName}),(0,b.jsx)("td",{className:"p-4 text-center",children:(0,b.jsx)(i.Input,{className:"w-24 text-center bg-black/40 border-white/10 focus:border-emerald-500 mx-auto",value:I[a.id]||"",onChange:b=>J({...I,[a.id]:b.target.value}),placeholder:"0"})}),(0,b.jsx)("td",{className:"p-4",children:(0,b.jsx)(i.Input,{className:"w-full bg-transparent border-transparent hover:border-white/10 focus:border-white/20",value:M[a.id]||"",onChange:b=>N({...M,[a.id]:b.target.value}),placeholder:"Add remark..."})})]},a.id))})]})}),(0,b.jsx)("div",{className:"flex justify-end pt-4",children:(0,b.jsxs)(g.Button,{onClick:V,disabled:Q,className:"bg-blue-600 hover:bg-blue-700 text-white gap-2 w-40",children:[Q?(0,b.jsx)(k.Loader2,{className:"animate-spin w-4 h-4"}):(0,b.jsx)(m.Save,{className:"w-4 h-4"}),"Save All"]})})]})]}):null}a.s(["default",()=>o])}];

//# sourceMappingURL=_74a6587c._.js.map