module.exports=[66718,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,type:c,...e},f)=>(0,b.jsx)("input",{type:c,className:(0,d.cn)("flex h-12 w-full rounded-full border border-white/10 bg-[#282828] px-4 py-3 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all shadow-inner hover:bg-[#333]",a),ref:f,...e}));e.displayName="Input",a.s(["Input",()=>e])},24348,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(187),e=a.i(68114);let f=(0,d.cva)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),g=c.forwardRef(({className:a,variant:c,...d},g)=>(0,b.jsx)("div",{ref:g,role:"alert",className:(0,e.cn)(f({variant:c}),a),...d}));g.displayName="Alert";let h=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("h5",{ref:d,className:(0,e.cn)("mb-1 font-medium leading-none tracking-tight",a),...c}));h.displayName="AlertTitle";let i=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,className:(0,e.cn)("text-sm [&_p]:leading-relaxed",a),...c}));i.displayName="AlertDescription",a.s(["Alert",()=>g,"AlertDescription",()=>i,"AlertTitle",()=>h])},3834,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(99570),e=a.i(66718),f=a.i(24348),g=a.i(96221),h=a.i(81560),i=a.i(53259),j=a.i(73570),k=a.i(20005),l=a.i(16201),m=a.i(56025),n=a.i(50944);a.i(69387);var o=a.i(60574);a.i(72029);var p=a.i(50455),q=a.i(20237);function r(){let{user:a,signOut:r}=(0,m.useAuth)(),s=(0,n.useRouter)(),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)("IDLE"),[z,A]=(0,c.useState)(""),B=async()=>{if("DELETE ALL DATA"===t.trim()){w(!0);try{if(!a){alert("Login required"),w(!1);return}A("Starting Client-Side Purge..."),await Promise.all(["master","siteContent","analytics","notifications","chats","presence","config","settings","demo_state"].map(a=>(0,p.remove)((0,p.ref)(q.rtdb,a))));let b=0;for(let a of["students","teachers","staff","usersBySchoolId","designations","student_fee_ledgers","payments","invoices","transactions","fee_structures","fee_types","attendance","leaves","class_timetables","teacher_schedules","substitutions","homework","homework_submissions","exam_results","grades","subjects","announcements","events","notifications","audit_logs","notices","reports","feedback","enquiries","applications","config","villages","classes","sections","leave_requests","payroll","salary_adjustments","salary_payments","expenses","custom_fees","master_classes","search_index","site_config","vouchers"]){let c=await (0,o.getDocs)((0,o.collection)(q.db,a));if(c.empty)continue;let d=(0,o.writeBatch)(q.db);c.docs.forEach(a=>{d.delete(a.ref),b++}),await d.commit()}let c=await (0,o.getDocs)((0,o.collection)(q.db,"users")),d=(0,o.writeBatch)(q.db),e=0;c.docs.forEach(b=>{let c=b.data(),f=c.email?.toLowerCase();b.id!==a.uid&&"spoorthy@school.local"!==f&&(d.delete(b.ref),e++)}),e>0&&await d.commit(),A(`Purge Complete! Deleted ${b} records and ${e} users via Client Connection.`),y("DONE")}catch(a){console.error("Client Purge Error:",a),alert("Error: "+a.message)}finally{w(!1)}}};return console.log("Rendering StoragePurgePage (Client Mode)"),(0,b.jsxs)("div",{className:"max-w-4xl space-y-8 animate-in fade-in duration-500 pb-20",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"font-display text-3xl font-bold",children:"Storage & Purge"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage system storage and perform data retention tasks."})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(0,b.jsxs)("div",{className:"bg-white/5 border border-white/10 p-6 rounded-xl",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"p-2 bg-blue-500/10 text-blue-500 rounded-lg",children:(0,b.jsx)(i.Database,{className:"w-5 h-5"})}),(0,b.jsx)("h3",{className:"font-medium",children:"Total Storage"})]}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:"-- / 5 GB"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Files, Backups, & Media"})]})}),(0,b.jsxs)("div",{className:"border border-red-500/30 bg-red-500/5 rounded-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"bg-red-500/10 p-4 border-b border-red-500/20 flex items-center gap-2",children:[(0,b.jsx)(j.AlertTriangle,{className:"text-red-500 w-5 h-5"}),(0,b.jsx)("h2",{className:"font-bold text-red-500",children:"Danger Zone: Factory Reset"})]}),(0,b.jsx)("div",{className:"p-6 space-y-6",children:"IDLE"===x?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(f.Alert,{variant:"destructive",className:"bg-red-500/10 border-red-500/20 text-red-200",children:[(0,b.jsx)(f.AlertTitle,{children:"This action is irreversible"}),(0,b.jsxs)(f.AlertDescription,{children:["Performing a Factory Reset will permanently delete ",(0,b.jsx)("strong",{children:"ALL"})," data including students, teachers, payments, and settings.",(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),(0,b.jsx)("strong",{children:"Only Admin Accounts will be preserved."})," Use this only for a fresh start."]})]}),(0,b.jsxs)("div",{className:"space-y-4 max-w-md",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-sm font-medium text-red-400",children:["Type ",(0,b.jsx)("span",{className:"font-mono font-bold select-all",children:"DELETE ALL DATA"})," to confirm"]}),(0,b.jsx)(e.Input,{value:t,onChange:a=>u(a.target.value),className:"bg-black/40 border-red-500/30 text-red-500 font-mono placeholder:text-red-500/30",placeholder:"DELETE ALL DATA"})]}),(0,b.jsxs)(d.Button,{variant:"destructive",className:"w-full gap-2",disabled:"DELETE ALL DATA"!==t.trim()||v,onClick:B,children:[v?(0,b.jsx)(g.Loader2,{className:"w-4 h-4 animate-spin"}):(0,b.jsx)(h.Trash2,{className:"w-4 h-4"}),v?"Purging via Client Connection...":"NUCLEAR RESET (CLIENT MODE)"]})]})]}):(0,b.jsxs)("div",{className:"text-center py-10 space-y-4 bg-green-500/10 rounded-lg border border-green-500/20",children:[(0,b.jsx)(l.CheckCircle,{className:"w-16 h-16 text-green-500 mx-auto"}),(0,b.jsx)("h3",{className:"text-2xl font-bold text-green-500",children:"System Reset Complete"}),(0,b.jsx)("p",{className:"text-green-400/80 font-mono text-sm max-w-lg mx-auto",children:z}),(0,b.jsxs)(d.Button,{onClick:async()=>{await r(),s.push("/login")},variant:"outline",className:"border-green-500/30 text-green-400 hover:bg-green-500/20",children:[(0,b.jsx)(k.LogOut,{className:"w-4 h-4 mr-2"}),"Logout & Refresh"]})]})})]})]})}a.s(["default",()=>r])}];

//# sourceMappingURL=src_7d9c2ab5._.js.map