{"version":3,"sources":["../../../../src/app/admin/exams/%5Bid%5D/page.tsx","../../../../src/components/admin/report-card-generator.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState, use } from \"react\";\r\nimport { doc, getDoc, setDoc, collection, getDocs, query, where } from \"firebase/firestore\";\r\nimport { db } from \"@/lib/firebase\";\r\nimport { useAuth } from \"@/context/AuthContext\";\r\nimport { useMasterData } from \"@/context/MasterDataContext\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Loader2, Save, Printer, ArrowLeft, Calendar, Clock, FileText } from \"lucide-react\";\r\nimport { ReportCardGenerator } from \"@/components/admin/report-card-generator\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nexport default function ExamDetailsPage({ params }: { params: Promise<{ id: string }> }) {\r\n    const { id: examId } = use(params);\r\n    const router = useRouter();\r\n    const { classes: classesData, subjects: subjectsData } = useMasterData();\r\n    const [exam, setExam] = useState<any>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [saving, setSaving] = useState(false);\r\n\r\n    const [selectedClassId, setSelectedClassId] = useState(\"\");\r\n    const [timetable, setTimetable] = useState<any>({}); // Current class timetable\r\n\r\n    // Convert master data\r\n    const classes = Object.values(classesData).map((c: any) => ({ id: c.id, name: c.name, order: c.order || 99 })).sort((a: any, b: any) => a.order - b.order);\r\n    const allSubjects = Object.values(subjectsData)\r\n        .filter((s: any) => s.isActive !== false)\r\n        .sort((a: any, b: any) => a.name.localeCompare(b.name));\r\n\r\n    const fetchExam = async () => {\r\n        try {\r\n            const docSnap = await getDoc(doc(db, \"exams\", examId));\r\n            if (docSnap.exists()) {\r\n                setExam({ id: docSnap.id, ...docSnap.data() });\r\n            } else {\r\n                router.push(\"/admin/exams\");\r\n            }\r\n        } catch (e) {\r\n            console.error(e);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchExam();\r\n    }, [examId]);\r\n\r\n    useEffect(() => {\r\n        if (selectedClassId && exam) {\r\n            // Load existing timetable for this class or init empty\r\n            const existing = exam.timetables?.[selectedClassId] || {};\r\n\r\n            // Initialize with all subjects if empty? No, let user add.\r\n            // Or auto-populate all subjects?\r\n            // Let's prepopulate structure\r\n            const initial: any = {};\r\n            allSubjects.forEach(s => {\r\n                if (existing[s.id]) {\r\n                    initial[s.id] = { ...existing[s.id], enabled: true };\r\n                } else {\r\n                    initial[s.id] = { date: \"\", startTime: \"09:00\", endTime: \"12:00\", enabled: false };\r\n                }\r\n            });\r\n            setTimetable(initial);\r\n        }\r\n    }, [selectedClassId, exam]); // Re-run if exam updates (after save)\r\n\r\n    const handleSaveTimetable = async () => {\r\n        if (!selectedClassId || !exam) {\r\n            console.error(\"Missing selectedClassId or exam data\", { selectedClassId, exam });\r\n            return;\r\n        }\r\n        setSaving(true);\r\n        console.log(\"Saving timetable for class:\", selectedClassId);\r\n\r\n        try {\r\n            // Filter only enabled subjects\r\n            const cleanTimetable: any = {};\r\n            Object.entries(timetable).forEach(([subId, data]: any) => {\r\n                if (data.enabled && data.date) {\r\n                    cleanTimetable[subId] = {\r\n                        date: data.date,\r\n                        startTime: data.startTime || \"09:00\",\r\n                        endTime: data.endTime || \"12:00\"\r\n                    };\r\n                }\r\n            });\r\n\r\n            console.log(\"Cleaned timetable data:\", cleanTimetable);\r\n\r\n            const { id, ...examDataWithoutId } = exam;\r\n            const updatedTimetables = {\r\n                ...(examDataWithoutId.timetables || {}),\r\n                [selectedClassId]: cleanTimetable\r\n            };\r\n\r\n            await setDoc(doc(db, \"exams\", examId), {\r\n                ...examDataWithoutId,\r\n                timetables: updatedTimetables\r\n            });\r\n\r\n            // Update local state by recreating the exam object with its ID\r\n            setExam({\r\n                id: examId,\r\n                ...examDataWithoutId,\r\n                timetables: updatedTimetables\r\n            });\r\n\r\n            alert(`Timetable for ${classesData[selectedClassId]?.name || \"Class\"} Saved Successfully!`);\r\n        } catch (e: any) {\r\n            console.error(\"Save Timetable Error:\", e);\r\n            alert(\"Failed to save: \" + e.message);\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    const updateSubject = (subId: string, field: string, value: any) => {\r\n        setTimetable((prev: any) => ({\r\n            ...prev,\r\n            [subId]: { ...prev[subId], [field]: value }\r\n        }));\r\n    };\r\n\r\n    const [editOpen, setEditOpen] = useState(false);\r\n    const [editForm, setEditForm] = useState({\r\n        name: \"\",\r\n        startDate: \"\",\r\n        endDate: \"\",\r\n        examCenter: \"SCS-HYD\",\r\n        academicYear: \"2025-26\",\r\n        instructions: \"Carry this Hall Ticket to the exam hall.\\nReport 15 mins before time.\\nNo electronic gadgets allowed.\"\r\n    });\r\n\r\n    // Initialize edit form when exam loads\r\n    useEffect(() => {\r\n        if (exam) {\r\n            setEditForm({\r\n                name: exam.name,\r\n                startDate: exam.startDate,\r\n                endDate: exam.endDate,\r\n                examCenter: exam.examCenter || \"SCS-HYD\",\r\n                academicYear: exam.academicYear || \"2025-26\",\r\n                instructions: exam.instructions || \"Carry this Hall Ticket to the exam hall.\\nReport 15 mins before time.\\nNo electronic gadgets allowed.\"\r\n            });\r\n        }\r\n    }, [exam]);\r\n\r\n    const handleUpdateExam = async () => {\r\n        if (!editForm.name || !editForm.startDate || !editForm.endDate) return;\r\n        setSaving(true);\r\n        try {\r\n            await setDoc(doc(db, \"exams\", examId), {\r\n                ...exam,\r\n                ...editForm\r\n            }, { merge: true });\r\n\r\n            setExam({ ...exam, ...editForm });\r\n            setEditOpen(false);\r\n            alert(\"Exam Details Updated\");\r\n        } catch (e: any) {\r\n            console.error(e);\r\n            alert(\"Error: \" + e.message);\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    if (loading) return <div className=\"flex justify-center p-20\"><Loader2 className=\"animate-spin\" /></div>;\r\n    if (!exam) return null;\r\n\r\n    return (\r\n        <div className=\"space-y-6 max-w-7xl mx-auto p-6 animate-in fade-in\">\r\n            <div className=\"flex items-center gap-4 mb-6\">\r\n                <Button variant=\"ghost\" size=\"icon\" onClick={() => router.push(\"/admin/exams\")}>\r\n                    <ArrowLeft className=\"w-5 h-5\" />\r\n                </Button>\r\n                <div className=\"flex-1\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <h1 className=\"text-3xl font-display font-bold\">{exam.name}</h1>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className={`px-2 py-0.5 rounded text-xs font-bold border ${exam.status === 'RESULTS_RELEASED'\r\n                                ? 'bg-emerald-500/10 border-emerald-500/20 text-emerald-400'\r\n                                : 'bg-blue-500/10 border-blue-500/20 text-blue-400'\r\n                                }`}>\r\n                                {exam.status === 'RESULTS_RELEASED' ? 'RESULTS PUBLISHED' : exam.status || 'ACTIVE'}\r\n                            </span>\r\n                            <Button size=\"sm\" variant=\"outline\" className=\"h-6 text-xs bg-white/5 border-white/10\" onClick={() => setEditOpen(true)}>\r\n                                Edit\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                    <p className=\"text-muted-foreground flex items-center gap-2\">\r\n                        <Calendar className=\"w-4 h-4\" />\r\n                        {new Date(exam.startDate).toLocaleDateString()} - {new Date(exam.endDate).toLocaleDateString()}\r\n                    </p>\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                    <Button\r\n                        onClick={async () => {\r\n                            if (!confirm(exam.status === 'RESULTS_RELEASED' ? \"Hide results from students?\" : \"Release results to students?\")) return;\r\n                            const newStatus = exam.status === 'RESULTS_RELEASED' ? 'ACTIVE' : 'RESULTS_RELEASED';\r\n                            await setDoc(doc(db, \"exams\", examId), { status: newStatus }, { merge: true });\r\n                            setExam({ ...exam, status: newStatus });\r\n                        }}\r\n                        className={exam.status === 'RESULTS_RELEASED' ? \"bg-yellow-600 hover:bg-yellow-700\" : \"bg-emerald-600 hover:bg-emerald-700\"}\r\n                    >\r\n                        {exam.status === 'RESULTS_RELEASED' ? \"Unpublish Results\" : \"Release Results\"}\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Edit Dialog */}\r\n            <Dialog open={editOpen} onOpenChange={setEditOpen}>\r\n                <DialogContent className=\"bg-black/95 border-white/10 text-white\">\r\n                    <DialogHeader>\r\n                        <DialogTitle>Edit Exam Details</DialogTitle>\r\n                    </DialogHeader>\r\n                    <div className=\"space-y-4 py-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label>Exam Name</Label>\r\n                            <Input\r\n                                className=\"bg-white/5 border-white/10\"\r\n                                value={editForm.name}\r\n                                onChange={e => setEditForm({ ...editForm, name: e.target.value })}\r\n                            />\r\n                        </div>\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <Label>Academic Year</Label>\r\n                                <Input className=\"bg-white/5 border-white/10\" value={editForm.academicYear} onChange={e => setEditForm({ ...editForm, academicYear: e.target.value })} placeholder=\"e.g. 2025-26\" />\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <Label>Exam Center</Label>\r\n                                <Input className=\"bg-white/5 border-white/10\" value={editForm.examCenter} onChange={e => setEditForm({ ...editForm, examCenter: e.target.value })} />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <Label>Hall Ticket Instructions (one per line)</Label>\r\n                            <textarea\r\n                                className=\"w-full min-h-[100px] rounded-md bg-white/5 border border-white/10 p-3 text-sm focus:outline-none focus:ring-2 focus:ring-accent\"\r\n                                value={editForm.instructions}\r\n                                onChange={e => setEditForm({ ...editForm, instructions: e.target.value })}\r\n                            />\r\n                        </div>\r\n                        <Button onClick={handleUpdateExam} disabled={saving} className=\"w-full bg-emerald-600 hover:bg-emerald-700 text-white mt-4\">\r\n                            {saving ? <Loader2 className=\"animate-spin\" /> : \"Save Changes\"}\r\n                        </Button>\r\n                    </div>\r\n                </DialogContent>\r\n            </Dialog>\r\n\r\n            <Tabs defaultValue=\"timetable\" className=\"space-y-6\">\r\n                <TabsList className=\"bg-black/20 border-white/10\">\r\n                    <TabsTrigger value=\"timetable\"><Clock className=\"w-4 h-4 mr-2\" /> Exam Timetable</TabsTrigger>\r\n                    <TabsTrigger value=\"documents\"><FileText className=\"w-4 h-4 mr-2\" /> Documents (Tickets/Reports)</TabsTrigger>\r\n                </TabsList>\r\n\r\n                {/* TIMETABLE TAB */}\r\n                <TabsContent value=\"timetable\" className=\"space-y-6\">\r\n                    <Card className=\"bg-black/20 border-white/10\">\r\n                        <CardHeader>\r\n                            <CardTitle>Configure Timetable</CardTitle>\r\n                            <CardDescription>Select a class to set exam dates and times for each subject.</CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-6\">\r\n                            <div className=\"flex items-center gap-4\">\r\n                                <Label>Select Class:</Label>\r\n                                <Select value={selectedClassId} onValueChange={setSelectedClassId}>\r\n                                    <SelectTrigger className=\"w-[200px] bg-white/5 border-white/10\"><SelectValue placeholder=\"Choose Class\" /></SelectTrigger>\r\n                                    <SelectContent>\r\n                                        {classes.map(c => <SelectItem key={c.id} value={c.id}>{c.name}</SelectItem>)}\r\n                                    </SelectContent>\r\n                                </Select>\r\n                                {selectedClassId && (\r\n                                    <Button onClick={handleSaveTimetable} disabled={saving} className=\"bg-emerald-600 hover:bg-emerald-700 text-white ml-auto\">\r\n                                        {saving ? <Loader2 className=\"animate-spin\" /> : <Save className=\"w-4 h-4 mr-2\" />}\r\n                                        Save Timetable\r\n                                    </Button>\r\n                                )}\r\n                            </div>\r\n\r\n                            {selectedClassId && (\r\n                                <div className=\"space-y-4\">\r\n                                    {/* Mobile Card View */}\r\n                                    <div className=\"md:hidden space-y-3\">\r\n                                        {allSubjects.map(subject => {\r\n                                            const data = timetable[subject.id] || { enabled: false };\r\n                                            return (\r\n                                                <div\r\n                                                    key={subject.id}\r\n                                                    className={cn(\r\n                                                        \"bg-black/20 border border-white/10 rounded-2xl p-4 space-y-4 backdrop-blur-md transition-all\",\r\n                                                        data.enabled ? \"ring-1 ring-emerald-500/30\" : \"opacity-60\"\r\n                                                    )}\r\n                                                >\r\n                                                    <div className=\"flex items-center justify-between\">\r\n                                                        <div className=\"flex items-center gap-3\">\r\n                                                            <div className=\"flex items-center\">\r\n                                                                <input\r\n                                                                    type=\"checkbox\"\r\n                                                                    checked={!!data.enabled}\r\n                                                                    onChange={e => updateSubject(subject.id, 'enabled', e.target.checked)}\r\n                                                                    className=\"w-5 h-5 rounded border-white/20 bg-black/40 accent-emerald-500\"\r\n                                                                />\r\n                                                            </div>\r\n                                                            <span className=\"font-bold text-sm text-white\">{subject.name}</span>\r\n                                                        </div>\r\n                                                        <Badge variant={data.enabled ? \"default\" : \"outline\"} className={cn(\r\n                                                            \"text-[8px] font-black uppercase tracking-tighter py-0 h-4\",\r\n                                                            data.enabled ? \"bg-emerald-500/10 text-emerald-400 border-none\" : \"text-white/20\"\r\n                                                        )}>\r\n                                                            {data.enabled ? \"Included\" : \"Excluded\"}\r\n                                                        </Badge>\r\n                                                    </div>\r\n\r\n                                                    {data.enabled && (\r\n                                                        <div className=\"grid grid-cols-1 gap-3 pt-3 border-t border-white/5 animate-in slide-in-from-top-2 duration-300\">\r\n                                                            <div className=\"space-y-1.5 font-mono\">\r\n                                                                <label className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest italic flex items-center gap-1.5\">\r\n                                                                    <Calendar className=\"w-3 h-3\" /> Exam Date\r\n                                                                </label>\r\n                                                                <Input\r\n                                                                    type=\"date\"\r\n                                                                    value={data.date || \"\"}\r\n                                                                    onChange={e => updateSubject(subject.id, 'date', e.target.value)}\r\n                                                                    className=\"h-10 bg-white/5 border-white/10 w-full text-xs\"\r\n                                                                    min={exam.startDate}\r\n                                                                    max={exam.endDate}\r\n                                                                />\r\n                                                            </div>\r\n                                                            <div className=\"grid grid-cols-2 gap-3\">\r\n                                                                <div className=\"space-y-1.5 font-mono\">\r\n                                                                    <label className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest italic flex items-center gap-1.5\">\r\n                                                                        <Clock className=\"w-3 h-3\" /> Start\r\n                                                                    </label>\r\n                                                                    <Input\r\n                                                                        type=\"time\"\r\n                                                                        value={data.startTime || \"\"}\r\n                                                                        onChange={e => updateSubject(subject.id, 'startTime', e.target.value)}\r\n                                                                        className=\"h-10 bg-white/5 border-white/10 w-full text-xs\"\r\n                                                                    />\r\n                                                                </div>\r\n                                                                <div className=\"space-y-1.5 font-mono\">\r\n                                                                    <label className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest italic flex items-center gap-1.5\">\r\n                                                                        <Clock className=\"w-3 h-3\" /> End\r\n                                                                    </label>\r\n                                                                    <Input\r\n                                                                        type=\"time\"\r\n                                                                        value={data.endTime || \"\"}\r\n                                                                        onChange={e => updateSubject(subject.id, 'endTime', e.target.value)}\r\n                                                                        className=\"h-10 bg-white/5 border-white/10 w-full text-xs\"\r\n                                                                    />\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                            );\r\n                                        })}\r\n                                    </div>\r\n\r\n                                    {/* Desktop Table View */}\r\n                                    <div className=\"hidden md:block border border-white/10 rounded-lg overflow-x-auto\">\r\n                                        <table className=\"w-full text-sm min-w-[700px]\">\r\n                                            <thead className=\"bg-white/5\">\r\n                                                <tr>\r\n                                                    <th className=\"p-3 text-left w-10\">Include</th>\r\n                                                    <th className=\"p-3 text-left\">Subject</th>\r\n                                                    <th className=\"p-3 text-left\">Date</th>\r\n                                                    <th className=\"p-3 text-left\">Start Time</th>\r\n                                                    <th className=\"p-3 text-left\">End Time</th>\r\n                                                </tr>\r\n                                            </thead>\r\n                                            <tbody className=\"divide-y divide-white/5\">\r\n                                                {allSubjects.map(subject => {\r\n                                                    const data = timetable[subject.id] || { enabled: false };\r\n                                                    return (\r\n                                                        <tr key={subject.id} className={data.enabled ? \"bg-white/[0.02]\" : \"opacity-50\"}>\r\n                                                            <td className=\"p-3\">\r\n                                                                <input\r\n                                                                    type=\"checkbox\"\r\n                                                                    checked={!!data.enabled}\r\n                                                                    onChange={e => updateSubject(subject.id, 'enabled', e.target.checked)}\r\n                                                                    className=\"w-4 h-4 rounded border-white/20 bg-black/40\"\r\n                                                                />\r\n                                                            </td>\r\n                                                            <td className=\"p-3 font-medium\">{subject.name}</td>\r\n                                                            <td className=\"p-3\">\r\n                                                                <Input\r\n                                                                    type=\"date\"\r\n                                                                    value={data.date || \"\"}\r\n                                                                    onChange={e => updateSubject(subject.id, 'date', e.target.value)}\r\n                                                                    className=\"h-8 bg-black/20 border-white/10 w-40\"\r\n                                                                    disabled={!data.enabled}\r\n                                                                    min={exam.startDate}\r\n                                                                    max={exam.endDate}\r\n                                                                />\r\n                                                            </td>\r\n                                                            <td className=\"p-3\">\r\n                                                                <Input\r\n                                                                    type=\"time\"\r\n                                                                    value={data.startTime || \"\"}\r\n                                                                    onChange={e => updateSubject(subject.id, 'startTime', e.target.value)}\r\n                                                                    className=\"h-8 bg-black/20 border-white/10 w-32\"\r\n                                                                    disabled={!data.enabled}\r\n                                                                />\r\n                                                            </td>\r\n                                                            <td className=\"p-3\">\r\n                                                                <Input\r\n                                                                    type=\"time\"\r\n                                                                    value={data.endTime || \"\"}\r\n                                                                    onChange={e => updateSubject(subject.id, 'endTime', e.target.value)}\r\n                                                                    className=\"h-8 bg-black/20 border-white/10 w-32\"\r\n                                                                    disabled={!data.enabled}\r\n                                                                />\r\n                                                            </td>\r\n                                                        </tr>\r\n                                                    );\r\n                                                })}\r\n                                            </tbody>\r\n                                        </table>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n                </TabsContent>\r\n\r\n                {/* DOCUMENTS TAB */}\r\n                <TabsContent value=\"documents\">\r\n                    <Card className=\"bg-black/20 border-white/10\">\r\n                        <CardHeader>\r\n                            <CardTitle>Generate Documents</CardTitle>\r\n                            <CardDescription>Select a class to generate hall tickets or final report cards.</CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-6\">\r\n                            <div className=\"flex flex-col md:flex-row md:items-center gap-4\">\r\n                                <div className=\"flex items-center gap-4 flex-1\">\r\n                                    <Label className=\"shrink-0\">Select Class:</Label>\r\n                                    <Select value={selectedClassId} onValueChange={setSelectedClassId}>\r\n                                        <SelectTrigger className=\"w-full md:w-[200px] bg-white/5 border-white/10\"><SelectValue placeholder=\"Choose Class\" /></SelectTrigger>\r\n                                        <SelectContent>\r\n                                            {classes.map(c => <SelectItem key={c.id} value={c.id}>{c.name}</SelectItem>)}\r\n                                        </SelectContent>\r\n                                    </Select>\r\n                                </div>\r\n\r\n                                {selectedClassId && (\r\n                                    <div className=\"flex flex-col sm:flex-row items-center gap-3 w-full md:w-auto\">\r\n                                        <div className=\"w-full sm:w-auto\">\r\n                                            <ReportCardGenerator exam={exam} classId={selectedClassId} />\r\n                                        </div>\r\n                                        <Button\r\n                                            onClick={() => {\r\n                                                window.open(`/admin/exams/${examId}/print/${selectedClassId}`, '_blank');\r\n                                            }}\r\n                                            className=\"w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white gap-2 h-11\"\r\n                                        >\r\n                                            <Printer className=\"w-4 h-4\" /> Print Hall Tickets\r\n                                        </Button>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            <div className=\"bg-emerald-500/10 border border-emerald-500/20 rounded-lg p-4 text-emerald-300 text-sm\">\r\n                                <h4 className=\"font-bold flex items-center mb-2\"><FileText className=\"w-4 h-4 mr-2\" /> Printing Instructions</h4>\r\n                                <ul className=\"list-disc list-inside space-y-1\">\r\n                                    <li>Ensure the timetable is configured for the selected class before printing.</li>\r\n                                    <li>Hall tickets will be generated for all <b>ACTIVE</b> students in the class.</li>\r\n                                    <li>The print view will open in a new tab. Use browser print (Ctrl+P) setting \"Background Graphics\" ON.</li>\r\n                                </ul>\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n                </TabsContent>\r\n            </Tabs>\r\n        </div>\r\n    );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { FileText, Loader2, Printer, CheckCircle, AlertCircle } from \"lucide-react\";\r\nimport { doc, getDoc, collection, query, where, getDocs } from \"firebase/firestore\";\r\nimport { db } from \"@/lib/firebase\";\r\nimport { useMasterData } from \"@/context/MasterDataContext\";\r\n\r\ninterface ReportCardGeneratorProps {\r\n    exam: any;\r\n    classId: string;\r\n}\r\n\r\nexport function ReportCardGenerator({ exam, classId }: ReportCardGeneratorProps) {\r\n    const [open, setOpen] = useState(false);\r\n    const [loading, setLoading] = useState(false);\r\n    const [branding, setBranding] = useState<any>(null);\r\n    const { subjects, classes } = useMasterData();\r\n    const [students, setStudents] = useState<any[]>([]);\r\n    const [results, setResults] = useState<Record<string, any>>({});\r\n\r\n    useEffect(() => {\r\n        if (open) {\r\n            fetchBranding();\r\n            fetchData();\r\n        }\r\n    }, [open, classId, exam.id]);\r\n\r\n    const fetchBranding = async () => {\r\n        const d = await getDoc(doc(db, \"settings\", \"branding\"));\r\n        if (d.exists()) setBranding(d.data());\r\n    };\r\n\r\n    const fetchData = async () => {\r\n        if (!classId) return;\r\n        setLoading(true);\r\n        try {\r\n            // 1. Fetch all active students in class\r\n            const sQ = query(\r\n                collection(db, \"students\"),\r\n                where(\"classId\", \"==\", classId),\r\n                where(\"status\", \"==\", \"ACTIVE\")\r\n            );\r\n            const sSnap = await getDocs(sQ);\r\n            const studentList = sSnap.docs.map(d => ({ id: d.id, ...d.data() }));\r\n\r\n            // Sort by Roll No\r\n            studentList.sort((a: any, b: any) => {\r\n                const rA = parseInt(a.rollNo) || 999;\r\n                const rB = parseInt(b.rollNo) || 999;\r\n                return rA - rB || a.studentName.localeCompare(b.studentName);\r\n            });\r\n            setStudents(studentList);\r\n\r\n            // 2. Fetch all results for this exam + class\r\n            const rQ = query(\r\n                collection(db, \"exam_results\"),\r\n                where(\"examId\", \"==\", exam.id),\r\n                where(\"classId\", \"==\", classId)\r\n            );\r\n            const rSnap = await getDocs(rQ);\r\n            const resultsMap: Record<string, any> = {};\r\n            rSnap.docs.forEach(d => {\r\n                resultsMap[d.data().studentId] = d.data();\r\n            });\r\n            setResults(resultsMap);\r\n\r\n        } catch (e) {\r\n            console.error(e);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handlePrint = () => {\r\n        const printWindow = window.open('', '_blank');\r\n        if (!printWindow) return;\r\n\r\n        const html = `\r\n            <html>\r\n            <head>\r\n                <title>Report Cards - Academic Transcript</title>\r\n                <style>\r\n                    @page { size: A4; margin: 0; }\r\n                    body { \r\n                        font-family: 'Inter', 'Segoe UI', Roboto, sans-serif; \r\n                        margin: 0; \r\n                        padding: 0; \r\n                        background: #f8fafc; \r\n                        color: #1e293b;\r\n                    }\r\n                    .report-card { \r\n                        width: 210mm;\r\n                        max-height: 297mm;\r\n                        padding: 12mm;\r\n                        box-sizing: border-box;\r\n                        page-break-after: always;\r\n                        position: relative;\r\n                        background: #fff;\r\n                        display: flex;\r\n                        flex-direction: column;\r\n                        overflow: hidden;\r\n                    }\r\n                    \r\n                    /* Institutional Border */\r\n                    .document-border {\r\n                        position: absolute;\r\n                        top: 5mm;\r\n                        left: 5mm;\r\n                        right: 5mm;\r\n                        bottom: 5mm;\r\n                        border: 2.5pt double #1e40af;\r\n                        pointer-events: none;\r\n                        z-index: 10;\r\n                    }\r\n\r\n                    /* Header Section */\r\n                    .header { \r\n                        border-bottom: 2pt solid #1e40af; \r\n                        padding-bottom: 5mm; \r\n                        margin-bottom: 8mm; \r\n                        display: flex;\r\n                        align-items: center;\r\n                        gap: 10mm;\r\n                    }\r\n                    .logo { height: 90px; width: auto; object-fit: contain; }\r\n                    .header-content { flex: 1; }\r\n                    .school-name { \r\n                        font-size: 24pt; \r\n                        font-weight: 900; \r\n                        text-transform: uppercase; \r\n                        color: #1e3a8a; \r\n                        margin: 0;\r\n                        letter-spacing: -1px;\r\n                    }\r\n                    .sub-header { \r\n                        font-size: 10pt; \r\n                        font-weight: 700; \r\n                        color: #64748b; \r\n                        text-transform: uppercase;\r\n                        letter-spacing: 1px;\r\n                    }\r\n                    .document-title { \r\n                        margin-top: 4mm;\r\n                        display: inline-block;\r\n                        background: #1e40af;\r\n                        color: #fff;\r\n                        padding: 2mm 10mm;\r\n                        border-radius: 4px;\r\n                        font-weight: 800;\r\n                        text-transform: uppercase;\r\n                        font-size: 11pt;\r\n                        letter-spacing: 2px;\r\n                    }\r\n\r\n                    /* Profile Grid */\r\n                    .profile-grid { \r\n                        display: grid; \r\n                        grid-template-columns: 1.5fr 1fr; \r\n                        gap: 8mm; \r\n                        margin-bottom: 8mm;\r\n                    }\r\n                    .section-label { \r\n                        font-size: 8pt; \r\n                        font-weight: 800; \r\n                        text-transform: uppercase; \r\n                        color: #1e40af;\r\n                        margin-bottom: 2mm;\r\n                        display: block;\r\n                    }\r\n                    .data-card { \r\n                        background: #f1f5f9;\r\n                        border: 1pt solid #e2e8f0;\r\n                        padding: 5mm;\r\n                        border-radius: 6px;\r\n                    }\r\n                    .data-row { display: flex; margin-bottom: 2mm; border-bottom: 0.5pt solid #ddd; padding-bottom: 1mm; }\r\n                    .data-row:last-child { border: none; margin: 0; padding: 0; }\r\n                    .label { width: 35mm; font-size: 8.5pt; font-weight: 700; color: #64748b; text-transform: uppercase; }\r\n                    .value { font-size: 11pt; font-weight: 900; color: #0f172a; flex: 1; }\r\n\r\n                    /* Marks Table */\r\n                    .marks-table { \r\n                        width: 100%; \r\n                        border-collapse: collapse; \r\n                        margin-bottom: 8mm;\r\n                        border: 1pt solid #1e40af;\r\n                    }\r\n                    .marks-table th { \r\n                        background: #1e40af;\r\n                        color: #fff;\r\n                        border: 1pt solid #1e40af;\r\n                        padding: 4mm 3mm;\r\n                        text-align: left;\r\n                        font-size: 9pt;\r\n                        text-transform: uppercase;\r\n                        letter-spacing: 1px;\r\n                    }\r\n                    .marks-table td { \r\n                        border: 1pt solid #e2e8f0;\r\n                        padding: 4mm 3mm;\r\n                        font-size: 11pt;\r\n                        font-weight: 500;\r\n                    }\r\n                    .marks-table tr:nth-child(even) { background: #f8fafc; }\r\n                    .col-center { text-align: center; }\r\n                    .col-marks { font-weight: 900; font-size: 14pt; color: #1e3a8a; }\r\n\r\n                    /* Summary Boxes */\r\n                    .summary-grid { \r\n                        display: grid;\r\n                        grid-template-columns: repeat(3, 1fr);\r\n                        gap: 5mm;\r\n                        margin-bottom: 8mm;\r\n                    }\r\n                    .summary-card { \r\n                        background: #fff;\r\n                        border: 1.5pt solid #1e40af;\r\n                        padding: 5mm;\r\n                        text-align: center;\r\n                        position: relative;\r\n                        overflow: hidden;\r\n                    }\r\n                    .summary-card::before {\r\n                        content: '';\r\n                        position: absolute;\r\n                        top: 0; left: 0; right: 0; height: 3pt;\r\n                        background: #1e40af;\r\n                    }\r\n                    .sum-label { font-size: 8pt; font-weight: 800; text-transform: uppercase; color: #64748b; margin-bottom: 1mm; display: block; }\r\n                    .sum-value { font-size: 20pt; font-weight: 900; color: #0f172a; }\r\n\r\n                    /* Remarks */\r\n                    .remarks-box { \r\n                        padding: 5mm; \r\n                        background: #ecf2ff; \r\n                        border: 1pt solid #1e40af33; \r\n                        border-radius: 6px;\r\n                        margin-bottom: 15mm;\r\n                    }\r\n                    .remarks-title { font-size: 8pt; font-weight: 900; text-transform: uppercase; color: #1e40af; margin-bottom: 2mm; display: block; }\r\n                    .remarks-text { font-size: 11pt; font-weight: 500; color: #334155; line-height: 1.5; font-style: italic; }\r\n\r\n                    /* Signatures */\r\n                    .footer { \r\n                        margin-top: auto; \r\n                        display: flex; \r\n                        justify-content: space-between; \r\n                        align-items: flex-end;\r\n                        padding: 0 5mm 5mm 5mm;\r\n                    }\r\n                    .signature { \r\n                        text-align: center;\r\n                        width: 50mm;\r\n                    }\r\n                    .sign-line { \r\n                        border-top: 1.2pt solid #0f172a; \r\n                        margin-top: 3mm; \r\n                        padding-top: 1.5mm; \r\n                        font-weight: 800; \r\n                        font-size: 9pt; \r\n                        text-transform: uppercase; \r\n                        color: #0f172a;\r\n                    }\r\n                    .sign-stamp { height: 55px; margin-bottom: -15px; display: block; margin-left: auto; margin-right: auto; }\r\n\r\n                    .watermark {\r\n                        position: absolute;\r\n                        top: 55%;\r\n                        left: 50%;\r\n                        transform: translate(-50%, -50%);\r\n                        width: 140mm;\r\n                        opacity: 0.035;\r\n                        z-index: 0;\r\n                        pointer-events: none;\r\n                    }\r\n                    .watermark img { width: 100%; filter: grayscale(1); }\r\n                </style>\r\n            </head>\r\n            <body>\r\n                ${students.map(student => {\r\n            const result = results[student.id];\r\n            if (!result) return '';\r\n\r\n            const subEntries = Object.entries(result.subjects || {});\r\n            let totalOb = 0;\r\n            let totalMax = 0;\r\n            subEntries.forEach(([_, data]: any) => {\r\n                const ob = parseFloat(data.obtained);\r\n                const mx = parseFloat(data.maxMarks);\r\n                if (!isNaN(ob)) totalOb += ob;\r\n                if (!isNaN(mx)) totalMax += mx;\r\n            });\r\n            const percentage = totalMax > 0 ? (totalOb / totalMax) * 100 : 0;\r\n            const gradeMap = percentage >= 90 ? 'A+' : percentage >= 80 ? 'A' : percentage >= 70 ? 'B+' : percentage >= 60 ? 'B' : percentage >= 50 ? 'C' : percentage >= 35 ? 'D' : 'E (Fail)';\r\n\r\n            return `\r\n                        <div class=\"report-card\">\r\n                            <div class=\"document-border\"></div>\r\n                            <div class=\"watermark\">\r\n                                ${branding?.schoolLogo ? `<img src=\"${branding.schoolLogo}\" />` : ''}\r\n                            </div>\r\n\r\n                            <div class=\"header\">\r\n                                ${branding?.schoolLogo ? `<img src=\"${branding.schoolLogo}\" class=\"logo\" />` : ''}\r\n                                <div class=\"header-content\">\r\n                                    <h1 class=\"school-name\">${branding?.schoolName || \"Spoorthy Concept School\"}</h1>\r\n                                    <div class=\"sub-header\">Official Academic Record - Recognized by Govt. of Telangana</div>\r\n                                    <div class=\"document-title\">Scholastic Performance Report</div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"profile-grid\">\r\n                                <div>\r\n                                    <span class=\"section-label\">Student Identification</span>\r\n                                    <div class=\"data-card\">\r\n                                        <div class=\"data-row\"><span class=\"label\">Legal Name</span> <span class=\"value\">${student.studentName.toUpperCase()}</span></div>\r\n                                        <div class=\"data-row\"><span class=\"label\">Enrollment ID</span> <span class=\"value\">${student.schoolId}</span></div>\r\n                                        <div class=\"data-row\"><span class=\"label\">Class/Section</span> <span class=\"value\">${student.className} â€“ ${student.sectionName || 'A'}</span></div>\r\n                                        <div class=\"data-row\"><span class=\"label\">Roll Number</span> <span class=\"value\">${student.rollNo || 'N/A'}</span></div>\r\n                                    </div>\r\n                                </div>\r\n                                <div>\r\n                                    <span class=\"section-label\">Academic Detail</span>\r\n                                    <div class=\"data-card\">\r\n                                        <div class=\"data-row\"><span class=\"label\">Examination</span> <span class=\"value\">${exam.name}</span></div>\r\n                                        <div class=\"data-row\"><span class=\"label\">Session</span> <span class=\"value\">2025-2026</span></div>\r\n                                        <div class=\"data-row\"><span class=\"label\">Issue Date</span> <span class=\"value\">${new Date().toLocaleDateString()}</span></div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <table class=\"marks-table\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th style=\"width: 40%\">Subject Particulars</th>\r\n                                        <th class=\"col-center\">Max Marks</th>\r\n                                        <th class=\"col-center\">Obtained</th>\r\n                                        <th>Academic Remarks</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    ${subEntries.map(([subId, data]: any) => `\r\n                                        <tr>\r\n                                            <td style=\"font-weight: 800; color: #1e3a8a;\">${subjects[subId]?.name || subId}</td>\r\n                                            <td class=\"col-center\" style=\"color: #64748b;\">${data.maxMarks}</td>\r\n                                            <td class=\"col-center col-marks\">${data.obtained}</td>\r\n                                            <td style=\"font-size: 9pt; color: #475569;\">${data.remarks || 'Satisfactory'}</td>\r\n                                        </tr>\r\n                                    `).join('')}\r\n                                </tbody>\r\n                            </table>\r\n\r\n                            <div class=\"summary-grid\">\r\n                                <div class=\"summary-card\">\r\n                                    <span class=\"sum-label\">Aggregate Score</span>\r\n                                    <span class=\"sum-value\">${totalOb} <small style=\"font-size: 10pt; color: #94a3b8;\">/ ${totalMax}</small></span>\r\n                                </div>\r\n                                <div class=\"summary-card\">\r\n                                    <span class=\"sum-label\">Percentage</span>\r\n                                    <span class=\"sum-value\">${percentage.toFixed(1)}%</span>\r\n                                </div>\r\n                                <div class=\"summary-card\">\r\n                                    <span class=\"sum-label\">Scholastic Grade</span>\r\n                                    <span class=\"sum-value\" style=\"color: #1e40af;\">${gradeMap}</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"remarks-box\">\r\n                                <span class=\"remarks-title\">Institutional Feedback</span>\r\n                                <p class=\"remarks-text\">\r\n                                    ${percentage > 85 ? \"Exceptional academic proficiency demonstrated. Continues to be an exemplary student.\" :\r\n                    percentage > 70 ? \"Commendable performance. Shows strong potential for further academic growth.\" :\r\n                        percentage > 50 ? \"Consistent effort is recommended in core subjects to achieve higher proficiency.\" :\r\n                            \"Focused remedial attention in specific areas required for academic advancement.\"}\r\n                                </p>\r\n                            </div>\r\n\r\n                            <div class=\"footer\">\r\n                                <div class=\"signature\">\r\n                                    <div class=\"sign-line\">Class Teacher</div>\r\n                                </div>\r\n                                <div class=\"signature\">\r\n                                    <div class=\"sign-line\">Parent Signature</div>\r\n                                </div>\r\n                                <div class=\"signature\">\r\n                                    ${branding?.principalSignature ? `<img src=\"${branding.principalSignature}\" class=\"sign-stamp\" />` : ''}\r\n                                    <div class=\"sign-line\">Principal</div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    `;\r\n        }).join('')}\r\n                <script>\r\n                    window.onload = () => { window.print(); setTimeout(() => window.close(), 500); };\r\n                </script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        printWindow.document.write(html);\r\n        printWindow.document.close();\r\n        setOpen(false);\r\n    };\r\n\r\n    const readyCount = students.filter(s => results[s.id]).length;\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={setOpen}>\r\n            <DialogTrigger asChild>\r\n                <Button variant=\"outline\" className=\"gap-2 border-emerald-500/20 bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20\">\r\n                    <FileText className=\"w-4 h-4\" /> Report Cards\r\n                </Button>\r\n            </DialogTrigger>\r\n            <DialogContent className=\"bg-black/95 border-white/10 text-white w-[95vw] sm:max-w-md\">\r\n                <DialogHeader>\r\n                    <DialogTitle>Generate Report Cards</DialogTitle>\r\n                </DialogHeader>\r\n\r\n                <div className=\"py-4 space-y-4\">\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                        This will generate formal report cards for the selected class.\r\n                    </p>\r\n\r\n                    {loading ? (\r\n                        <div className=\"flex flex-col items-center py-8\">\r\n                            <Loader2 className=\"w-8 h-8 animate-spin text-emerald-500 mb-2\" />\r\n                            <p className=\"text-xs\">Preparing Student Records...</p>\r\n                        </div>\r\n                    ) : (\r\n                        <>\r\n                            <div className=\"grid grid-cols-2 gap-3\">\r\n                                <div className=\"p-3 bg-white/5 border border-white/10 rounded-lg\">\r\n                                    <p className=\"text-[10px] text-muted-foreground uppercase\">Class Strength</p>\r\n                                    <p className=\"text-xl font-bold\">{students.length}</p>\r\n                                </div>\r\n                                <div className=\"p-3 bg-emerald-500/5 border border-emerald-500/10 rounded-lg\">\r\n                                    <p className=\"text-[10px] text-emerald-400 uppercase\">Results Ready</p>\r\n                                    <p className=\"text-xl font-bold text-emerald-400\">{readyCount}</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {readyCount === 0 ? (\r\n                                <div className=\"p-4 bg-red-500/10 border border-red-500/20 rounded-lg flex gap-3 text-red-400\">\r\n                                    <AlertCircle className=\"w-5 h-5 shrink-0\" />\r\n                                    <p className=\"text-xs\">No marks have been entered for this class yet. Teachers must enter marks before report cards can be generated.</p>\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg flex gap-3 text-blue-400\">\r\n                                    <CheckCircle className=\"w-5 h-5 shrink-0\" />\r\n                                    <p className=\"text-xs\">\r\n                                        Ready to print {readyCount} report cards. Each student will get a full A4 page with\r\n                                        breakdown of marks, total, percentage, and principal's signature.\r\n                                    </p>\r\n                                </div>\r\n                            )}\r\n\r\n                            <Button\r\n                                onClick={handlePrint}\r\n                                disabled={readyCount === 0}\r\n                                className=\"w-full bg-emerald-600 hover:bg-emerald-700 text-white h-12 gap-2 font-bold\"\r\n                            >\r\n                                <Printer className=\"w-5 h-5\" /> Print {readyCount} Report Cards\r\n                            </Button>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}