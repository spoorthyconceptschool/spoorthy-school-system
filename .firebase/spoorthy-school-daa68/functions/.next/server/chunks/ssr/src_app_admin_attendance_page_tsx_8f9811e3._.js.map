{"version":3,"sources":["../../../../src/components/attendance/staff-attendance-manager.tsx","../../../../src/components/attendance/teacher-attendance-manager.tsx","../../../../src/app/admin/attendance/page.tsx","../../../../node_modules/lucide-react/src/icons/user-x.ts"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useAuth } from \"@/context/AuthContext\";\r\nimport { db } from \"@/lib/firebase\";\r\nimport { collection, query, where, getDocs, doc, getDoc } from \"firebase/firestore\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Loader2, Check, X, Save, Search, UserX, Printer } from \"lucide-react\";\r\nimport { toast } from \"@/lib/toast-store\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { DataTable } from \"@/components/ui/data-table\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { BarChart3, User, CalendarDays, FileText } from \"lucide-react\";\r\nimport { documentId } from \"firebase/firestore\";\r\nimport { useMasterData } from \"@/context/MasterDataContext\";\r\n\r\nexport default function StaffAttendanceManager({\r\n    defaultDate\r\n}: {\r\n    defaultDate?: string;\r\n}) {\r\n    const { user } = useAuth();\r\n    const { branding } = useMasterData();\r\n    const [staff, setStaff] = useState<any[]>([]);\r\n    const [attendance, setAttendance] = useState<Record<string, 'P' | 'A'>>({});\r\n    const [loading, setLoading] = useState(true);\r\n    const [submitting, setSubmitting] = useState(false);\r\n    const [alreadyMarked, setAlreadyMarked] = useState(false);\r\n    const [isModified, setIsModified] = useState(false);\r\n    const [touched, setTouched] = useState<Set<string>>(new Set());\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [viewStats, setViewStats] = useState(false);\r\n    const [statsData, setStatsData] = useState<any[]>([]);\r\n    const [statsMonth, setStatsMonth] = useState<string>(\"ALL\");\r\n\r\n    const date = defaultDate || new Date().toISOString().split('T')[0];\r\n\r\n    useEffect(() => {\r\n        if (viewStats) {\r\n            fetchStats();\r\n        } else {\r\n            fetchData();\r\n        }\r\n    }, [date, viewStats, statsMonth]);\r\n\r\n    const fetchStats = async () => {\r\n        setLoading(true);\r\n        try {\r\n            // Re-fetch staff\r\n            const sSnap = await getDocs(collection(db, \"staff\"));\r\n            const sList = sSnap.docs.map(d => {\r\n                const data = d.data();\r\n                return {\r\n                    id: d.id, schoolId: d.id, name: data.name, role: data.roleName || \"Staff\"\r\n                };\r\n            }).sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n            // Fetch Attendance in range\r\n            const currentYear = new Date().getFullYear();\r\n            let startKey, endKey;\r\n\r\n            if (statsMonth === \"ALL\") {\r\n                startKey = `STAFF_${currentYear}-01-01`;\r\n                endKey = `STAFF_${currentYear}-12-31`;\r\n            } else {\r\n                startKey = `STAFF_${currentYear}-${statsMonth}-01`;\r\n                endKey = `STAFF_${currentYear}-${statsMonth}-31`;\r\n            }\r\n\r\n            const q = query(\r\n                collection(db, \"attendance\"),\r\n                where(documentId(), \">=\", startKey),\r\n                where(documentId(), \"<=\", endKey)\r\n            );\r\n            const snap = await getDocs(q);\r\n            const staffStats: Record<string, { total: number, present: number }> = {};\r\n\r\n            snap.docs.forEach((doc) => {\r\n                const data = doc.data();\r\n                if (data.records) {\r\n                    Object.entries(data.records).forEach(([sid, status]: [string, any]) => {\r\n                        if (!staffStats[sid]) staffStats[sid] = { total: 0, present: 0 };\r\n                        if (status === 'P' || status === 'A') {\r\n                            staffStats[sid].total++;\r\n                            if (status === 'P') staffStats[sid].present++;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            const data = sList.map(s => {\r\n                const st = staffStats[s.schoolId] || { total: 0, present: 0 };\r\n                return {\r\n                    ...s,\r\n                    totalDays: st.total,\r\n                    presentDays: st.present,\r\n                    percentage: st.total > 0 ? ((st.present / st.total) * 100).toFixed(1) : \"0.0\"\r\n                };\r\n            });\r\n            setStatsData(data);\r\n            setStaff(sList);\r\n        } catch (error: any) {\r\n            console.error(\"Stats error\", error);\r\n            toast({ title: \"Error\", description: \"Failed to load stats\", type: \"error\" });\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handlePrint = () => {\r\n        const period = statsMonth === \"ALL\" ? `Annual Report ${new Date().getFullYear()}` : `Monthly Report - ${new Date(2000, Number(statsMonth) - 1).toLocaleString('default', { month: 'long' })} ${new Date().getFullYear()}`;\r\n\r\n        const html = `\r\n            <html>\r\n            <head>\r\n                <title>Staff Attendance Report - ${period}</title>\r\n                <style>\r\n                    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; color: #333; }\r\n                    .header { display: flex; align-items: center; justify-content: center; gap: 30px; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }\r\n                    .logo { height: 80px; width: auto; object-fit: contain; }\r\n                    .header-text { text-align: left; }\r\n                    h1 { margin: 0; font-size: 28px; }\r\n                    .period { font-size: 14px; color: #666; margin-top: 2px; }\r\n                    table { width: 100%; border-collapse: collapse; margin-top: 20px; }\r\n                    th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }\r\n                    th { background-color: #f8f9fa; font-weight: bold; text-transform: uppercase; font-size: 12px; }\r\n                    .text-center { text-align: center; }\r\n                    .font-bold { font-weight: bold; }\r\n                    .percentage { font-weight: bold; }\r\n                    .low { color: #dc3545; }\r\n                    .good { color: #28a745; }\r\n                    .footer { margin-top: 50px; display: flex; justify-content: space-between; font-size: 12px; color: #666; }\r\n                </style>\r\n            </head>\r\n            <body>\r\n                <div class=\"header\">\r\n                    ${branding?.schoolLogo ? `<img src=\"${branding.schoolLogo}\" class=\"logo\" />` : ''}\r\n                    <div class=\"header-text\">\r\n                        <h1 style=\"margin: 0;\">${branding?.schoolName || 'Attendance Report'}</h1>\r\n                        <div class=\"period\">Staff Attendance - ${period}</div>\r\n                    </div>\r\n                </div>\r\n                <table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th style=\"width: 40px;\">#</th>\r\n                            <th>Staff Name</th>\r\n                            <th>Role</th>\r\n                            <th class=\"text-center\">Total Days</th>\r\n                            <th class=\"text-center\">Present</th>\r\n                            <th class=\"text-center\">Absents</th>\r\n                            <th class=\"text-center\">Attendance %</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        ${statsData.map((s, idx) => `\r\n                            <tr>\r\n                                <td>${idx + 1}</td>\r\n                                <td class=\"font-bold\">${s.name}</td>\r\n                                <td>${s.role}</td>\r\n                                <td class=\"text-center\">${s.totalDays}</td>\r\n                                <td class=\"text-center\" style=\"color: #28a745; font-weight: bold;\">${s.presentDays}</td>\r\n                                <td class=\"text-center\">${s.totalDays - s.presentDays}</td>\r\n                                <td class=\"text-center percentage ${Number(s.percentage) < 80 ? 'low' : 'good'}\">${s.percentage}%</td>\r\n                            </tr>\r\n                        `).join('')}\r\n                    </tbody>\r\n                </table>\r\n                <div class=\"footer\">\r\n                    <div>Generated on: ${new Date().toLocaleString()}</div>\r\n                    <div>School Management System</div>\r\n                </div>\r\n                <script>\r\n                    window.onload = () => {\r\n                        window.print();\r\n                        window.onafterprint = () => window.close();\r\n                    };\r\n                </script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        const win = window.open('', '_blank');\r\n        win?.document.write(html);\r\n        win?.document.close();\r\n    };\r\n\r\n    const fetchData = async () => {\r\n        setLoading(true);\r\n        try {\r\n            // 1. Fetch Active Staff\r\n            // active status might be field 'status' or just existence. Assuming 'status' == 'active' based on other files.\r\n            // checking salary page, it fetched collection \"staff\" without filter. But let's check field.\r\n            // Salary page: const sSnap = await getDocs(collection(db, \"staff\")); \r\n            // It didn't filter by status. I'll fetch all.\r\n\r\n            const sSnap = await getDocs(collection(db, \"staff\"));\r\n            const sList = sSnap.docs.map(d => {\r\n                const data = d.data();\r\n                return {\r\n                    id: d.id,\r\n                    schoolId: d.id, // Using Doc ID as School ID equivalent for Staff\r\n                    name: data.name,\r\n                    role: data.roleName || \"Staff\"\r\n                };\r\n            }).sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n            setStaff(sList);\r\n\r\n            // 2. Fetch Existing Attendance\r\n            const attId = `STAFF_${date}`;\r\n            const attSnap = await getDoc(doc(db, \"attendance\", attId));\r\n\r\n            if (attSnap.exists()) {\r\n                setAlreadyMarked(true);\r\n                setAttendance(attSnap.data().records || {});\r\n            } else {\r\n                setAlreadyMarked(false);\r\n                const initial: Record<string, 'P' | 'A'> = {};\r\n                sList.forEach((s: any) => {\r\n                    initial[s.schoolId] = 'P'; // Default Present\r\n                });\r\n                setAttendance(initial);\r\n            }\r\n        } catch (e: any) {\r\n            console.error(e);\r\n            toast({ title: \"Error\", description: \"Failed to fetch data.\", type: \"error\" });\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const toggleStatus = (schoolId: string) => {\r\n        setAttendance(prev => ({\r\n            ...prev,\r\n            [schoolId]: prev[schoolId] === 'P' ? 'A' : 'P'\r\n        }));\r\n        setTouched(prev => {\r\n            const next = new Set(prev);\r\n            next.add(schoolId);\r\n            return next;\r\n        });\r\n        setIsModified(true);\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        setSubmitting(true);\r\n        try {\r\n            const res = await fetch(\"/api/admin/attendance/staff/mark\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify({\r\n                    date,\r\n                    records: attendance,\r\n                    markedBy: user?.uid,\r\n                    markedByName: user?.displayName || \"Admin\",\r\n                    isModification: alreadyMarked,\r\n                    touchedIds: Array.from(touched)\r\n                })\r\n            });\r\n\r\n            const data = await res.json();\r\n            if (!data.success) throw new Error(data.error);\r\n\r\n            toast({\r\n                title: alreadyMarked ? \"Attendance Updated\" : \"Attendance Submitted\",\r\n                description: `Updated ${data.changesCount || 0} records.`,\r\n                type: \"success\"\r\n            });\r\n\r\n            setAlreadyMarked(true);\r\n            setIsModified(false);\r\n            setTouched(new Set());\r\n        } catch (e: any) {\r\n            console.error(e);\r\n            toast({ title: \"Failed\", description: e.message, type: \"error\" });\r\n        } finally {\r\n            setSubmitting(false);\r\n        }\r\n    };\r\n\r\n    // Filter Staff\r\n    const filteredStaff = staff.filter(s =>\r\n        s.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        s.role.toLowerCase().includes(searchQuery.toLowerCase())\r\n    );\r\n\r\n    if (loading) return <div className=\"p-10 flex justify-center\"><Loader2 className=\"animate-spin\" /></div>;\r\n\r\n    const stats = {\r\n        total: staff.length,\r\n        present: Object.values(attendance).filter(v => v === 'P').length,\r\n        absent: Object.values(attendance).filter(v => v === 'A').length\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Stats Cards */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                <Card className=\"bg-black/20 border-white/10 overflow-hidden\">\r\n                    <div className=\"p-4 flex items-center justify-between\">\r\n                        <div>\r\n                            <div className=\"text-xs text-muted-foreground uppercase\">Total Staff</div>\r\n                            <div className=\"text-2xl font-bold\">{stats.total}</div>\r\n                        </div>\r\n                        <div className=\"w-10 h-10 rounded-full bg-blue-500/10 flex items-center justify-center text-blue-500\">\r\n                            <Check className=\"w-5 h-5\" />\r\n                        </div>\r\n                    </div>\r\n                </Card>\r\n                <Card className=\"bg-black/20 border-white/10 overflow-hidden\">\r\n                    <div className=\"p-4 flex items-center justify-between border-l-4 border-emerald-500\">\r\n                        <div>\r\n                            <div className=\"text-xs text-muted-foreground uppercase\">Present</div>\r\n                            <div className=\"text-2xl font-bold text-emerald-500\">{stats.present}</div>\r\n                        </div>\r\n                        <div className=\"w-10 h-10 rounded-full bg-emerald-500/10 flex items-center justify-center text-emerald-500\">\r\n                            <Check className=\"w-5 h-5\" />\r\n                        </div>\r\n                    </div>\r\n                </Card>\r\n                <Card className=\"bg-black/20 border-white/10 overflow-hidden\">\r\n                    <div className=\"p-4 flex items-center justify-between border-l-4 border-red-500\">\r\n                        <div>\r\n                            <div className=\"text-xs text-muted-foreground uppercase\">Absent</div>\r\n                            <div className=\"text-2xl font-bold text-red-500\">{stats.absent}</div>\r\n                        </div>\r\n                        <div className=\"w-10 h-10 rounded-full bg-red-500/10 flex items-center justify-center text-red-500\">\r\n                            <X className=\"w-5 h-5\" />\r\n                        </div>\r\n                    </div>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* List */}\r\n            <Card className=\"bg-black/20 border-white/10\">\r\n                <div className=\"p-4 border-b border-white/10 flex flex-col md:flex-row justify-between gap-4 items-center\">\r\n                    <div className=\"flex flex-wrap bg-black/40 p-1 rounded-lg border border-white/10 items-center gap-2\">\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => setViewStats(false)}\r\n                            className={!viewStats ? \"bg-emerald-500/20 text-emerald-500\" : \"text-muted-foreground hover:text-white\"}\r\n                        >\r\n                            Daily View\r\n                        </Button>\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => setViewStats(true)}\r\n                            className={viewStats ? \"bg-blue-500/20 text-blue-500\" : \"text-muted-foreground hover:text-white\"}\r\n                        >\r\n                            Overall Stats\r\n                        </Button>\r\n\r\n                        {viewStats && (\r\n                            <>\r\n                                <Select value={statsMonth} onValueChange={setStatsMonth}>\r\n                                    <SelectTrigger className=\"w-[140px] h-8 bg-transparent border-white/10 text-xs\">\r\n                                        <SelectValue placeholder=\"Period\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent className=\"bg-slate-900 border-white/10\">\r\n                                        <SelectItem value=\"ALL\">Full Year {new Date().getFullYear()}</SelectItem>\r\n                                        <SelectItem value=\"01\">January</SelectItem>\r\n                                        <SelectItem value=\"02\">February</SelectItem>\r\n                                        <SelectItem value=\"03\">March</SelectItem>\r\n                                        <SelectItem value=\"04\">April</SelectItem>\r\n                                        <SelectItem value=\"05\">May</SelectItem>\r\n                                        <SelectItem value=\"06\">June</SelectItem>\r\n                                        <SelectItem value=\"07\">July</SelectItem>\r\n                                        <SelectItem value=\"08\">August</SelectItem>\r\n                                        <SelectItem value=\"09\">September</SelectItem>\r\n                                        <SelectItem value=\"10\">October</SelectItem>\r\n                                        <SelectItem value=\"11\">November</SelectItem>\r\n                                        <SelectItem value=\"12\">December</SelectItem>\r\n                                    </SelectContent>\r\n                                </Select>\r\n\r\n                                <Button\r\n                                    size=\"sm\"\r\n                                    variant=\"outline\"\r\n                                    className=\"h-8 border-white/10 hover:bg-white/5 gap-2 px-3\"\r\n                                    onClick={handlePrint}\r\n                                >\r\n                                    <Printer className=\"w-3 h-3\" /> Print Report\r\n                                </Button>\r\n                            </>\r\n                        )}\r\n                    </div>\r\n\r\n                    {!viewStats && (\r\n                        <div className=\"relative flex-1 w-full md:max-w-xs\">\r\n                            <Search className=\"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground\" />\r\n                            <Input\r\n                                placeholder=\"Search staff...\"\r\n                                value={searchQuery}\r\n                                onChange={(e) => setSearchQuery(e.target.value)}\r\n                                className=\"pl-8 bg-black/40 border-white/10 w-full\"\r\n                            />\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <CardContent className=\"p-0\">\r\n                    <DataTable\r\n                        data={viewStats ? statsData : filteredStaff}\r\n                        isLoading={loading}\r\n                        columns={viewStats ? [\r\n                            {\r\n                                key: \"index\",\r\n                                header: \"#\",\r\n                                render: (_: any, idx?: number) => <span className=\"font-mono text-sm\">{(idx ?? 0) + 1}</span>\r\n                            },\r\n                            {\r\n                                key: \"name\",\r\n                                header: \"Staff Name\",\r\n                                render: (s: any) => (\r\n                                    <div>\r\n                                        <div className=\"font-medium text-white\">{s.name}</div>\r\n                                        <div className=\"text-[10px] text-white/40 uppercase\">{s.role}</div>\r\n                                    </div>\r\n                                )\r\n                            },\r\n                            {\r\n                                key: \"totalDays\",\r\n                                header: \"Total\",\r\n                                cellClassName: \"text-center\",\r\n                                render: (s: any) => <span className=\"font-mono\">{s.totalDays}</span>\r\n                            },\r\n                            {\r\n                                key: \"presentDays\",\r\n                                header: \"Present\",\r\n                                cellClassName: \"text-center\",\r\n                                render: (s: any) => <span className=\"font-bold text-emerald-400\">{s.presentDays}</span>\r\n                            },\r\n                            {\r\n                                key: \"percentage\",\r\n                                header: \"Attendance %\",\r\n                                cellClassName: \"text-center\",\r\n                                render: (s: any) => (\r\n                                    <div className=\"flex flex-col items-center min-w-[80px]\">\r\n                                        <span className={`font-bold ${Number(s.percentage) < 80 ? \"text-red-400\" : \"text-emerald-400\"}`}>\r\n                                            {s.percentage}%\r\n                                        </span>\r\n                                        <div className=\"w-full h-1 bg-white/10 rounded-full mt-1 overflow-hidden max-w-[60px]\">\r\n                                            <div\r\n                                                className={`h-full ${Number(s.percentage) < 80 ? \"bg-red-500\" : \"bg-emerald-500\"}`}\r\n                                                style={{ width: `${s.percentage}%` }}\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                )\r\n                            },\r\n                            {\r\n                                key: \"absents\",\r\n                                header: \"Absents\",\r\n                                cellClassName: \"text-right\",\r\n                                render: (s: any) => <span className=\"text-white/40\">{(s.totalDays - s.presentDays)}</span>\r\n                            }\r\n                        ] : [\r\n                            {\r\n                                key: \"index\",\r\n                                header: \"#\",\r\n                                render: (_: any, idx?: number) => <span className=\"font-mono text-sm\">{(idx ?? 0) + 1}</span>\r\n                            },\r\n                            {\r\n                                key: \"name\",\r\n                                header: \"Staff Name\",\r\n                                render: (s: any) => {\r\n                                    return (\r\n                                        <div>\r\n                                            <div className=\"font-medium text-white\">\r\n                                                {s.name}\r\n                                            </div>\r\n                                            <div className=\"text-[10px] text-white/40 uppercase\">{s.role}</div>\r\n                                        </div>\r\n                                    );\r\n                                }\r\n                            },\r\n                            {\r\n                                key: \"attendanceStatus\",\r\n                                header: \"Status\",\r\n                                cellClassName: \"text-center\",\r\n                                render: (s: any) => {\r\n                                    const status = attendance[s.schoolId];\r\n                                    return (\r\n                                        <Badge className={cn(\r\n                                            \"font-black uppercase tracking-tighter text-[9px]\",\r\n                                            status === 'P' ? \"bg-emerald-500/10 text-emerald-500 border border-emerald-500/20\" : \"bg-red-500/10 text-red-500 border border-red-500/20\"\r\n                                        )}>\r\n                                            {status === 'P' ? \"Present\" : \"Absent\"}\r\n                                        </Badge>\r\n                                    );\r\n                                }\r\n                            },\r\n                            {\r\n                                key: \"action\",\r\n                                header: \"Action\",\r\n                                cellClassName: \"text-right\",\r\n                                render: (s: any) => {\r\n                                    const status = attendance[s.schoolId];\r\n                                    return (\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            variant=\"ghost\"\r\n                                            className={cn(\r\n                                                \"h-8 text-[10px] font-black uppercase tracking-tighter px-3 rounded-lg\",\r\n                                                status === 'P'\r\n                                                    ? \"bg-red-500/10 text-red-400 hover:bg-red-500 hover:text-white\"\r\n                                                    : \"bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500 hover:text-white\"\r\n                                            )}\r\n                                            onClick={() => toggleStatus(s.schoolId)}\r\n                                        >\r\n                                            {status === 'P' ? \"Mark Absent\" : \"Mark Present\"}\r\n                                        </Button>\r\n                                    );\r\n                                }\r\n                            }\r\n                        ]}\r\n                    />\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {!viewStats && (\r\n                <div className=\"flex justify-between items-center bg-white/5 p-4 rounded-lg border border-white/10\">\r\n                    <div className=\"text-sm text-muted-foreground\">\r\n                        {alreadyMarked\r\n                            ? (isModified ? \"You have unsaved changes.\" : `Attendance already marked by ${user?.uid === \"admin\" ? \"Admin\" : \"System\"}`)\r\n                            : \"Ready to submit.\"\r\n                        }\r\n                    </div>\r\n                    <Button\r\n                        size=\"lg\"\r\n                        onClick={handleSubmit}\r\n                        disabled={submitting || (alreadyMarked && !isModified)}\r\n                        className=\"bg-emerald-600 hover:bg-emerald-700 text-white min-w-[200px]\"\r\n                    >\r\n                        {submitting ? <Loader2 className=\"w-5 h-5 animate-spin mr-2\" /> : <Save className=\"w-5 h-5 mr-2\" />}\r\n                        {alreadyMarked ? \"Update Attendance\" : \"Submit Attendance\"}\r\n                    </Button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","\r\n\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useAuth } from \"@/context/AuthContext\";\r\nimport { db } from \"@/lib/firebase\";\r\nimport { collection, query, where, getDocs, doc, getDoc } from \"firebase/firestore\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Loader2, Check, X, Save, UserX, Search, Download, Printer } from \"lucide-react\";\r\nimport { toast } from \"@/lib/toast-store\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { DataTable } from \"@/components/ui/data-table\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { BarChart3, User, CalendarDays, FileText } from \"lucide-react\";\r\nimport { documentId } from \"firebase/firestore\";\r\nimport { useMasterData } from \"@/context/MasterDataContext\";\r\n\r\nexport default function TeacherAttendanceManager({\r\n    defaultDate\r\n}: {\r\n    defaultDate?: string;\r\n}) {\r\n    const { user } = useAuth();\r\n    const { branding } = useMasterData();\r\n    const [teachers, setTeachers] = useState<any[]>([]);\r\n    const [attendance, setAttendance] = useState<Record<string, 'P' | 'A'>>({});\r\n    const [loading, setLoading] = useState(true);\r\n    const [submitting, setSubmitting] = useState(false);\r\n    const [alreadyMarked, setAlreadyMarked] = useState(false);\r\n    const [isModified, setIsModified] = useState(false);\r\n    const [touched, setTouched] = useState<Set<string>>(new Set());\r\n    const [leavesMap, setLeavesMap] = useState<Record<string, boolean>>({}); // schoolId -> true if on leave\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [viewStats, setViewStats] = useState(false);\r\n    const [statsData, setStatsData] = useState<any[]>([]);\r\n    const [statsMonth, setStatsMonth] = useState<string>(\"ALL\"); // ALL or \"01\", \"02\", etc.\r\n\r\n    const date = defaultDate || new Date().toISOString().split('T')[0];\r\n\r\n    useEffect(() => {\r\n        if (viewStats) {\r\n            fetchStats();\r\n        } else {\r\n            fetchData();\r\n        }\r\n    }, [date, viewStats, statsMonth]);\r\n\r\n    const fetchStats = async () => {\r\n        setLoading(true);\r\n        try {\r\n            // Re-fetch teachers\r\n            const tQuery = query(collection(db, \"teachers\"), where(\"status\", \"==\", \"ACTIVE\"));\r\n            const tSnap = await getDocs(tQuery);\r\n            const tList = tSnap.docs.map(d => ({\r\n                id: d.id, schoolId: d.data().schoolId || d.id, name: d.data().name\r\n            })).sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n            // Fetch Attendance in range\r\n            const currentYear = new Date().getFullYear();\r\n            let startKey, endKey;\r\n\r\n            if (statsMonth === \"ALL\") {\r\n                startKey = `TEACHERS_${currentYear}-01-01`;\r\n                endKey = `TEACHERS_${currentYear}-12-31`;\r\n            } else {\r\n                startKey = `TEACHERS_${currentYear}-${statsMonth}-01`;\r\n                // For months with 30 days, this will still work as Firebase range queries are inclusive.\r\n                // For Feb, it will also work. The key is that the end date is always the last day of the month.\r\n                // We can simplify by just using the month and letting Firebase handle the range.\r\n                // However, to be precise for the last day, we can calculate it.\r\n                // For simplicity, using -31 as a general upper bound for the month part of the key.\r\n                // Firebase will match up to the actual last day of the month if the key format is consistent.\r\n                // A more robust way would be to calculate the actual last day of the month.\r\n                // For now, -31 is a safe upper bound for the day part of the key.\r\n                endKey = `TEACHERS_${currentYear}-${statsMonth}-31`;\r\n            }\r\n\r\n            const q = query(\r\n                collection(db, \"attendance\"),\r\n                where(documentId(), \">=\", startKey),\r\n                where(documentId(), \"<=\", endKey)\r\n            );\r\n            const snap = await getDocs(q);\r\n            const teacherStats: Record<string, { total: number, present: number }> = {};\r\n\r\n            snap.docs.forEach((doc) => {\r\n                const data = doc.data();\r\n                if (data.records) {\r\n                    Object.entries(data.records).forEach(([tid, status]: [string, any]) => {\r\n                        if (!teacherStats[tid]) teacherStats[tid] = { total: 0, present: 0 };\r\n                        if (status === 'P' || status === 'A') {\r\n                            teacherStats[tid].total++;\r\n                            if (status === 'P') teacherStats[tid].present++;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            const data = tList.map(t => {\r\n                const st = teacherStats[t.schoolId] || { total: 0, present: 0 };\r\n                return {\r\n                    ...t,\r\n                    totalDays: st.total,\r\n                    presentDays: st.present,\r\n                    percentage: st.total > 0 ? ((st.present / st.total) * 100).toFixed(1) : \"0.0\"\r\n                };\r\n            });\r\n            setStatsData(data);\r\n            setTeachers(tList);\r\n        } catch (error: any) {\r\n            console.error(\"Stats error\", error);\r\n            toast({ title: \"Error\", description: \"Failed to load stats\", type: \"error\" });\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handlePrint = () => {\r\n        const period = statsMonth === \"ALL\" ? `Annual Report ${new Date().getFullYear()}` : `Monthly Report - ${new Date(2000, Number(statsMonth) - 1).toLocaleString('default', { month: 'long' })} ${new Date().getFullYear()}`;\r\n\r\n        const html = `\r\n            <html>\r\n            <head>\r\n                <title>Teacher Attendance Report - ${period}</title>\r\n                <style>\r\n                    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; color: #333; }\r\n                    .header { display: flex; align-items: center; justify-content: center; gap: 30px; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }\r\n                    .logo { height: 80px; width: auto; object-fit: contain; }\r\n                    .header-text { text-align: left; }\r\n                    h1 { margin: 0; font-size: 28px; }\r\n                    .period { font-size: 14px; color: #666; margin-top: 2px; }\r\n                    table { width: 100%; border-collapse: collapse; margin-top: 20px; }\r\n                    th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }\r\n                    th { background-color: #f8f9fa; font-weight: bold; text-transform: uppercase; font-size: 12px; }\r\n                    .text-center { text-align: center; }\r\n                    .font-bold { font-weight: bold; }\r\n                    .percentage { font-weight: bold; }\r\n                    .low { color: #dc3545; }\r\n                    .good { color: #28a745; }\r\n                    .footer { margin-top: 50px; display: flex; justify-content: space-between; font-size: 12px; color: #666; }\r\n                </style>\r\n            </head>\r\n            <body>\r\n                <div class=\"header\">\r\n                    ${branding?.schoolLogo ? `<img src=\"${branding.schoolLogo}\" class=\"logo\" />` : ''}\r\n                    <div class=\"header-text\">\r\n                        <h1 style=\"margin: 0;\">${branding?.schoolName || 'Attendance Report'}</h1>\r\n                        <div class=\"period\">Teacher Attendance - ${period}</div>\r\n                    </div>\r\n                </div>\r\n                <table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th style=\"width: 40px;\">#</th>\r\n                            <th>Teacher Name</th>\r\n                            <th class=\"text-center\">ID</th>\r\n                            <th class=\"text-center\">Total Days</th>\r\n                            <th class=\"text-center\">Present</th>\r\n                            <th class=\"text-center\">Absents</th>\r\n                            <th class=\"text-center\">Attendance %</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        ${statsData.map((s, idx) => `\r\n                            <tr>\r\n                                <td>${idx + 1}</td>\r\n                                <td class=\"font-bold\">${s.name}</td>\r\n                                <td class=\"text-center\">${s.schoolId}</td>\r\n                                <td class=\"text-center\">${s.totalDays}</td>\r\n                                <td class=\"text-center\" style=\"color: #28a745; font-weight: bold;\">${s.presentDays}</td>\r\n                                <td class=\"text-center\">${s.totalDays - s.presentDays}</td>\r\n                                <td class=\"text-center percentage ${Number(s.percentage) < 80 ? 'low' : 'good'}\">${s.percentage}%</td>\r\n                            </tr>\r\n                        `).join('')}\r\n                    </tbody>\r\n                </table>\r\n                <div class=\"footer\">\r\n                    <div>Generated on: ${new Date().toLocaleString()}</div>\r\n                    <div>School Management System</div>\r\n                </div>\r\n                <script>\r\n                    window.onload = () => {\r\n                        window.print();\r\n                        window.onafterprint = () => window.close();\r\n                    };\r\n                </script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        const win = window.open('', '_blank');\r\n        win?.document.write(html);\r\n        win?.document.close();\r\n    };\r\n\r\n    const fetchData = async () => {\r\n        setLoading(true);\r\n        try {\r\n            // 1. Fetch Active Teachers\r\n            const tQuery = query(\r\n                collection(db, \"teachers\"),\r\n                where(\"status\", \"==\", \"ACTIVE\")\r\n            );\r\n            const tSnap = await getDocs(tQuery);\r\n            const tList = tSnap.docs.map(d => {\r\n                const data = d.data();\r\n                return {\r\n                    id: d.id, // usually the schoolId if set properly, or auto-id\r\n                    schoolId: data.schoolId || d.id, // Reliable ID for attendance\r\n                    name: data.name,\r\n                    uid: data.uid\r\n                };\r\n            }).sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n            setTeachers(tList);\r\n\r\n            // 2. Fetch Approved Leaves for this date\r\n            // Note: leave_requests stores teacherId as UID usually.\r\n            const lQuery = query(\r\n                collection(db, \"leave_requests\"),\r\n                where(\"status\", \"==\", \"APPROVED\")\r\n            );\r\n            const lSnap = await getDocs(lQuery);\r\n            const leaveMap: Record<string, boolean> = {}; // using schoolId as key\r\n\r\n            // Create UID -> SchoolID map\r\n            const uidToSchoolId: Record<string, string> = {};\r\n            tList.forEach(t => { if (t.uid) uidToSchoolId[t.uid] = t.schoolId; });\r\n\r\n            lSnap.forEach(doc => {\r\n                const l = doc.data();\r\n                if (l.fromDate <= date && l.toDate >= date) {\r\n                    const sid = uidToSchoolId[l.teacherId];\r\n                    if (sid) {\r\n                        leaveMap[sid] = true;\r\n                    }\r\n                }\r\n            });\r\n            setLeavesMap(leaveMap);\r\n\r\n            // 3. Fetch Existing Attendance\r\n            const attId = `TEACHERS_${date}`;\r\n            const attSnap = await getDoc(doc(db, \"attendance\", attId));\r\n\r\n            if (attSnap.exists()) {\r\n                setAlreadyMarked(true);\r\n                setAttendance(attSnap.data().records || {});\r\n            } else {\r\n                setAlreadyMarked(false);\r\n                const initial: Record<string, 'P' | 'A'> = {};\r\n                tList.forEach((t: any) => {\r\n                    const isOnLeave = leaveMap[t.schoolId];\r\n                    initial[t.schoolId] = isOnLeave ? 'A' : 'P';\r\n                });\r\n                setAttendance(initial);\r\n            }\r\n        } catch (e: any) {\r\n            console.error(e);\r\n            toast({ title: \"Error\", description: \"Failed to fetch data.\", type: \"error\" });\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const toggleStatus = (schoolId: string) => {\r\n        setAttendance(prev => ({\r\n            ...prev,\r\n            [schoolId]: prev[schoolId] === 'P' ? 'A' : 'P'\r\n        }));\r\n        setTouched(prev => {\r\n            const next = new Set(prev);\r\n            next.add(schoolId);\r\n            return next;\r\n        });\r\n        setIsModified(true);\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        setSubmitting(true);\r\n        try {\r\n            const res = await fetch(\"/api/admin/attendance/teachers/mark\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify({\r\n                    date,\r\n                    records: attendance,\r\n                    markedBy: user?.uid,\r\n                    markedByName: user?.displayName || \"Admin\",\r\n                    isModification: alreadyMarked,\r\n                    touchedIds: Array.from(touched)\r\n                })\r\n            });\r\n\r\n            const data = await res.json();\r\n            if (!data.success) throw new Error(data.error);\r\n\r\n            toast({\r\n                title: alreadyMarked ? \"Attendance Updated\" : \"Attendance Submitted\",\r\n                description: `Updated ${data.changesCount || 0} records.`,\r\n                type: \"success\"\r\n            });\r\n\r\n            setAlreadyMarked(true);\r\n            setIsModified(false);\r\n            setTouched(new Set());\r\n        } catch (e: any) {\r\n            console.error(e);\r\n            toast({ title: \"Failed\", description: e.message, type: \"error\" });\r\n        } finally {\r\n            setSubmitting(false);\r\n        }\r\n    };\r\n\r\n    // Filter Teachers\r\n    const filteredTeachers = teachers.filter(t =>\r\n        t.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        t.schoolId.toLowerCase().includes(searchQuery.toLowerCase())\r\n    );\r\n\r\n    if (loading) return <div className=\"p-10 flex justify-center\"><Loader2 className=\"animate-spin\" /></div>;\r\n\r\n    const stats = {\r\n        total: teachers.length,\r\n        present: Object.values(attendance).filter(v => v === 'P').length,\r\n        absent: Object.values(attendance).filter(v => v === 'A').length\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Stats Cards */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                <Card className=\"bg-black/20 border-white/10 overflow-hidden\">\r\n                    <div className=\"p-4 flex items-center justify-between\">\r\n                        <div>\r\n                            <div className=\"text-xs text-muted-foreground uppercase\">Total Teachers</div>\r\n                            <div className=\"text-2xl font-bold\">{stats.total}</div>\r\n                        </div>\r\n                        <div className=\"w-10 h-10 rounded-full bg-blue-500/10 flex items-center justify-center text-blue-500\">\r\n                            <Check className=\"w-5 h-5\" />\r\n                        </div>\r\n                    </div>\r\n                </Card>\r\n                <Card className=\"bg-black/20 border-white/10 overflow-hidden\">\r\n                    <div className=\"p-4 flex items-center justify-between border-l-4 border-emerald-500\">\r\n                        <div>\r\n                            <div className=\"text-xs text-muted-foreground uppercase\">Present</div>\r\n                            <div className=\"text-2xl font-bold text-emerald-500\">{stats.present}</div>\r\n                        </div>\r\n                        <div className=\"w-10 h-10 rounded-full bg-emerald-500/10 flex items-center justify-center text-emerald-500\">\r\n                            <Check className=\"w-5 h-5\" />\r\n                        </div>\r\n                    </div>\r\n                </Card>\r\n                <Card className=\"bg-black/20 border-white/10 overflow-hidden\">\r\n                    <div className=\"p-4 flex items-center justify-between border-l-4 border-red-500\">\r\n                        <div>\r\n                            <div className=\"text-xs text-muted-foreground uppercase\">Absent</div>\r\n                            <div className=\"text-2xl font-bold text-red-500\">{stats.absent}</div>\r\n                        </div>\r\n                        <div className=\"w-10 h-10 rounded-full bg-red-500/10 flex items-center justify-center text-red-500\">\r\n                            <X className=\"w-5 h-5\" />\r\n                        </div>\r\n                    </div>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* List */}\r\n            <Card className=\"bg-black/20 border-white/10\">\r\n                <div className=\"p-4 border-b border-white/10 flex flex-col md:flex-row justify-between gap-4 items-center\">\r\n                    <div className=\"flex flex-wrap bg-black/40 p-1 rounded-lg border border-white/10 items-center gap-2\">\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => setViewStats(false)}\r\n                            className={!viewStats ? \"bg-emerald-500/20 text-emerald-500\" : \"text-muted-foreground hover:text-white\"}\r\n                        >\r\n                            Daily View\r\n                        </Button>\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => setViewStats(true)}\r\n                            className={viewStats ? \"bg-blue-500/20 text-blue-500\" : \"text-muted-foreground hover:text-white\"}\r\n                        >\r\n                            Overall Stats\r\n                        </Button>\r\n\r\n                        {viewStats && (\r\n                            <>\r\n                                <Select value={statsMonth} onValueChange={setStatsMonth}>\r\n                                    <SelectTrigger className=\"w-[140px] h-8 bg-transparent border-white/10 text-xs\">\r\n                                        <SelectValue placeholder=\"Period\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent className=\"bg-slate-900 border-white/10\">\r\n                                        <SelectItem value=\"ALL\">Full Year {new Date().getFullYear()}</SelectItem>\r\n                                        <SelectItem value=\"01\">January</SelectItem>\r\n                                        <SelectItem value=\"02\">February</SelectItem>\r\n                                        <SelectItem value=\"03\">March</SelectItem>\r\n                                        <SelectItem value=\"04\">April</SelectItem>\r\n                                        <SelectItem value=\"05\">May</SelectItem>\r\n                                        <SelectItem value=\"06\">June</SelectItem>\r\n                                        <SelectItem value=\"07\">July</SelectItem>\r\n                                        <SelectItem value=\"08\">August</SelectItem>\r\n                                        <SelectItem value=\"09\">September</SelectItem>\r\n                                        <SelectItem value=\"10\">October</SelectItem>\r\n                                        <SelectItem value=\"11\">November</SelectItem>\r\n                                        <SelectItem value=\"12\">December</SelectItem>\r\n                                    </SelectContent>\r\n                                </Select>\r\n\r\n                                <Button\r\n                                    size=\"sm\"\r\n                                    variant=\"outline\"\r\n                                    className=\"h-8 border-white/10 hover:bg-white/5 gap-2 px-3\"\r\n                                    onClick={handlePrint}\r\n                                >\r\n                                    <Printer className=\"w-3 h-3\" /> Print Report\r\n                                </Button>\r\n                            </>\r\n                        )}\r\n                    </div>\r\n\r\n                    {!viewStats && (\r\n                        <div className=\"relative flex-1 w-full md:max-w-xs\">\r\n                            <Search className=\"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground\" />\r\n                            <Input\r\n                                placeholder=\"Search teachers...\"\r\n                                value={searchQuery}\r\n                                onChange={(e) => setSearchQuery(e.target.value)}\r\n                                className=\"pl-8 bg-black/40 border-white/10 w-full\"\r\n                            />\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <CardContent className=\"p-0\">\r\n                    <DataTable\r\n                        data={viewStats ? statsData : filteredTeachers}\r\n                        isLoading={loading}\r\n                        columns={viewStats ? [\r\n                            {\r\n                                key: \"index\",\r\n                                header: \"#\",\r\n                                render: (_: any, idx?: number) => <span className=\"font-mono text-sm\">{(idx ?? 0) + 1}</span>\r\n                            },\r\n                            {\r\n                                key: \"name\",\r\n                                header: \"Teacher Name\",\r\n                                render: (s: any) => (\r\n                                    <div>\r\n                                        <div className=\"font-medium text-white\">{s.name}</div>\r\n                                        <div className=\"text-[10px] text-white/40 uppercase\">{s.schoolId}</div>\r\n                                    </div>\r\n                                )\r\n                            },\r\n                            {\r\n                                key: \"totalDays\",\r\n                                header: \"Total\",\r\n                                cellClassName: \"text-center\",\r\n                                render: (s: any) => <span className=\"font-mono\">{s.totalDays}</span>\r\n                            },\r\n                            {\r\n                                key: \"presentDays\",\r\n                                header: \"Present\",\r\n                                cellClassName: \"text-center\",\r\n                                render: (s: any) => <span className=\"font-bold text-emerald-400\">{s.presentDays}</span>\r\n                            },\r\n                            {\r\n                                key: \"percentage\",\r\n                                header: \"Attendance %\",\r\n                                cellClassName: \"text-center\",\r\n                                render: (s: any) => (\r\n                                    <div className=\"flex flex-col items-center min-w-[80px]\">\r\n                                        <span className={`font-bold ${Number(s.percentage) < 80 ? \"text-red-400\" : \"text-emerald-400\"}`}>\r\n                                            {s.percentage}%\r\n                                        </span>\r\n                                        <div className=\"w-full h-1 bg-white/10 rounded-full mt-1 overflow-hidden max-w-[60px]\">\r\n                                            <div\r\n                                                className={`h-full ${Number(s.percentage) < 80 ? \"bg-red-500\" : \"bg-emerald-500\"}`}\r\n                                                style={{ width: `${s.percentage}%` }}\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                )\r\n                            },\r\n                            {\r\n                                key: \"leaves\",\r\n                                header: \"Leaves\",\r\n                                cellClassName: \"text-right\",\r\n                                render: (s: any) => <span className=\"text-white/40\">{(s.totalDays - s.presentDays)}</span>\r\n                            }\r\n                        ] : [\r\n                            {\r\n                                key: \"index\",\r\n                                header: \"#\",\r\n                                render: (_: any, idx?: number) => <span className=\"font-mono text-sm\">{(idx ?? 0) + 1}</span>\r\n                            },\r\n                            {\r\n                                key: \"name\",\r\n                                header: \"Teacher Name\",\r\n                                render: (t: any) => {\r\n                                    const isOnLeave = leavesMap[t.schoolId];\r\n                                    return (\r\n                                        <div>\r\n                                            <div className=\"font-medium flex items-center gap-2 text-white\">\r\n                                                {t.name}\r\n                                                {isOnLeave && (\r\n                                                    <Badge variant=\"outline\" className=\"text-[8px] md:text-[10px] border-yellow-500/50 text-yellow-500 bg-yellow-500/10 gap-1 px-1 py-0 uppercase font-black\">\r\n                                                        <UserX className=\"w-3 h-3\" /> Leave\r\n                                                    </Badge>\r\n                                                )}\r\n                                            </div>\r\n                                            <div className=\"text-[10px] text-white/40 uppercase\">{t.schoolId}</div>\r\n                                        </div>\r\n                                    );\r\n                                }\r\n                            },\r\n                            {\r\n                                key: \"attendanceStatus\",\r\n                                header: \"Status\",\r\n                                cellClassName: \"text-center\",\r\n                                render: (t: any) => {\r\n                                    const status = attendance[t.schoolId];\r\n                                    return (\r\n                                        <Badge className={cn(\r\n                                            \"font-black uppercase tracking-tighter text-[9px]\",\r\n                                            status === 'P' ? \"bg-emerald-500/10 text-emerald-500 border border-emerald-500/20\" : \"bg-red-500/10 text-red-500 border border-red-500/20\"\r\n                                        )}>\r\n                                            {status === 'P' ? \"Present\" : \"Absent\"}\r\n                                        </Badge>\r\n                                    );\r\n                                }\r\n                            },\r\n                            {\r\n                                key: \"action\",\r\n                                header: \"Action\",\r\n                                cellClassName: \"text-right\",\r\n                                render: (t: any) => {\r\n                                    const status = attendance[t.schoolId];\r\n                                    return (\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            variant=\"ghost\"\r\n                                            className={cn(\r\n                                                \"h-8 text-[10px] font-black uppercase tracking-tighter px-3 rounded-lg\",\r\n                                                status === 'P'\r\n                                                    ? \"bg-red-500/10 text-red-400 hover:bg-red-500 hover:text-white\"\r\n                                                    : \"bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500 hover:text-white\"\r\n                                            )}\r\n                                            onClick={() => toggleStatus(t.schoolId)}\r\n                                        >\r\n                                            {status === 'P' ? \"Mark Absent\" : \"Mark Present\"}\r\n                                        </Button>\r\n                                    );\r\n                                }\r\n                            }\r\n                        ]}\r\n                    />\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {!viewStats && (\r\n                <div className=\"flex justify-between items-center bg-white/5 p-4 rounded-lg border border-white/10\">\r\n                    <div className=\"text-sm text-muted-foreground\">\r\n                        {alreadyMarked\r\n                            ? (isModified ? \"You have unsaved changes.\" : `Attendance already marked by ${user?.uid === \"admin\" ? \"Admin\" : \"System\"}`)\r\n                            : \"Ready to submit.\"\r\n                        }\r\n                    </div>\r\n                    <Button\r\n                        size=\"lg\"\r\n                        onClick={handleSubmit}\r\n                        disabled={submitting || (alreadyMarked && !isModified)}\r\n                        className=\"bg-emerald-600 hover:bg-emerald-700 text-white min-w-[200px]\"\r\n                    >\r\n                        {submitting ? <Loader2 className=\"w-5 h-5 animate-spin mr-2\" /> : <Save className=\"w-5 h-5 mr-2\" />}\r\n                        {alreadyMarked ? \"Update Attendance\" : \"Submit Attendance\"}\r\n                    </Button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","\r\n\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useMasterData } from \"@/context/MasterDataContext\";\r\nimport AttendanceManager from \"@/components/attendance/attendance-manager\";\r\nimport TeacherAttendanceManager from \"@/components/attendance/teacher-attendance-manager\";\r\nimport StaffAttendanceManager from \"@/components/attendance/staff-attendance-manager\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { Card } from \"@/components/ui/card\";\r\nimport { DatePickerInput } from \"@/components/ui/date-picker-input\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\n\r\nexport default function AdminAttendancePage() {\r\n    const { classes, classSections, sections } = useMasterData();\r\n    const [selectedClass, setSelectedClass] = useState<string>(\"\");\r\n    const [selectedSection, setSelectedSection] = useState<string>(\"\");\r\n    const [date, setDate] = useState(new Date().toISOString().split('T')[0]);\r\n\r\n    const fetchedSections = selectedClass\r\n        ? Object.values(classSections || {})\r\n            .filter((cs: any) => cs.classId === selectedClass)\r\n            .map((cs: any) => sections[cs.sectionId])\r\n            .filter(Boolean)\r\n        : [];\r\n\r\n    return (\r\n        <div className=\"max-w-none p-0 space-y-6 animate-in fade-in\">\r\n            <div className=\"flex flex-col md:flex-row items-center justify-between gap-4 border-b border-white/10 pb-6\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-display font-bold\">Attendance Management</h1>\r\n                    <p className=\"text-muted-foreground\">Mark or modify attendance for students and teachers.</p>\r\n                </div>\r\n                <div className=\"w-full md:w-48 space-y-2\">\r\n                    <label className=\"text-xs text-muted-foreground uppercase font-medium\">Select Date</label>\r\n                    <div className=\"relative\">\r\n                        <input\r\n                            type=\"date\"\r\n                            value={date}\r\n                            onChange={(e) => setDate(e.target.value)}\r\n                            className=\"bg-white/5 border border-white/10 rounded-md py-2 px-3 w-full text-white focus:outline-none focus:ring-1 focus:ring-emerald-500/50\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <Tabs defaultValue=\"student\" className=\"w-full\">\r\n                <TabsList className=\"flex flex-wrap h-auto w-full md:grid md:grid-cols-3 md:w-full max-w-[600px] mb-6 bg-black/40 border border-white/10 gap-2 p-1\">\r\n                    <TabsTrigger value=\"student\" className=\"flex-1 min-w-[140px]\">Student Attendance</TabsTrigger>\r\n                    <TabsTrigger value=\"teacher\" className=\"flex-1 min-w-[140px]\">Teacher Attendance</TabsTrigger>\r\n                    <TabsTrigger value=\"staff\" className=\"flex-1 min-w-[140px]\">Staff Attendance</TabsTrigger>\r\n                </TabsList>\r\n\r\n                <TabsContent value=\"student\" className=\"space-y-6\">\r\n                    <Card className=\"bg-black/20 border-white/10 p-4\">\r\n                        <div className=\"flex flex-col md:flex-row gap-4 items-end\">\r\n                            <div className=\"space-y-2 w-full md:w-48\">\r\n                                <label className=\"text-xs text-muted-foreground uppercase\">Class</label>\r\n                                <Select value={selectedClass} onValueChange={(val) => { setSelectedClass(val); setSelectedSection(\"\"); }}>\r\n                                    <SelectTrigger className=\"bg-white/5 border-white/10\">\r\n                                        <SelectValue placeholder=\"Select Class\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        {Object.values(classes).map((c: any) => (\r\n                                            <SelectItem key={c.id} value={c.id}>{c.name}</SelectItem>\r\n                                        ))}\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2 w-full md:w-32\">\r\n                                <label className=\"text-xs text-muted-foreground uppercase\">Section</label>\r\n                                <Select\r\n                                    value={selectedSection}\r\n                                    onValueChange={setSelectedSection}\r\n                                    disabled={!selectedClass}\r\n                                >\r\n                                    <SelectTrigger className=\"bg-white/5 border-white/10\">\r\n                                        <SelectValue placeholder=\"Sec\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        {fetchedSections.map((sec: any) => (\r\n                                            <SelectItem key={sec.id} value={sec.id}>{sec.name}</SelectItem>\r\n                                        ))}\r\n                                    </SelectContent>\r\n                                </Select>\r\n                                {selectedClass && fetchedSections.length === 0 && (\r\n                                    <p className=\"text-[10px] text-red-400\">No sections linked.</p>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </Card>\r\n\r\n                    {selectedClass && selectedSection ? (\r\n                        <div key={`${selectedClass}-${selectedSection}-${date}`}>\r\n                            <AttendanceManager\r\n                                classId={selectedClass}\r\n                                sectionId={selectedSection}\r\n                                defaultDate={date}\r\n                            />\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex flex-col items-center justify-center p-20 border border-dashed border-white/10 rounded-xl bg-white/5\">\r\n                            <p className=\"text-muted-foreground\">Please select Class and Section to view student attendance.</p>\r\n                        </div>\r\n                    )}\r\n                </TabsContent>\r\n\r\n                <TabsContent value=\"teacher\">\r\n                    <TeacherAttendanceManager defaultDate={date} />\r\n                </TabsContent>\r\n\r\n                <TabsContent value=\"staff\">\r\n                    <StaffAttendanceManager defaultDate={date} />\r\n                </TabsContent>\r\n            </Tabs>\r\n        </div>\r\n    );\r\n}\r\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2', key: '1yyitq' }],\n  ['circle', { cx: '9', cy: '7', r: '4', key: 'nufk8' }],\n  ['line', { x1: '17', x2: '22', y1: '8', y2: '13', key: '3nzzx3' }],\n  ['line', { x1: '22', x2: '17', y1: '8', y2: '13', key: '1swrse' }],\n];\n\n/**\n * @component @name UserX\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgMjF2LTJhNCA0IDAgMCAwLTQtNEg2YTQgNCAwIDAgMC00IDR2MiIgLz4KICA8Y2lyY2xlIGN4PSI5IiBjeT0iNyIgcj0iNCIgLz4KICA8bGluZSB4MT0iMTciIHgyPSIyMiIgeTE9IjgiIHkyPSIxMyIgLz4KICA8bGluZSB4MT0iMjIiIHgyPSIxNyIgeTE9IjgiIHkyPSIxMyIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/user-x\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst UserX = createLucideIcon('user-x', __iconNode);\n\nexport default UserX;\n"],"names":[],"mappings":"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","ignoreList":[3]}