module.exports=[99570,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(11011),e=a.i(68114);let f=c.forwardRef(({className:a,variant:c="default",size:f="default",asChild:g=!1,...h},i)=>{let j=g?d.Slot:"button";return(0,b.jsx)(j,{className:(0,e.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-full text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 tracking-wide",{"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:scale-105 active:scale-95 transition-transform":"default"===c,"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm":"destructive"===c,"border border-white/20 bg-transparent hover:bg-white/10 hover:text-accent-foreground":"outline"===c,"bg-secondary text-secondary-foreground hover:bg-secondary/80":"secondary"===c,"hover:bg-white/10 hover:text-accent font-normal":"ghost"===c,"text-primary underline-offset-4 hover:underline":"link"===c,"bg-gradient-to-r from-accent to-accent/80 text-black font-bold hover:brightness-110 border-0 shadow-lg hover:shadow-accent/20":"gradient"===c,"bg-accent text-black font-bold hover:bg-accent/90 hover:scale-105 active:scale-95 transition-transform shadow-lg":"spotify"===c,"h-10 px-6 py-2":"default"===f,"h-9 px-4 text-xs":"sm"===f,"h-12 px-8 text-base":"lg"===f,"h-14 px-10 text-lg":"xl"===f,"h-10 w-10":"icon"===f},a),ref:i,...h})});f.displayName="Button",a.s(["Button",()=>f])},91119,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-2xl border border-[#64FFDA]/10 bg-[#112240]/40 backdrop-blur-lg text-white shadow-xl transition-all duration-300 hover:bg-[#112240]/60 hover:border-[#64FFDA]/30 hover:shadow-[0_0_20px_-5px_rgba(100,255,218,0.1)] group",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("font-bold text-xl tracking-tight text-white group-hover:text-accent transition-colors",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-white/60 font-medium",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},71931,a=>{"use strict";let b=(0,a.i(70106).default)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);a.s(["Printer",()=>b],71931)},60246,a=>{"use strict";let b=(0,a.i(70106).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);a.s(["Users",()=>b],60246)},44194,a=>{"use strict";let b=(0,a.i(70106).default)("coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);a.s(["Coffee",()=>b],44194)},80929,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(56025),e=a.i(91119),f=a.i(99570),g=a.i(86304),h=a.i(96221),i=a.i(60246),j=a.i(44194),k=a.i(71931);a.i(69387);var l=a.i(60574),m=a.i(20237),n=a.i(91410);function o(){let{user:a}=(0,d.useAuth)(),{subjects:o,classes:p,sections:q}=(0,n.useMasterData)(),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)({}),[D,E]=(0,c.useState)([]);(0,c.useEffect)(()=>{a&&(H(),G(),F())},[a]);let F=async()=>{try{let a=(0,l.query)((0,l.collection)(m.db,"notices"),(0,l.where)("type","==","HOLIDAY")),b=await (0,l.getDocs)(a);E(b.docs.map(a=>({id:a.id,...a.data()})))}catch(a){console.error(a)}},G=async()=>{try{let a=(0,l.query)((0,l.collection)(m.db,"teachers")),b=await (0,l.getDocs)(a),c={};b.docs.forEach(a=>{let b=a.data();b.schoolId&&(c[b.schoolId]=b.name),c[a.id]=b.name}),C(c)}catch(a){console.error("Error fetching teachers:",a)}},H=async()=>{try{let b=await fetch("/api/timetable/my-schedule",{headers:{Authorization:`Bearer ${await a?.getIdToken()}`}}),c=await b.json();c.success&&(s(c.data.weeklySchedule||{}),u(c.data.substitutions||[]),y(c.data.classId),A(c.data.sectionId))}catch(a){console.error(a)}finally{w(!1)}},I=a=>D.some(b=>{let c=b.date?.seconds?new Date(1e3*b.date.seconds):b.createdAt?.seconds?new Date(1e3*b.createdAt.seconds):new Date,d=b.expiresAt?.seconds?new Date(1e3*b.expiresAt.seconds):new Date;return c.setHours(0,0,0,0),d.setHours(23,59,59,999),a>=c&&a<=d}),J=(()=>{let a=new Date,b=a.toLocaleDateString("en-US",{weekday:"long"}).toUpperCase(),c=new Date,d=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`;if(I(a))return{dayName:b,dateKey:d,slots:[],isHoliday:!0};if(!r||!r[b])return{dayName:b,slots:[]};let e=[],f=r[b]||{};for(let a=1;a<=8;a++){let b=f[a];if(!b)continue;let c=t.find(b=>b.date===d&&b.slotId===a);e.push({id:a,...b,substitution:c})}return{dayName:b,dateKey:d,slots:e,isHoliday:!1}})();return v?(0,b.jsx)("div",{className:"p-10 flex justify-center",children:(0,b.jsx)(h.Loader2,{className:"animate-spin"})}):(0,b.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto p-4 md:p-6 animate-in fade-in",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-display font-bold",children:"My Timetable"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:[p[x]?.name||`Class ${x}`,z&&q&&q[z]?` (${q[z].name})`:""]})]}),(0,b.jsxs)(f.Button,{onClick:()=>window.print(),variant:"outline",className:"gap-2 print:hidden bg-white/5 border-white/10 hover:bg-white/10 hover:text-white",children:[(0,b.jsx)(k.Printer,{className:"w-4 h-4"})," Print Timetable"]})]}),(0,b.jsxs)(e.Card,{className:`print:hidden overflow-hidden relative border-white/10 ${J.isHoliday?"bg-red-500/10 border-red-500/20":"bg-black/20"}`,children:[(0,b.jsx)("div",{className:`absolute top-0 left-0 w-1 h-full ${J.isHoliday?"bg-red-500":"bg-emerald-500"}`}),(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)(e.CardTitle,{className:"flex justify-between items-center",children:[(0,b.jsxs)("span",{children:["Today (",J.dayName,")"]}),(0,b.jsx)("span",{className:"text-sm font-normal text-muted-foreground",children:J.dateKey})]})}),(0,b.jsx)(e.CardContent,{children:J.isHoliday?(0,b.jsxs)("div",{className:"py-12 flex flex-col items-center justify-center text-red-400 gap-4",children:[(0,b.jsx)(j.Coffee,{className:"w-12 h-12 opacity-50"}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h3",{className:"text-2xl font-bold uppercase tracking-widest",children:"Holiday"}),(0,b.jsx)("p",{className:"text-sm text-red-400/60 mt-1",children:"School is closed for today. Enjoy your break!"})]})]}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:0===J.slots.length?(0,b.jsx)("p",{className:"text-muted-foreground",children:"No classes scheduled for today."}):J.slots.map(a=>{let c=!!a.substitution,d=c&&"LEISURE"===a.substitution.resolutionType,e=d||"leisure"===a.subjectId?"leisure":a.subjectId,f=o[e]?.name||e;return(0,b.jsxs)("div",{className:`p-4 rounded-lg border flex flex-col gap-2 ${c?"bg-yellow-500/10 border-yellow-500/30":"bg-white/5 border-white/10"}`,children:[(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("span",{className:"text-xs font-bold text-muted-foreground",children:["Period ",a.id]}),c&&(0,b.jsx)(g.Badge,{variant:"outline",className:"text-[10px] bg-yellow-500/20 text-yellow-500 border-yellow-500/50",children:"Changed"})]}),(0,b.jsx)("div",{className:"font-bold text-lg truncate",children:d||"leisure"===e?(0,b.jsxs)("span",{className:"flex items-center gap-2 text-emerald-400 font-medium",children:[(0,b.jsx)(j.Coffee,{className:"w-5 h-5"})," Free Period"]}):(0,b.jsx)("span",{className:"capitalize",children:f})}),!d&&"leisure"!==e&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(i.Users,{className:"w-3 h-3"}),(0,b.jsx)("span",{className:"truncate",children:c&&a.substitution.substituteTeacherId?B[a.substitution.substituteTeacherId]||a.substitution.substituteTeacherId:B[a.teacherId]||a.teacherId||"No Teacher"})]})]},a.id)})})})]}),(0,b.jsxs)(e.Card,{className:"bg-black/20 border-white/10",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Weekly Schedule"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-white/10",children:[(0,b.jsx)("th",{className:"p-3 text-left",children:"Day"}),[1,2,3,4,5,6,7,8].map(a=>(0,b.jsxs)("th",{className:"p-3 text-center",children:["P",a]},a))]})}),(0,b.jsx)("tbody",{children:["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"].map((a,c)=>{let d=new Date,e=d.getDay(),f=new Date(d);f.setDate(d.getDate()+(c+1-e));let g=I(f);return(0,b.jsxs)("tr",{className:`border-b border-white/5 transition-colors ${g?"bg-red-500/5":"hover:bg-white/5"}`,children:[(0,b.jsxs)("td",{className:"p-3 font-medium text-muted-foreground flex flex-col",children:[(0,b.jsx)("span",{children:a.substring(0,3)}),(0,b.jsx)("span",{className:"text-[10px] opacity-40 font-normal",children:f.toLocaleDateString([],{month:"short",day:"numeric"})})]}),g?(0,b.jsx)("td",{colSpan:8,className:"p-3 text-center text-red-400/80 font-bold uppercase tracking-widest text-[10px]",children:"Holiday"}):[1,2,3,4,5,6,7,8].map(c=>{let d=`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}-${String(f.getDate()).padStart(2,"0")}`,e=t.find(a=>a.date===d&&a.slotId===c),g=r?.[a]?.[c];if(e){let a="LEISURE"===e.resolutionType;return(0,b.jsxs)("td",{className:"p-3 text-center border-l border-white/5 bg-yellow-500/10",children:[(0,b.jsx)("div",{className:"font-semibold text-yellow-500",children:a?"Free Period":o[g?.subjectId]?.name||g?.subjectId}),!a&&(0,b.jsx)("div",{className:"text-[10px] text-yellow-500/60 font-medium",children:B[e.substituteTeacherId]||e.substituteTeacherId})]},c)}return g?"BREAK"===g.type?(0,b.jsx)("td",{className:"p-3 bg-white/5 text-center text-[10px] diagonal-stripe opacity-50"},c):(0,b.jsxs)("td",{className:"p-3 text-center border-l border-white/5",children:[(0,b.jsx)("div",{className:"font-semibold",children:"leisure"===g.subjectId?"Leisure":o[g.subjectId]?.name||g.subjectId}),(0,b.jsx)("div",{className:"text-[10px] text-muted-foreground",children:B[g.teacherId]||g.teacherId})]},c):(0,b.jsx)("td",{className:"p-3"},c)})]},a)})})]})})})]})]})}a.s(["default",()=>o])}];

//# sourceMappingURL=_cbb8d388._.js.map