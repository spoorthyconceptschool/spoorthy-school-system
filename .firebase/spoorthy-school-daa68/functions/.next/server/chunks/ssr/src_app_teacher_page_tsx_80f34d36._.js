module.exports=[78330,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(56025),e=a.i(91119),f=a.i(99570),g=a.i(86304),h=a.i(15618),i=a.i(41710),j=a.i(73570),k=a.i(4720),l=a.i(50522),m=a.i(69769),n=a.i(38246);a.i(69387);var o=a.i(60574),p=a.i(20237),q=a.i(91410),r=a.i(27960);function s(){let{user:s}=(0,d.useAuth)(),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)([]),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(!0),{classSections:L,classes:M,sections:N,classSubjects:O,subjects:P,homeworkSubjects:Q}=(0,q.useMasterData)();(0,c.useEffect)(()=>{s&&R()},[s]);let R=async()=>{try{let a=await s?.getIdToken(),b=new Date,c=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}-${String(b.getDate()).padStart(2,"0")}`;if(!s?.uid)return;let[d,e,f]=await Promise.all([fetch("/api/timetable/my-schedule",{headers:{Authorization:`Bearer ${a}`}}).then(a=>a.json()),(0,o.getDocs)((0,o.query)((0,o.collection)(p.db,"teachers"),(0,o.where)("uid","==",s.uid),(0,o.limit)(1))),(0,o.getDocs)((0,o.query)((0,o.collection)(p.db,"leave_requests"),(0,o.where)("teacherId","==",s.uid),(0,o.orderBy)("createdAt","desc"),(0,o.limit)(2))).catch(a=>({docs:[]}))]);if(!e.empty){let a=e.docs[0].data();I({id:e.docs[0].id,...a})}if(d.success){u(d.data);let a=new Date().toLocaleDateString("en-US",{weekday:"long"}).toUpperCase(),b=d.data.weeklySchedule?.[a]||{},e=d.data.substitutions||[],f=[];for(let a=1;a<=8;a++){let d=e.find(b=>b.date===c&&b.slotId===a&&"ORIGINAL"===b.role),g=e.find(b=>b.date===c&&b.slotId===a&&"SUBSTITUTE"===b.role);g?f.push({id:a,type:"SUBSTITUTION",classId:g.classId,note:"Sub Assigned"}):d?f.push({id:a,type:"LEAVE",classId:"object"==typeof b[a]?b[a].classId:b[a]}):b[a]&&f.push({id:a,type:"REGULAR",classId:"object"==typeof b[a]?b[a].classId:b[a],subjectId:"object"==typeof b[a]?b[a].subjectId:null})}w(f),A(e.filter(a=>a.date===c&&"SUBSTITUTE"===a.role)),G(e.filter(a=>"SUBSTITUTE"===a.role&&a.date>c).sort((a,b)=>a.date.localeCompare(b.date)))}f.docs&&C(f.docs.map(a=>({id:a.id,...a.data()})));let g=(0,o.query)((0,o.collection)(p.db,"notices"),(0,o.where)("type","==","HOLIDAY"),(0,o.limit)(3)),h=await (0,o.getDocs)(g).catch(a=>({docs:[]}));h.docs&&E(h.docs.map(a=>({id:a.id,...a.data()}))),y([])}catch(a){console.error(a)}finally{K(!1)}},S=async(b,c,d)=>{try{let{ref:e,set:f}=await a.A(47273),{rtdb:g}=await a.A(9555),h=e(g,`master/homeworkSubjects/${b}/${c}`);await f(h,!d)}catch(a){console.error("Failed to toggle homework subject",a)}},T=(()=>{if(!H)return[];let a=H.schoolId||H.id;return Object.values(L).filter(b=>b.active&&b.classTeacherId===a)})();return(0,b.jsxs)("div",{className:"p-4 md:p-6 space-y-6 animate-in fade-in max-w-7xl mx-auto pb-16",children:[(0,b.jsx)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"font-display text-3xl md:text-5xl font-bold tracking-tight",children:"Teacher Dashboard"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1 text-sm md:text-lg italic uppercase tracking-widest opacity-70",children:H?.name?`Welcome back, ${H.name.split(" ")[0]}`:"Classroom Control"})]})}),T.length>0&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-1.5 h-6 md:w-2 md:h-8 bg-amber-500 rounded-full"}),(0,b.jsx)("h2",{className:"text-lg md:text-2xl font-display font-black text-white uppercase tracking-wider",children:"Class Teacher Desk"}),(0,b.jsx)(g.Badge,{variant:"outline",className:"border-amber-500/30 text-amber-500 bg-amber-500/10 uppercase text-[9px] md:text-[10px] tracking-widest px-2 md:px-3 py-1",children:"Action Required"})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:T.map(a=>{let c=M[a.classId]?.name||a.classId,d=N[a.sectionId]?.name||a.sectionId,f=a.id,h=Object.keys(O[a.classId]||{}).filter(b=>O[a.classId][b]&&P[b]);return(0,b.jsxs)(e.Card,{className:"bg-black/40 border-amber-500/20 backdrop-blur-md overflow-hidden animate-in slide-in-from-top duration-500",children:[(0,b.jsxs)("div",{className:"bg-amber-500/5 border-b border-amber-500/10 p-3 md:p-4 flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-base md:text-lg font-bold flex items-center gap-2 text-white",children:[(0,b.jsx)(m.GraduationCap,{className:"w-4 h-4 md:w-5 md:h-5 text-amber-500"}),c," - ",d]}),(0,b.jsx)("p",{className:"text-[10px] md:text-xs text-amber-500/60 font-medium tracking-tight",children:"Daily homework control"})]}),(0,b.jsx)(g.Badge,{className:"bg-amber-500 text-black font-black uppercase text-[8px] md:text-[9px] tracking-widest shrink-0",children:"Class Teacher"})]}),(0,b.jsx)(e.CardContent,{className:"p-3 md:p-4 space-y-4",children:(0,b.jsx)("div",{className:"space-y-2",children:(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:h.length>0?h.map(a=>{let c=Q[f]?.[a];return(0,b.jsxs)("div",{onClick:()=>S(f,a,c),className:`flex items-center justify-between p-2 rounded-xl border cursor-pointer transition-all group ${c?"bg-[#10B981]/10 border-[#10B981]/30":"bg-white/5 border-white/10 opacity-60 hover:opacity-100"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:`p-1.5 rounded-lg ${c?"bg-[#10B981]/20 text-[#10B981]":"bg-white/5 text-white/20"}`,children:(0,b.jsx)(k.FileText,{className:"w-3 h-3"})}),(0,b.jsx)("span",{className:"font-bold text-xs text-white/90",children:P[a]?.name})]}),c&&(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-[#10B981] animate-pulse shadow-[0_0_8px_#10B981]"})]},a)}):(0,b.jsx)("div",{className:"col-span-full py-4 text-center text-white/20 text-[10px] uppercase font-bold border border-dashed border-white/10 rounded-xl",children:"No subjects assigned to this class"})})})})]},a.id)})})]}),(z.length>0||F.length>0)&&(0,b.jsxs)("div",{className:"bg-blue-500/10 border border-blue-500/30 p-4 rounded-xl flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(j.AlertTriangle,{className:"text-blue-400 w-5 h-5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-bold text-blue-400",children:z.length>0?"Substitution Assigned for Today":"Upcoming Substitution Assigned"}),(0,b.jsx)("p",{className:"text-sm text-blue-400/80",children:z.length>0?`You have ${z.length} substitution class(es) assigned today.`:`You have ${F.length} coverage assignment(s) coming up this week.`})]})]}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",className:"border-blue-500/30 text-blue-400 hover:bg-blue-400/10",asChild:!0,children:(0,b.jsx)(n.default,{href:"/teacher/timetable",children:"View My Schedule"})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)(e.Card,{className:"bg-black/20 border-white/10 h-fit",children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Clock,{className:"w-5 h-5 text-emerald-500"})," Today's Schedule"]}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",className:"text-muted-foreground",asChild:!0,children:(0,b.jsxs)(n.default,{href:"/teacher/timetable",children:["Full Timetable ",(0,b.jsx)(l.ChevronRight,{className:"w-4 h-4"})]})})]}),(0,b.jsx)(e.CardContent,{children:J?(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,b.jsx)(r.Skeleton,{className:"h-24 w-full rounded-lg"}),(0,b.jsx)(r.Skeleton,{className:"h-24 w-full rounded-lg"}),(0,b.jsx)(r.Skeleton,{className:"h-24 w-full rounded-lg"}),(0,b.jsx)(r.Skeleton,{className:"h-24 w-full rounded-lg"})]}):0===v.length?(0,b.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:"No classes scheduled for today."}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:v.map(a=>(0,b.jsxs)("div",{className:`p-4 rounded-lg flex items-center justify-between
                                                ${"SUBSTITUTION"===a.type?"bg-yellow-500/10 border border-yellow-500/20":"LEAVE"===a.type?"bg-red-500/5 border border-red-500/10 opacity-50":"bg-white/5 border border-white/10"}
                                            `,children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(g.Badge,{variant:"outline",className:"h-8 w-8 flex items-center justify-center rounded-full bg-white/5 border-white/10",children:a.id}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"font-bold text-lg",children:["Class ",a.classId]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"SUBSTITUTION"===a.type?"Substitution":P[a.subjectId]?.name||a.subjectId||"Regular Class"})]})]}),"SUBSTITUTION"===a.type&&(0,b.jsx)(g.Badge,{className:"bg-yellow-500 text-black",children:"SUB"}),"LEAVE"===a.type&&(0,b.jsx)(g.Badge,{variant:"destructive",className:"scale-75",children:"LEAVE"})]},a.id))})})]}),F.length>0&&(0,b.jsxs)(e.Card,{className:"bg-blue-600/5 border-blue-500/20",children:[(0,b.jsxs)(e.CardHeader,{className:"py-4",children:[(0,b.jsxs)(e.CardTitle,{className:"text-lg flex items-center gap-2 text-blue-400",children:[(0,b.jsx)(j.AlertTriangle,{className:"w-5 h-5"})," Upcoming Coverage"]}),(0,b.jsx)(e.CardDescription,{className:"text-blue-300/60",children:"Coverage assignments for the coming days."})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[F.slice(0,3).map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-500/5 rounded-lg border border-blue-500/10",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"bg-blue-500/20 px-2 py-1 rounded text-[10px] font-bold text-blue-400 uppercase",children:new Date(a.date).toLocaleDateString([],{weekday:"short",day:"numeric",month:"short"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"font-bold text-sm text-white/90",children:["Class ",a.classId]}),(0,b.jsxs)("div",{className:"text-[10px] text-muted-foreground",children:["Period ",a.slotId," â€¢ Covering for ",a.originalTeacherId]})]})]}),(0,b.jsx)(g.Badge,{variant:"outline",className:"text-[10px] border-blue-500/30 text-blue-400",children:"ASSIGNED"})]},c)),F.length>3&&(0,b.jsxs)("p",{className:"text-[10px] text-center text-muted-foreground italic",children:["And ",F.length-3," more assigned classes..."]})]})})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsx)(f.Button,{className:"h-24 flex flex-col gap-2 bg-emerald-600 hover:bg-emerald-700",asChild:!0,children:(0,b.jsxs)(n.default,{href:"/teacher/homework",children:[(0,b.jsx)(h.Plus,{className:"w-6 h-6"}),(0,b.jsx)("span",{children:"Post Homework"})]})}),(0,b.jsx)(f.Button,{className:"h-24 flex flex-col gap-2 bg-blue-600 hover:bg-blue-700",asChild:!0,children:(0,b.jsxs)(n.default,{href:"/teacher/notices",children:[(0,b.jsx)(k.FileText,{className:"w-6 h-6"}),(0,b.jsx)("span",{children:"Send Notice"})]})}),(0,b.jsx)(f.Button,{className:"h-24 flex flex-col gap-2 bg-purple-600 hover:bg-purple-700 col-span-2",asChild:!0,children:(0,b.jsxs)(n.default,{href:"/teacher/exams",children:[(0,b.jsx)(k.FileText,{className:"w-6 h-6"}),(0,b.jsx)("span",{children:"Examinations & Results"})]})})]}),(0,b.jsxs)(e.Card,{className:"bg-black/20 border-white/10",children:[(0,b.jsxs)(e.CardHeader,{className:"py-4 flex flex-row items-center justify-between",children:[(0,b.jsx)(e.CardTitle,{className:"text-base",children:"Student Absences"}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsx)(n.default,{href:"/teacher/leaves",children:(0,b.jsx)(l.ChevronRight,{className:"w-4 h-4"})})})]}),(0,b.jsxs)(e.CardContent,{className:"py-2",children:[(0,b.jsx)("p",{className:"text-[10px] text-muted-foreground mb-2",children:"Recent/Pending leaves in your class."}),(0,b.jsx)(f.Button,{variant:"outline",className:"w-full text-xs h-8 border-white/5",asChild:!0,children:(0,b.jsx)(n.default,{href:"/teacher/leaves",children:"View Student Leaves"})})]})]}),(0,b.jsxs)(e.Card,{className:"bg-black/20 border-white/10",children:[(0,b.jsx)(e.CardHeader,{className:"py-4",children:(0,b.jsx)(e.CardTitle,{className:"text-base line-clamp-1",children:"My Leave Status"})}),(0,b.jsxs)(e.CardContent,{className:"py-2 space-y-3",children:[0===B.length?(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"No recent requests."}):B.map(a=>(0,b.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium text-xs",children:a.fromDate}),(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground",children:a.type})]}),(0,b.jsx)(g.Badge,{variant:"APPROVED"===a.status?"default":"REJECTED"===a.status?"destructive":"secondary",className:"text-[10px]",children:a.status})]},a.id)),(0,b.jsx)(f.Button,{variant:"outline",className:"w-full text-xs mt-2",asChild:!0,children:(0,b.jsx)(n.default,{href:"/teacher/leaves",children:"Request Leave"})})]})]}),(0,b.jsxs)(e.Card,{className:"bg-emerald-900/10 border-emerald-500/20",children:[(0,b.jsx)(e.CardHeader,{className:"py-4",children:(0,b.jsx)(e.CardTitle,{className:"text-base text-emerald-500",children:"Upcoming Holidays"})}),(0,b.jsxs)(e.CardContent,{className:"py-2",children:[(0,b.jsx)("div",{className:"space-y-2",children:J?(0,b.jsx)(r.Skeleton,{className:"h-4 w-full"}):0===D.length?(0,b.jsx)("p",{className:"text-xs text-muted-foreground whitespace-normal",children:"No holidays scheduled soon."}):D.slice(0,2).map((a,c)=>(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"truncate mr-2",children:a.title||a.name}),(0,b.jsx)("span",{className:"text-muted-foreground whitespace-nowrap",children:a.date?.seconds?new Date(1e3*a.date.seconds).toLocaleDateString([],{month:"short",day:"numeric"}):a.createdAt?.seconds?new Date(1e3*a.createdAt.seconds).toLocaleDateString([],{month:"short",day:"numeric"}):"TBD"})]},c))}),(0,b.jsx)(f.Button,{variant:"link",className:"text-xs text-emerald-500 px-0 mt-2 block",asChild:!0,children:(0,b.jsx)(n.default,{href:"/teacher/holidays",children:"View Calendar"})})]})]})]})]})]})}a.s(["default",()=>s])}];

//# sourceMappingURL=src_app_teacher_page_tsx_80f34d36._.js.map