module.exports=[51347,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(75083),f=a.i(99570),g=a.i(15618),h=a.i(46842),i=a.i(41961),j=a.i(87532),k=a.i(81402),l=a.i(81560),m=a.i(90166),n=a.i(63519),o=a.i(66718);a.i(69387);var p=a.i(60574),q=a.i(20237),r=a.i(70430),s=a.i(14574),t=a.i(80701),u=a.i(96221),v=a.i(33441),w=a.i(91410),x=a.i(88110),y=a.i(56025);function z({isOpen:a,onClose:d,onSuccess:e}){let{user:g}=(0,y.useAuth)(),{subjects:h}=(0,w.useMasterData)(),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)("");(0,c.useEffect)(()=>{if(!g)return;let a=(0,p.onSnapshot)((0,p.doc)(q.db,"users",g.uid),a=>{a.exists()&&l(a.data().role)});return()=>a()},[g]);let[m,n]=(0,c.useState)({name:"",mobile:"",age:"",address:"",salary:"",qualifications:"",primarySubject:"",secondarySubject:"",classTeacherClass:"",classTeacherSection:""}),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(null);(0,c.useEffect)(()=>{a&&(C(null),n({name:"",mobile:"",age:"",address:"",salary:"",qualifications:"",primarySubject:"",secondarySubject:"",classTeacherClass:"",classTeacherSection:""}),j(Object.values(h||{}).filter(a=>!1!==a.isActive).sort((a,b)=>a.name.localeCompare(b.name))))},[a,h]);let D=async a=>{a.preventDefault(),A(!0);try{let a=[];m.primarySubject&&a.push(m.primarySubject),m.secondarySubject&&m.secondarySubject!==m.primarySubject&&a.push(m.secondarySubject);let b=await fetch("/api/admin/teachers/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...m,age:Number(m.age),salary:"MANAGER"===k?0:Number(m.salary),subjects:a,classTeacherOf:m.classTeacherClass?{classId:m.classTeacherClass,sectionId:m.classTeacherSection||"A"}:null})}),c=await b.json();if(!b.ok)throw Error(c.error);(0,x.toast)({title:"Teacher Created",description:`Successfully created account for ${m.name}`,type:"success"}),C({teacherId:c.teacherId,password:m.mobile}),e()}catch(a){(0,x.toast)({title:"Creation Failed",description:a.message||"Could not create teacher account.",type:"error"})}finally{A(!1)}};return(0,b.jsx)(s.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(s.DialogContent,{className:"bg-black/95 border-white/10 text-white sm:max-w-[600px]",children:[(0,b.jsx)(s.DialogHeader,{children:(0,b.jsx)(s.DialogTitle,{children:"Add New Teacher"})}),B?(0,b.jsxs)("div",{className:"py-6 text-center space-y-6",children:[(0,b.jsx)("div",{className:"mx-auto w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center text-blue-500",children:(0,b.jsx)(v.Check,{className:"w-8 h-8"})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h3",{className:"text-2xl font-bold text-blue-400",children:"Teacher Account Created"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"The teacher can now login using these credentials."})]}),(0,b.jsxs)("div",{className:"bg-white/5 p-6 rounded-xl border border-white/10 max-w-sm mx-auto space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-muted-foreground text-sm uppercase tracking-wider",children:"Teacher ID"}),(0,b.jsx)("span",{className:"font-mono font-bold text-xl",children:B.teacherId})]}),(0,b.jsx)("div",{className:"h-px bg-white/10"}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-muted-foreground text-sm uppercase tracking-wider",children:"Password"}),(0,b.jsx)("span",{className:"font-mono font-bold text-xl",children:B.password})]})]}),(0,b.jsx)(f.Button,{onClick:d,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:"Done"})]}):(0,b.jsxs)("form",{onSubmit:D,className:"grid grid-cols-2 gap-4 py-2",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Full Name"}),(0,b.jsx)(o.Input,{required:!0,value:m.name,onChange:a=>n({...m,name:a.target.value}),className:"bg-white/5 border-white/10"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Mobile (Login Password)"}),(0,b.jsx)(o.Input,{required:!0,type:"tel",maxLength:10,value:m.mobile,onChange:a=>n({...m,mobile:a.target.value}),className:"bg-white/5 border-white/10 font-mono"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Age"}),(0,b.jsx)(o.Input,{required:!0,type:"number",min:"18",value:m.age,onChange:a=>n({...m,age:a.target.value}),className:"bg-white/5 border-white/10"})]}),"MANAGER"!==k&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Monthly Salary (₹)"}),(0,b.jsx)(o.Input,{required:!0,type:"number",value:m.salary,onChange:a=>n({...m,salary:a.target.value}),className:"bg-white/5 border-white/10"})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Primary Subject"}),(0,b.jsxs)(t.Select,{value:m.primarySubject,onValueChange:a=>n({...m,primarySubject:a}),children:[(0,b.jsx)(t.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,b.jsx)(t.SelectValue,{placeholder:"Select"})}),(0,b.jsx)(t.SelectContent,{children:i.map(a=>(0,b.jsxs)(t.SelectItem,{value:a.name||"Unknown",children:[a.name||"Unknown"," (",a.code||"?",")"]},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Secondary Subject (Optional)"}),(0,b.jsxs)(t.Select,{value:m.secondarySubject,onValueChange:a=>n({...m,secondarySubject:a}),children:[(0,b.jsx)(t.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,b.jsx)(t.SelectValue,{placeholder:"None"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"NONE",children:"None"}),i.filter(a=>a.name!==m.primarySubject).map(a=>(0,b.jsxs)(t.SelectItem,{value:a.name||"Unknown",children:[a.name||"Unknown"," (",a.code||"?",")"]},a.id))]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Address"}),(0,b.jsx)(o.Input,{required:!0,value:m.address,onChange:a=>n({...m,address:a.target.value}),className:"bg-white/5 border-white/10"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Qualifications"}),(0,b.jsx)(o.Input,{required:!0,value:m.qualifications,onChange:a=>n({...m,qualifications:a.target.value}),className:"bg-white/5 border-white/10",placeholder:"e.g. B.Ed, M.Sc"})]}),(0,b.jsxs)("div",{className:"pt-4 border-t border-white/10",children:[(0,b.jsx)(r.Label,{className:"text-xs text-muted-foreground uppercase mb-2 block",children:"Class Teacher Assignment"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)(t.Select,{value:m.classTeacherClass,onValueChange:a=>n({...m,classTeacherClass:a}),children:[(0,b.jsx)(t.SelectTrigger,{className:"bg-white/5 border-white/10 text-xs",children:(0,b.jsx)(t.SelectValue,{placeholder:"Class"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"NONE",children:"None"}),Object.values((0,w.useMasterData)().classes).sort((a,b)=>a.order-b.order).map(a=>(0,b.jsx)(t.SelectItem,{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)(t.Select,{value:m.classTeacherSection,onValueChange:a=>n({...m,classTeacherSection:a}),children:[(0,b.jsx)(t.SelectTrigger,{className:"bg-white/5 border-white/10 text-xs",children:(0,b.jsx)(t.SelectValue,{placeholder:"Section"})}),(0,b.jsx)(t.SelectContent,{children:Object.values((0,w.useMasterData)().sections).map(a=>(0,b.jsx)(t.SelectItem,{value:a.id,children:a.name},a.id))})]})]})]})]}),(0,b.jsx)(s.DialogFooter,{className:"col-span-2 mt-4",children:(0,b.jsx)(f.Button,{type:"submit",disabled:z,className:"w-full bg-white text-black hover:bg-zinc-200",children:z?(0,b.jsx)(u.Loader2,{className:"w-4 h-4 animate-spin"}):"Create Teacher Account"})})]})]})})}var A=a.i(70106);let B=(0,A.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function C({isOpen:a,onClose:d,onSuccess:e}){let{user:g}=(0,y.useAuth)(),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)("");(0,c.useEffect)(()=>{if(!g)return;let a=(0,p.onSnapshot)((0,p.doc)(q.db,"users",g.uid),a=>{a.exists()&&m(a.data().role)});return()=>a()},[g]);let[n,v]=(0,c.useState)({roleId:"",name:"",mobile:"",address:""}),[w,z]=(0,c.useState)(!1),[A,C]=(0,c.useState)("");(0,c.useEffect)(()=>{a&&(C(""),v({roleId:"",name:"",mobile:"",address:""}),D())},[a]);let D=async()=>{k(!0);try{let a=(0,p.query)((0,p.collection)(q.db,"master_staff_roles"),(0,p.where)("hasLogin","==",!1)),b=await (0,p.getDocs)(a);i(b.docs.map(a=>({id:a.id,...a.data()})))}catch(a){console.error(a),(0,x.toast)({title:"Error",description:"Could not fetch roles.",type:"error"})}finally{k(!1)}},E=async a=>{a.preventDefault(),z(!0);try{let a=h.find(a=>a.id===n.roleId);if(!a)throw Error("Invalid Role");let b=await fetch("/api/admin/staff/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roleId:n.roleId,roleName:a.name,roleCode:a.code,baseSalary:a.basicSalary,name:n.name,mobile:n.mobile,address:n.address})}),c=await b.json();if(!b.ok)throw Error(c.error);(0,x.toast)({title:"Staff Created",description:`Created staff record for ${n.name}`,type:"success"}),C(c.staffId),e()}catch(a){(0,x.toast)({title:"Creation Failed",description:a.message||"Something went wrong.",type:"error"})}finally{z(!1)}},F=h.find(a=>a.id===n.roleId);return(0,b.jsx)(s.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(s.DialogContent,{className:"bg-black/95 border-white/10 text-white sm:max-w-[425px]",children:[(0,b.jsx)(s.DialogHeader,{children:(0,b.jsx)(s.DialogTitle,{children:"Add Non-Teaching Staff"})}),A?(0,b.jsxs)("div",{className:"py-6 text-center space-y-4",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center text-green-500",children:(0,b.jsx)(B,{className:"w-6 h-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-green-400",children:"Staff Created!"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-2",children:"Staff ID Generated:"}),(0,b.jsx)("p",{className:"text-2xl font-mono font-bold tracking-wider mt-1",children:A})]}),(0,b.jsx)(f.Button,{onClick:d,className:"w-full bg-white text-black hover:bg-zinc-200",children:"Done"})]}):(0,b.jsxs)("form",{onSubmit:E,className:"space-y-4 py-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Job Role"}),(0,b.jsxs)(t.Select,{value:n.roleId,onValueChange:a=>v({...n,roleId:a}),disabled:j,children:[(0,b.jsx)(t.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,b.jsx)(t.SelectValue,{placeholder:j?"Loading roles...":"Select Role"})}),(0,b.jsx)(t.SelectContent,{className:"bg-black border-white/10 text-white",children:h.map(a=>(0,b.jsxs)(t.SelectItem,{value:a.id,children:[a.name," (",a.code,")"]},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Full Name"}),(0,b.jsx)(o.Input,{required:!0,value:n.name,onChange:a=>v({...n,name:a.target.value}),className:"bg-white/5 border-white/10",placeholder:"e.g. Ramesh Kumar"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Mobile Number"}),(0,b.jsx)(o.Input,{required:!0,type:"tel",pattern:"[0-9]{10}",value:n.mobile,onChange:a=>v({...n,mobile:a.target.value}),className:"bg-white/5 border-white/10 font-mono",placeholder:"e.g. 9876543210",maxLength:10})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Address"}),(0,b.jsx)(o.Input,{required:!0,value:n.address,onChange:a=>v({...n,address:a.target.value}),className:"bg-white/5 border-white/10",placeholder:"Residential Address"})]}),F&&"MANAGER"!==l&&(0,b.jsxs)("div",{className:"p-3 rounded bg-white/5 border border-white/10 text-sm flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Standard Basic Salary:"}),(0,b.jsxs)("span",{className:"font-mono font-bold",children:["₹",F.basicSalary?.toLocaleString()]})]}),(0,b.jsx)(s.DialogFooter,{className:"mt-4",children:(0,b.jsx)(f.Button,{type:"submit",disabled:w||!n.roleId,className:"w-full bg-white text-black hover:bg-zinc-200",children:w?(0,b.jsx)(u.Loader2,{className:"w-4 h-4 animate-spin"}):"Create Staff Record"})})]})]})})}var D=a.i(9450),E=a.i(35732),F=a.i(62244),G=a.i(43945),H=a.i(68114),I=a.i(86304),J=a.i(89402);function K({hideHeader:a=!1,onTabChange:r}){let s=(0,d.useRouter)(),{user:u}=(0,y.useAuth)(),[v,w]=(0,c.useState)("");(0,c.useEffect)(()=>{if(!u)return;let a=(0,p.onSnapshot)((0,p.doc)(q.db,"users",u.uid),a=>{a.exists()&&w(a.data().role)});return()=>a()},[u]);let[x,A]=(0,c.useState)("teachers");(0,c.useEffect)(()=>{r?.(x)},[x,r]);let[B,K]=(0,c.useState)([]),[L,M]=(0,c.useState)([]),[N,O]=(0,c.useState)(!0),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)("ALL"),[T,U]=(0,c.useState)([]),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(!1),[Z,$]=(0,c.useState)(null),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)(null),[ad,ae]=(0,c.useState)(!1),[af,ag]=(0,c.useState)(null),[ah,ai]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=(0,p.query)((0,p.collection)(q.db,"teachers"),(0,p.orderBy)("schoolId")),b=(0,p.onSnapshot)(a,a=>{K(a.docs.map(a=>({id:a.id,...a.data()}))),O(!1)}),c=(0,p.query)((0,p.collection)(q.db,"staff"),(0,p.orderBy)("schoolId")),d=(0,p.onSnapshot)(c,a=>{M(a.docs.map(a=>({id:a.id,...a.data()}))),O(!1)}),e=(0,p.query)((0,p.collection)(q.db,"master_staff_roles"),(0,p.orderBy)("name")),f=(0,p.onSnapshot)(e,a=>{U(Array.from(new Map(a.docs.map(a=>({id:a.id,...a.data()})).map(a=>[a.code,a])).values()))});return()=>{b(),d(),f()}},[]);let aj=B.filter(a=>a.name?.toLowerCase().includes(P.toLowerCase())||a.schoolId?.toLowerCase().includes(P.toLowerCase())||a.mobile?.includes(P)),ak=L.filter(a=>{let b=a.name?.toLowerCase().includes(P.toLowerCase())||a.schoolId?.toLowerCase().includes(P.toLowerCase())||a.mobile?.includes(P),c="ALL"===R||a.roleCode===R;return b&&c});return(0,b.jsxs)("div",{className:(0,H.cn)("space-y-6 animate-in fade-in duration-500 max-w-7xl mx-auto pb-20",a?"p-0":"p-4 md:p-0"),children:[!a&&(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between pt-2 md:pt-4 gap-4 md:gap-6 px-2 md:px-0",children:[(0,b.jsxs)("div",{className:"space-y-0.5 md:space-y-1",children:[(0,b.jsx)("h1",{className:"text-2xl md:text-5xl font-display font-bold bg-gradient-to-r from-white to-white/60 bg-clip-text text-transparent italic leading-tight",children:"Faculty Registry"}),(0,b.jsxs)("p",{className:"text-muted-foreground text-[10px] md:text-lg tracking-tight uppercase font-black opacity-50",children:["Managing ",(0,b.jsxs)("span",{className:"text-white",children:[B.length+L.length," professional staff"]})," members"]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)(f.Button,{onClick:()=>"teachers"===x?W(!0):Y(!0),className:"h-10 md:h-12 flex-1 md:flex-initial bg-white text-black hover:bg-zinc-200 rounded-xl font-black uppercase tracking-tighter px-4 md:px-6 shadow-lg shadow-white/10 text-xs md:text-sm",children:[(0,b.jsx)(g.Plus,{className:"w-3.5 h-3.5 md:w-4 md:h-4 mr-2 stroke-[3]"})," Add ","teachers"===x?"Teacher":"Staff"]})})]}),(0,b.jsxs)(e.Tabs,{value:x,onValueChange:A,className:"space-y-4 md:space-y-6",children:[(0,b.jsxs)("div",{className:"px-2 md:px-0 space-y-3 md:space-y-4",children:[(0,b.jsxs)(e.TabsList,{className:"bg-black/40 border border-white/10 p-1 h-auto rounded-xl md:rounded-2xl backdrop-blur-md w-full sm:w-fit grid grid-cols-2",children:[(0,b.jsx)(e.TabsTrigger,{value:"teachers",className:"data-[state=active]:bg-white data-[state=active]:text-black rounded-lg md:rounded-xl py-1.5 md:py-2.5 font-bold transition-all text-xs md:text-sm",children:"Teachers"}),(0,b.jsx)(e.TabsTrigger,{value:"staff",className:"data-[state=active]:bg-white data-[state=active]:text-black rounded-lg md:rounded-xl py-1.5 md:py-2.5 font-bold transition-all text-xs md:text-sm",children:"Staff"})]}),(0,b.jsx)("div",{className:"bg-black/20 p-3 md:p-5 rounded-xl md:rounded-2xl border border-white/10 backdrop-blur-md space-y-3 md:space-y-4 shadow-2xl",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 md:gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(j.Search,{className:"absolute left-3 md:left-4 top-1/2 -translate-y-1/2 w-3.5 h-3.5 md:w-4 md:h-4 text-muted-foreground"}),(0,b.jsx)(o.Input,{placeholder:"Search name, ID, or mobile...",value:P,onChange:a=>Q(a.target.value),className:"pl-9 md:pl-11 h-10 md:h-12 bg-white/5 border-white/10 rounded-lg md:rounded-xl focus:ring-accent/30 text-xs md:text-sm"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:["staff"===x&&(0,b.jsxs)(t.Select,{value:R,onValueChange:S,children:[(0,b.jsx)(t.SelectTrigger,{className:"flex-1 md:w-[180px] h-10 md:h-12 bg-white/5 border-white/10 rounded-lg md:rounded-xl text-xs md:text-sm",children:(0,b.jsx)(t.SelectValue,{placeholder:"All Roles"})}),(0,b.jsxs)(t.SelectContent,{className:"bg-zinc-900 border-white/10 text-white",children:[(0,b.jsx)(t.SelectItem,{value:"ALL",children:"All Roles"}),T.filter(a=>!a.hasLogin).map(a=>(0,b.jsx)(t.SelectItem,{value:a.code,children:a.name},a.code))]})]}),(P||"ALL"!==R)&&(0,b.jsx)(f.Button,{variant:"ghost",onClick:()=>{Q(""),S("ALL")},className:"h-10 md:h-12 px-3 md:px-6 text-[8px] md:text-[10px] font-black uppercase tracking-widest text-muted-foreground hover:text-white rounded-lg md:rounded-xl border border-dashed border-white/10 transition-all shrink-0",children:"Clear"})]})]})})]}),(0,b.jsx)(e.TabsContent,{value:"teachers",className:"space-y-4 outline-none",children:(0,b.jsx)(J.DataTable,{data:aj,isLoading:N,onRowClick:a=>s.push(`/admin/teachers/${a.id}`),columns:[{key:"name",header:"Faculty Info",render:a=>(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-9 h-9 rounded-xl bg-white/5 flex items-center justify-center border border-white/5 group-hover:border-accent/30 transition-colors",children:(0,b.jsx)(h.User,{size:16,className:"text-white/40 group-hover:text-accent transition-colors"})}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-bold text-sm text-white group-hover:text-accent transition-colors leading-tight",children:a.name}),(0,b.jsx)("span",{className:"text-[10px] font-mono text-white/40 tracking-tighter uppercase",children:a.schoolId})]})]})},{key:"mobile",header:"Contact",render:a=>(0,b.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-white/60",children:[(0,b.jsx)(n.Phone,{size:12,className:"text-white/20"}),(0,b.jsx)("span",{className:"font-mono",children:a.mobile})]})},{key:"password",header:"Secret Key",render:a=>(0,b.jsxs)("div",{className:"flex items-center gap-1.5 text-[10px] text-amber-500/80 bg-amber-500/5 px-2 py-1 rounded border border-amber-500/10 w-fit",children:[(0,b.jsx)(k.Key,{size:10,className:"text-amber-500"}),(0,b.jsx)("span",{className:"font-mono tracking-wider font-bold",children:a.recoveryPassword||a.mobile})]})},{key:"salary",header:"Base Salary",headerClassName:"text-right",cellClassName:"text-right",render:a=>"MANAGER"===v?(0,b.jsx)("span",{className:"text-white/20",children:"••••••"}):(0,b.jsxs)("span",{className:"font-mono font-black text-sm text-emerald-400",children:["₹",a.salary?.toLocaleString()||"0"]})},{key:"status",header:"Status",headerClassName:"text-center",cellClassName:"text-center",render:a=>(0,b.jsx)(I.Badge,{className:(0,H.cn)("text-[9px] font-black uppercase tracking-tighter py-0 h-5 border-none transition-all","ACTIVE"===a.status?"bg-emerald-500/10 text-emerald-400":"bg-red-500/10 text-red-400"),children:a.status})}],actions:a=>(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)(E.DropdownMenuItem,{onClick:()=>{a.uid?($({uid:a.uid,schoolId:a.schoolId,name:a.name,role:"TEACHER"}),aa(!0)):alert("UID Missing")},className:"rounded-lg gap-2 text-xs font-bold text-amber-500 hover:text-amber-400 transition-colors",children:[(0,b.jsx)(k.Key,{size:14})," Reset Password"]}),"MANAGER"!==v&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(E.DropdownMenuItem,{onClick:()=>{ag({id:a.id,name:a.name,schoolId:a.schoolId,role:"TEACHER",currentSalary:a.salary||0}),ai(!0)},className:"rounded-lg gap-2 text-xs font-bold text-emerald-500 hover:text-emerald-400 transition-colors",children:[(0,b.jsx)(m.DollarSign,{size:14})," Adjust Salary"]}),(0,b.jsxs)(E.DropdownMenuItem,{onClick:()=>{ac({id:a.id,schoolId:a.schoolId,name:a.name,role:"teacher",uid:a.uid,collectionName:"teachers"}),ae(!0)},className:"rounded-lg gap-2 text-xs font-bold text-red-500 hover:text-red-400 transition-colors",children:[(0,b.jsx)(l.Trash2,{size:14})," Remove Faculty"]})]})]})})}),(0,b.jsx)(e.TabsContent,{value:"staff",className:"space-y-4 outline-none",children:(0,b.jsx)(J.DataTable,{data:ak,isLoading:N,onRowClick:a=>s.push(`/admin/staff/${a.id}`),columns:[{key:"name",header:"Staff Info",render:a=>(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-9 h-9 rounded-xl bg-white/5 flex items-center justify-center border border-white/5 group-hover:border-blue-400/30 transition-colors",children:(0,b.jsx)(i.Briefcase,{size:16,className:"text-white/40 group-hover:text-blue-400 transition-colors"})}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-bold text-sm text-white group-hover:text-blue-400 transition-colors leading-tight",children:a.name}),(0,b.jsx)("span",{className:"text-[10px] font-mono text-white/40 tracking-tighter uppercase",children:a.schoolId})]})]})},{key:"role",header:"Role & Placement",render:a=>{let c=T.find(b=>b.code===a.roleCode);return(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("span",{className:"text-[10px] uppercase font-black text-muted-foreground tracking-tighter bg-white/5 px-2 py-0.5 rounded border border-white/5 w-fit lowercase",children:c?.name||a.roleCode||"Staff"}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5 text-[10px] text-white/30",children:[(0,b.jsx)(n.Phone,{size:10,className:"opacity-40"}),(0,b.jsx)("span",{className:"font-mono",children:a.mobile})]})]})}},{key:"baseSalary",header:"Base Salary",headerClassName:"text-right",cellClassName:"text-right",render:a=>"MANAGER"===v?(0,b.jsx)("span",{className:"text-white/20",children:"••••••"}):(0,b.jsxs)("span",{className:"font-mono font-black text-sm text-emerald-400",children:["₹",a.baseSalary?.toLocaleString()||"0"]})},{key:"status",header:"Status",headerClassName:"text-center",cellClassName:"text-center",render:a=>(0,b.jsx)(I.Badge,{className:(0,H.cn)("text-[9px] font-black uppercase tracking-tighter py-0 h-5 border-none transition-all","ACTIVE"===a.status?"bg-emerald-500/10 text-emerald-400":"bg-red-500/10 text-red-400"),children:a.status})}],actions:a=>(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)(E.DropdownMenuItem,{onClick:()=>{a.uid?($({uid:a.uid,schoolId:a.schoolId,name:a.name,role:"STAFF"}),aa(!0)):alert("UID Missing")},className:"rounded-lg gap-2 text-xs font-bold text-amber-500 hover:text-amber-400 transition-colors",children:[(0,b.jsx)(k.Key,{size:14})," Reset Password"]}),"MANAGER"!==v&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(E.DropdownMenuItem,{onClick:()=>{ag({id:a.id,name:a.name,schoolId:a.schoolId,role:"STAFF",currentSalary:a.baseSalary||0,roleCode:a.roleCode}),ai(!0)},className:"rounded-lg gap-2 text-xs font-bold text-emerald-500 hover:text-emerald-400 transition-colors",children:[(0,b.jsx)(m.DollarSign,{size:14})," Adjust Salary"]}),(0,b.jsxs)(E.DropdownMenuItem,{onClick:()=>{ac({id:a.id,schoolId:a.schoolId,name:a.name,role:"admin",uid:a.uid,collectionName:"staff"}),ae(!0)},className:"rounded-lg gap-2 text-xs font-bold text-red-500 hover:text-red-400 transition-colors",children:[(0,b.jsx)(l.Trash2,{size:14})," Remove Staff"]})]})]})})})]}),(0,b.jsx)(z,{isOpen:V,onClose:()=>W(!1),onSuccess:()=>{}}),(0,b.jsx)(C,{isOpen:X,onClose:()=>Y(!1),onSuccess:()=>{}}),(0,b.jsx)(D.AdminChangePasswordModal,{isOpen:_,onClose:()=>aa(!1),user:Z,onSuccess:()=>{}}),(0,b.jsx)(G.AdjustSalaryModal,{isOpen:ah,onClose:()=>ai(!1),person:af,onSuccess:()=>{}}),ab&&(0,b.jsx)(F.DeleteUserModal,{isOpen:ad,onClose:()=>{ae(!1),ac(null)},user:ab,checkEligibility:async()=>({canDelete:!0}),onDeactivate:async a=>{try{await (0,p.updateDoc)((0,p.doc)(q.db,ab.collectionName,ab.id),{status:"INACTIVE",deactivationReason:a,updatedAt:new Date().toISOString()})}catch(a){throw console.error(a),a}},onDelete:async a=>{if(!u)return void alert("Not authenticated");let b=await u.getIdToken(),c=await fetch("/api/admin/users/delete",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({targetUid:ab.uid,schoolId:ab.schoolId,role:ab.role.toUpperCase(),collectionName:ab.collectionName})}),d=await c.json();if(!d.success)throw Error(d.error)}})]})}var L=a.i(33508);let M=(0,A.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),N=(0,A.default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);var O=a.i(53722),P=a.i(84141);function Q(){let{user:a}=(0,y.useAuth)(),[d,e]=(0,c.useState)([]),[g,h]=(0,c.useState)(!0),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(null),[o,r]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=(0,p.query)((0,p.collection)(q.db,"leave_requests"),(0,p.orderBy)("createdAt","desc")),b=(0,p.onSnapshot)(a,a=>{e(a.docs.map(a=>({id:a.id,...a.data()}))),h(!1)},a=>{console.error("Leaves Listener Error:",a),h(!1)});return()=>b()},[]);let t=async a=>{l(a),r(!0),n(null);try{let b=(0,p.query)((0,p.collection)(q.db,"teachers"),(0,p.where)("uid","==",a.teacherId),(0,p.limit)(1)),c=await (0,p.getDocs)(b);if(!c.empty){let a=c.docs[0].data(),b=a.schoolId||a.teacherId||a.id||c.docs[0].id,d=await (0,p.getDoc)((0,p.doc)(q.db,"teacher_schedules",`2025-2026_${b}`));d.exists()&&n(d.data().schedule||{})}}catch(a){console.error("Impact Fetch Error",a)}finally{r(!1)}},w=async(b,c)=>{if(!a)return void alert("System is Verifying your identity... Please try again.");if(confirm("REVERT"===c?"This will remove all coverage assignments for this leave. Move back to Pending?":`Are you sure you want to ${c.toLowerCase()} this leave?`)){j(b);try{let d=await a.getIdToken(),e=await fetch("/api/admin/leaves/approve",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify({leaveId:b,action:c})}),f=await e.json();f.success||alert("Error: "+f.error)}catch(a){alert(a.message)}finally{j(null)}}};return(0,b.jsx)("div",{className:"space-y-3 md:space-y-6 max-w-none p-0 animate-in fade-in",children:(0,b.jsxs)("div",{className:"mobile-dense-table overflow-hidden",children:[(0,b.jsx)(J.DataTable,{data:d,isLoading:g,columns:[{key:"teacherName",header:"Staff",render:a=>(0,b.jsx)("div",{className:"font-bold text-white truncate max-w-[60px] md:max-w-none text-[9px] md:text-sm",children:a.teacherName})},{key:"dates",header:"Term",render:a=>(0,b.jsxs)("div",{className:"text-white/70 leading-tight",children:[(0,b.jsx)("div",{className:"text-[8px] md:text-sm whitespace-nowrap",children:a.fromDate===a.toDate?(0,P.formatDateToDDMMYYYY)(a.fromDate):`${(0,P.formatDateToDDMMYYYY)(a.fromDate).split("/").slice(0,2).join("/")}..`}),(0,b.jsx)(I.Badge,{variant:"outline",className:"h-3 md:h-4 text-[7px] md:text-[10px] border-white/10 text-white/40 px-1 py-0 px-0.5",children:a.type.slice(0,4)})]})},{key:"reason",header:"Cause",render:a=>(0,b.jsx)("div",{className:"text-[8px] md:text-sm max-w-[50px] md:max-w-xs truncate text-white/50 italic",title:a.reason,children:a.reason})},{key:"status",header:"Status",render:a=>(0,b.jsxs)("div",{className:"scale-[0.8] md:scale-100 origin-left",children:["PENDING"===a.status&&(0,b.jsx)(I.Badge,{className:"bg-yellow-500/10 text-yellow-500 border border-yellow-500/20 py-0 px-1 text-[8px] md:text-xs",children:"Pend"}),"APPROVED"===a.status&&(0,b.jsx)(I.Badge,{className:"bg-emerald-500/10 text-emerald-500 border border-emerald-500/20 py-0 px-1 text-[8px] md:text-xs",children:"Appr"}),"REJECTED"===a.status&&(0,b.jsx)(I.Badge,{className:"bg-red-500/10 text-red-400 border border-red-500/20 py-0 px-1 text-[8px] md:text-xs",children:"Rej"})]})}],actions:a=>(0,b.jsxs)("div",{className:"flex flex-col gap-1 p-1",children:[(0,b.jsxs)(s.Dialog,{children:[(0,b.jsx)(s.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{size:"sm",variant:"ghost",className:"w-full justify-start gap-2 h-8 hover:bg-zinc-800 text-white/70",onClick:()=>t(a),children:[(0,b.jsx)(N,{className:"w-4 h-4"})," Impact Analysis"]})}),(0,b.jsxs)(s.DialogContent,{className:"bg-[#0A192F] border-white/10 text-white max-w-md",children:[(0,b.jsxs)(s.DialogHeader,{children:[(0,b.jsxs)(s.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(O.BookOpen,{className:"w-5 h-5 text-accent"}),"Classes Affected"]}),(0,b.jsx)(s.DialogDescription,{className:"text-white/60",children:"Teacher schedule for this leave period."})]}),(0,b.jsx)("div",{className:"space-y-4 py-4",children:o?(0,b.jsx)("div",{className:"flex justify-center p-8",children:(0,b.jsx)(u.Loader2,{className:"animate-spin text-accent"})}):m&&0!==Object.keys(m).length?(0,b.jsx)("div",{className:"space-y-4 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"].map(a=>{let c=m[a];return c&&0!==Object.keys(c).length?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(I.Badge,{variant:"outline",className:"border-accent/20 text-accent text-[10px] uppercase tracking-wider",children:a}),(0,b.jsx)("div",{className:"grid gap-2",children:Object.entries(c).map(([a,c])=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 rounded bg-white/5 border border-white/10",children:[(0,b.jsxs)("div",{className:"text-xs font-mono text-white/50",children:["Period ",a]}),(0,b.jsxs)("div",{className:"text-sm font-bold text-white",children:["Class ",c.classId]})]},a))})]},a):null})}):(0,b.jsx)("div",{className:"text-center p-8 text-white/40 italic",children:"No classes scheduled for this teacher."})})]})]}),"PENDING"===a.status?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(f.Button,{size:"sm",variant:"ghost",className:"w-full justify-start gap-2 h-8 hover:bg-emerald-500/10 text-emerald-400 font-bold",onClick:()=>w(a.id,"APPROVE"),disabled:i===a.id,children:[i===a.id?(0,b.jsx)(u.Loader2,{className:"w-4 h-4 animate-spin"}):(0,b.jsx)(v.Check,{className:"w-4 h-4"}),"Approve Leave"]}),(0,b.jsxs)(f.Button,{size:"sm",variant:"ghost",className:"w-full justify-start gap-2 h-8 hover:bg-red-500/10 text-red-400 font-bold",onClick:()=>w(a.id,"REJECT"),disabled:i===a.id,children:[(0,b.jsx)(L.X,{className:"w-4 h-4"})," Reject Leave"]})]}):(0,b.jsxs)(f.Button,{size:"sm",variant:"ghost",className:"w-full justify-start gap-2 h-8 text-white/40 hover:text-white",onClick:()=>w(a.id,"REVERT"),disabled:i===a.id,children:[i===a.id?(0,b.jsx)(u.Loader2,{className:"w-3 h-3 animate-spin"}):(0,b.jsx)(M,{className:"w-3 h-3"}),"Revert Status"]})]})}),0===d.length&&!g&&(0,b.jsx)("div",{className:"text-center py-12 text-white/30 italic bg-black/10 rounded-xl border border-dashed border-white/10 text-sm",children:"No leave requests found."})]})})}var R=a.i(91119),S=a.i(16201),T=a.i(44194);function U(){let[a,d]=(0,c.useState)([]),[e,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)("SUBSTITUTE"),[r,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(null);(0,c.useEffect)(()=>{let a=(0,p.query)((0,p.collection)(q.db,"coverage_tasks"),(0,p.orderBy)("createdAt","desc"),(0,p.limit)(100)),b=(0,p.onSnapshot)(a,a=>{d(a.docs.map(a=>({id:a.id,...a.data()}))),g(!1)},a=>{console.warn("Task Listener Error, falling back...",a);let b=(0,p.query)((0,p.collection)(q.db,"coverage_tasks"),(0,p.limit)(100));(0,p.onSnapshot)(b,a=>{d(a.docs.map(a=>({id:a.id,...a.data()}))),g(!1)})}),c=(0,p.query)((0,p.collection)(q.db,"teachers"),(0,p.where)("status","==","ACTIVE")),e=(0,p.onSnapshot)(c,a=>{i(a.docs.map(a=>({id:a.id,...a.data()})))});return()=>{b(),e()}},[]);let A=a=>{if(!a)return"N/A";let b=h.find(b=>b.id===a||b.schoolId===a||b.uid===a);return b?.name||a},C=async()=>{if(l){x(!0);try{let a=await fetch("/api/admin/timetable/coverage/resolve",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await q.auth.currentUser?.getIdToken()}`},body:JSON.stringify({taskId:l.id,resolutionType:n,substituteTeacherId:"SUBSTITUTE"===n?r:null})}),b=await a.json();b.success?m(null):alert(b.error)}catch(a){alert(a.message)}finally{x(!1)}}};return(0,b.jsxs)("div",{className:"space-y-4 md:space-y-6 max-w-none p-0 animate-in fade-in pb-20",children:[(0,b.jsx)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 px-1",children:(0,b.jsx)("div",{className:"flex items-center gap-2 w-full md:w-auto",children:(0,b.jsxs)("div",{className:"flex items-center gap-1 bg-white/5 p-1 rounded-xl border border-white/10 backdrop-blur-md",children:[(0,b.jsx)(f.Button,{variant:j?"ghost":"default",size:"sm",onClick:()=>k(!1),className:(0,H.cn)("text-[10px] h-8 px-4 font-black uppercase tracking-widest transition-all rounded-lg",j?"text-white/40 hover:text-white":"bg-accent text-black"),children:"Pending"}),(0,b.jsx)(f.Button,{variant:j?"default":"ghost",size:"sm",onClick:()=>k(!0),className:(0,H.cn)("text-[10px] h-8 px-4 font-black uppercase tracking-widest transition-all rounded-lg",j?"bg-accent text-black":"text-white/40 hover:text-white"),children:"Resolved"})]})})}),y&&(0,b.jsx)("div",{className:"p-4 bg-red-500/10 border border-red-500/20 text-red-500 rounded-xl text-sm mb-6",children:y}),e?(0,b.jsx)("div",{className:"p-10 flex justify-center",children:(0,b.jsx)(u.Loader2,{className:"animate-spin text-blue-500"})}):(0,b.jsx)("div",{className:"grid grid-cols-1 gap-3",children:0===a.filter(a=>j?"RESOLVED"===a.status:"PENDING"===a.status).length?(0,b.jsxs)("div",{className:"py-20 text-center border border-dashed border-white/10 rounded-xl bg-white/5",children:[(0,b.jsx)(T.Coffee,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4 opacity-20"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["No ",j?"resolved":"pending"," coverage tasks ",j?"yet":"at the moment","."]})]}):a.filter(a=>j?"RESOLVED"===a.status:"PENDING"===a.status).map(a=>{let c=a.originalTeacherId,d=a.day||(a.date?new Date(a.date).toLocaleDateString("en-US",{weekday:"long"}).toUpperCase():"N/A");return(0,b.jsx)(R.Card,{className:"bg-black/20 border-white/10 overflow-hidden hover:bg-white/5 transition-all group backdrop-blur-md rounded-2xl relative",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between p-3 md:p-5 gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[(0,b.jsx)("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-xl bg-red-500/10 border border-red-500/20 flex items-center justify-center text-red-400 font-black text-[10px] flex-col shrink-0 italic shadow-inner",children:(0,b.jsxs)("span",{children:[a.date?.split("-")?.[1]||"??","/",a.date?.split("-")?.[2]||"??"]})}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("h4",{className:"font-bold text-sm md:text-lg text-white group-hover:text-accent transition-colors leading-tight truncate",children:A(c)}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-[10px] text-muted-foreground flex-wrap font-bold uppercase tracking-widest opacity-60",children:[(0,b.jsx)("span",{className:"text-accent/60",children:d}),(0,b.jsx)("span",{className:"w-1 h-1 rounded-full bg-white/20"}),(0,b.jsxs)("span",{children:["Period ",a.slotId]}),(0,b.jsx)("span",{className:"w-1 h-1 rounded-full bg-white/20"}),(0,b.jsx)("span",{children:a.classId})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between md:justify-end w-full md:w-auto gap-3 border-t md:border-t-0 border-white/5 pt-3 md:pt-0",children:["PENDING"===a.status&&a.suggestedSubstituteId&&(0,b.jsxs)("div",{className:"text-left md:text-right md:mr-2 md:border-r border-white/10 md:pr-4",children:[(0,b.jsx)("div",{className:"text-[8px] text-blue-400 uppercase font-black tracking-widest mb-0.5",children:"Recommendation"}),(0,b.jsx)("div",{className:"text-xs font-bold text-white/90",children:"LEISURE"===a.suggestedType?"Leisure":A(a.suggestedSubstituteId)})]}),"RESOLVED"===a.status&&(0,b.jsxs)("div",{className:"text-left md:text-right md:mr-2",children:[(0,b.jsx)("div",{className:"text-[8px] text-muted-foreground uppercase font-black tracking-widest mb-0.5 opacity-40",children:"Resolved Status"}),(0,b.jsxs)("div",{className:"text-xs font-bold text-emerald-400 flex items-center gap-1.5",children:[(0,b.jsx)(S.CheckCircle,{className:"w-3 h-3"}),a.resolution?.type==="LEISURE"?"Leisure Mode":`Covered By ${A(a.resolution?.substituteTeacherId||"")}`]})]}),(0,b.jsxs)(s.Dialog,{open:l?.id===a.id,onOpenChange:a=>!a&&m(null),children:[(0,b.jsx)(s.DialogTrigger,{asChild:!0,children:(0,b.jsx)(f.Button,{size:"sm",onClick:()=>{m(a),"RESOLVED"===a.status&&a.resolution?(o("SUBSTITUTION"===a.resolution.type?"SUBSTITUTE":"LEISURE"),v(a.resolution.substituteTeacherId||"")):(o(a.suggestedType||"SUBSTITUTE"),v(a.suggestedSubstituteId||""))},className:(0,H.cn)("h-9 px-4 text-[10px] font-black uppercase tracking-widest rounded-xl transition-all","RESOLVED"===a.status?"bg-white/5 text-white/40 hover:text-white border border-white/10":"bg-blue-600 hover:bg-blue-700 text-white shadow-lg shadow-blue-900/20"),children:"RESOLVED"===a.status?"Manage":"Action"})}),(0,b.jsxs)(s.DialogContent,{className:"bg-[#0A192F] border-white/10 text-white rounded-2xl shadow-2xl shadow-black/50",children:[(0,b.jsxs)(s.DialogHeader,{children:[(0,b.jsxs)(s.DialogTitle,{className:"text-xl font-bold flex items-center gap-2 italic",children:[(0,b.jsx)(B,{className:"text-accent"})," Resolve Coverage"]}),(0,b.jsx)(s.DialogDescription,{className:"text-[10px] text-muted-foreground uppercase font-black tracking-widest opacity-60",children:"Choose how to handle this academic period."})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"flex gap-2 p-1 bg-white/5 rounded-xl border border-white/10",children:[(0,b.jsxs)(f.Button,{variant:"SUBSTITUTE"===n?"default":"outline",onClick:()=>o("SUBSTITUTE"),className:(0,H.cn)("flex-1 h-10 text-[10px] font-black uppercase tracking-widest rounded-lg transition-all","SUBSTITUTE"===n?"bg-accent text-black hover:bg-accent/90":"bg-transparent text-white/40 border-none hover:text-white hover:bg-white/5"),children:[(0,b.jsx)(B,{className:"w-3.5 h-3.5 mr-2"})," Substitute"]}),(0,b.jsxs)(f.Button,{variant:"LEISURE"===n?"default":"outline",onClick:()=>o("LEISURE"),className:(0,H.cn)("flex-1 h-10 text-[10px] font-black uppercase tracking-widest rounded-lg transition-all","LEISURE"===n?"bg-accent text-black hover:bg-accent/90":"bg-transparent text-white/40 border-none hover:text-white hover:bg-white/5"),children:[(0,b.jsx)(T.Coffee,{className:"w-3.5 h-3.5 mr-2"})," Leisure"]})]}),"SUBSTITUTE"===n&&(0,b.jsxs)("div",{className:"space-y-4 pt-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,b.jsx)("label",{className:"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1",children:"Select Substitute Teacher"}),(0,b.jsxs)("div",{className:"text-[8px] px-2 py-0.5 rounded-full bg-blue-500/10 text-blue-400 border border-blue-500/20 font-black uppercase tracking-tighter",children:["Recommended: ",A(a.suggestedSubstituteId||"")]})]}),(0,b.jsxs)(t.Select,{value:r,onValueChange:v,children:[(0,b.jsx)(t.SelectTrigger,{className:"h-12 bg-black/40 border-white/10 rounded-xl font-bold focus:ring-accent/20",children:(0,b.jsx)(t.SelectValue,{placeholder:"Choose Teacher"})}),(0,b.jsx)(t.SelectContent,{className:"bg-[#0A192F] border-white/10 text-white",children:h.filter(b=>(b.schoolId||b.id)!==a.originalTeacherId).map(a=>(0,b.jsx)(t.SelectItem,{value:a.schoolId||a.id,className:"focus:bg-accent focus:text-black font-bold text-xs",children:a.name},a.id))})]})]})]}),(0,b.jsx)(s.DialogFooter,{className:"pt-2",children:(0,b.jsx)(f.Button,{onClick:C,disabled:w||"SUBSTITUTE"===n&&!r,className:"w-full h-12 bg-accent text-black hover:bg-accent/90 font-black uppercase tracking-widest text-xs rounded-xl shadow-lg shadow-accent/20",children:w?(0,b.jsx)(u.Loader2,{className:"animate-spin w-4 h-4"}):"Finalize Resolution"})})]})]})]})]})},a.id)})})]})}var V=a.i(60246),W=a.i(41675),X=a.i(66384);function Y(){let a=(0,d.useSearchParams)(),[h,i]=(0,c.useState)(a.get("tab")||"directory"),[j,k]=(0,c.useState)("teachers"),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{let b=a.get("tab");b&&i(b)},[a]),(0,b.jsxs)("div",{className:"space-y-6 md:space-y-10 animate-in fade-in duration-500 pb-20",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 px-2 md:px-0",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h1",{className:"text-2xl md:text-5xl font-display font-bold bg-gradient-to-r from-white to-white/60 bg-clip-text text-transparent italic leading-tight",children:"Faculty & HR"}),(0,b.jsxs)("p",{className:"text-muted-foreground text-[10px] md:text-sm tracking-tight uppercase font-black opacity-50",children:["Consolidated Management: ",(0,b.jsx)("span",{className:"text-accent",children:"Directory • Leaves • Coverage"})]})]}),"directory"===h&&(0,b.jsxs)(f.Button,{onClick:()=>"teachers"===j?m(!0):o(!0),className:"h-10 md:h-12 bg-white text-black hover:bg-zinc-200 rounded-xl font-black uppercase tracking-tighter px-4 md:px-6 shadow-lg shadow-white/10 text-xs md:text-sm",children:[(0,b.jsx)(g.Plus,{className:"w-3.5 h-3.5 md:w-4 md:h-4 mr-2 stroke-[3]"})," Add ","teachers"===j?"Teacher":"Staff"]})]}),(0,b.jsxs)(e.Tabs,{value:h,onValueChange:i,className:"space-y-6",children:[(0,b.jsx)("div",{className:"px-2 md:px-0 bg-black/20 p-1 rounded-2xl border border-white/5 backdrop-blur-md sticky top-0 z-10 mx-2 md:mx-0",children:(0,b.jsxs)(e.TabsList,{className:"bg-transparent h-auto w-full grid grid-cols-3 gap-1",children:[(0,b.jsxs)(e.TabsTrigger,{value:"directory",className:"data-[state=active]:bg-white data-[state=active]:text-black rounded-xl py-2 md:py-3 font-bold transition-all text-[10px] md:text-sm flex flex-col md:flex-row items-center gap-1 md:gap-2",children:[(0,b.jsx)(V.Users,{size:14,className:"md:w-4 md:h-4"}),(0,b.jsx)("span",{children:"Directory"})]}),(0,b.jsxs)(e.TabsTrigger,{value:"leaves",className:"data-[state=active]:bg-white data-[state=active]:text-black rounded-xl py-2 md:py-3 font-bold transition-all text-[10px] md:text-sm flex flex-col md:flex-row items-center gap-1 md:gap-2",children:[(0,b.jsx)(W.Calendar,{size:14,className:"md:w-4 md:h-4"}),(0,b.jsx)("span",{children:"Leaves"})]}),(0,b.jsxs)(e.TabsTrigger,{value:"coverage",className:"data-[state=active]:bg-white data-[state=active]:text-black rounded-xl py-2 md:py-3 font-bold transition-all text-[10px] md:text-sm flex flex-col md:flex-row items-center gap-1 md:gap-2",children:[(0,b.jsx)(X.ShieldAlert,{size:14,className:"md:w-4 md:h-4"}),(0,b.jsx)("span",{children:"Coverage"})]})]})}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(e.TabsContent,{value:"directory",className:"outline-none m-0",children:(0,b.jsx)("div",{className:"bg-transparent",children:(0,b.jsx)(K,{hideHeader:!0,onTabChange:k})})}),(0,b.jsx)(e.TabsContent,{value:"leaves",className:"outline-none m-0 px-2 md:px-0",children:(0,b.jsx)(Q,{})}),(0,b.jsx)(e.TabsContent,{value:"coverage",className:"outline-none m-0 px-2 md:px-0",children:(0,b.jsx)(U,{})})]})]}),(0,b.jsx)(z,{isOpen:l,onClose:()=>m(!1),onSuccess:()=>{}}),(0,b.jsx)(C,{isOpen:n,onClose:()=>o(!1),onSuccess:()=>{}})]})}function Z(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,b.jsx)(u.Loader2,{className:"animate-spin text-accent"})}),children:(0,b.jsx)(Y,{})})}a.s(["default",()=>Z],51347)}];

//# sourceMappingURL=src_app_admin_faculty_page_tsx_1d6f6a20._.js.map