module.exports=[91119,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-2xl border border-[#64FFDA]/10 bg-[#112240]/40 backdrop-blur-lg text-white shadow-xl transition-all duration-300 hover:bg-[#112240]/60 hover:border-[#64FFDA]/30 hover:shadow-[0_0_20px_-5px_rgba(100,255,218,0.1)] group",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("font-bold text-xl tracking-tight text-white group-hover:text-accent transition-colors",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-white/60 font-medium",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},52403,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(56025),e=a.i(91119),f=a.i(86304),g=a.i(38246),h=a.i(96221),i=a.i(41675),j=a.i(210);a.i(69387);var k=a.i(60574),l=a.i(20237),m=a.i(91410);function n(){let{user:a}=(0,d.useAuth)(),{subjects:n}=(0,m.useMasterData)(),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)({}),[w,x]=(0,c.useState)([]);(0,c.useEffect)(()=>{a&&(A(),z(),y())},[a]);let y=async()=>{try{let a=(0,k.query)((0,k.collection)(l.db,"notices"),(0,k.where)("type","==","HOLIDAY")),b=await (0,k.getDocs)(a);x(b.docs.map(a=>({id:a.id,...a.data()})))}catch(a){console.error(a)}},z=async()=>{try{let a=(0,k.query)((0,k.collection)(l.db,"teachers")),b=await (0,k.getDocs)(a),c={};b.docs.forEach(a=>{let b=a.data();b.schoolId&&(c[b.schoolId]=b.name),c[a.id]=b.name}),v(c)}catch(a){console.error("Error fetching teachers:",a)}},A=async()=>{try{let b=await fetch("/api/timetable/my-schedule",{headers:{Authorization:`Bearer ${await a?.getIdToken()}`}}),c=await b.json();c.success&&(p(c.data.weeklySchedule||{}),r(c.data.substitutions||[]))}catch(a){console.error(a)}finally{t(!1)}},B=a=>w.some(b=>{let c=b.date?.seconds?new Date(1e3*b.date.seconds):b.createdAt?.seconds?new Date(1e3*b.createdAt.seconds):new Date,d=b.expiresAt?.seconds?new Date(1e3*b.expiresAt.seconds):new Date;return c.setHours(0,0,0,0),d.setHours(23,59,59,999),a>=c&&a<=d}),C=(()=>{let a=new Date,b=a.toLocaleDateString("en-US",{weekday:"long"}).toUpperCase(),c=a.toISOString().split("T")[0];if(B(a))return{dayName:b,dateKey:c,slots:[],isHoliday:!0};if(!o||!o[b])return{dayName:b,dateKey:c,slots:[]};let d=[],e=o[b]||{};for(let a=1;a<=8;a++){let b=q.find(b=>b.date===c&&b.slotId===a&&"ORIGINAL"===b.role),f=q.find(b=>b.date===c&&b.slotId===a&&"SUBSTITUTE"===b.role);if(f){d.push({id:a,type:"SUBSTITUTION",classId:f.classId,note:"Substitution",originalTeacherId:f.originalTeacherId});continue}if(b){d.push({id:a,type:"LEAVE",...e[a],note:"LEISURE"===b.resolutionType?"Marked Leisure":"Subst. Assigned"});continue}let g=e[a];if(g){let b="string"==typeof g?g:g.classId,c="object"==typeof g?g.subjectId:null;d.push({id:a,type:"REGULAR",classId:b,subjectId:c})}}return{dayName:b,dateKey:c,slots:d,isHoliday:!1}})();return s?(0,b.jsx)("div",{className:"p-10 flex justify-center",children:(0,b.jsx)(h.Loader2,{className:"animate-spin"})}):(0,b.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto p-4 md:p-6 animate-in fade-in",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(g.default,{href:"/teacher",className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-white transition-colors mb-2",children:[(0,b.jsx)(j.ArrowLeft,{className:"w-4 h-4"})," Back to Dashboard"]}),(0,b.jsx)("h1",{className:"text-3xl font-display font-bold",children:"My Schedule"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Teacher Portal"})]}),(0,b.jsxs)(e.Card,{className:`overflow-hidden relative border-white/10 ${C.isHoliday?"bg-red-500/10 border-red-500/20":"bg-black/20"}`,children:[(0,b.jsx)("div",{className:`absolute top-0 left-0 w-1 h-full ${C.isHoliday?"bg-red-500":"bg-blue-500"}`}),(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)(e.CardTitle,{className:"flex justify-between",children:[(0,b.jsxs)("span",{children:["Today (",C.dayName,")"]}),(0,b.jsx)("span",{className:"text-sm font-normal text-muted-foreground",children:C.dateKey})]})}),(0,b.jsx)(e.CardContent,{children:C.isHoliday?(0,b.jsxs)("div",{className:"py-12 flex flex-col items-center justify-center text-red-400 gap-4",children:[(0,b.jsx)(i.Calendar,{className:"w-12 h-12 opacity-50"}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h3",{className:"text-2xl font-bold uppercase tracking-widest",children:"Holiday"}),(0,b.jsx)("p",{className:"text-sm text-red-400/60 mt-1",children:"School is closed for today. Enjoy your rest!"})]})]}):0===C.slots.length?(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No classes today."}):(0,b.jsx)("div",{className:"space-y-2",children:C.slots.map(a=>(0,b.jsxs)("div",{className:`p-4 rounded border flex items-center justify-between
                                         ${"SUBSTITUTION"===a.type?"bg-blue-500/10 border-blue-500/30":"LEAVE"===a.type?"bg-red-500/10 border-red-500/30 opacity-60 dashed-border":"bg-white/5 border-white/10"}
                                     `,children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(f.Badge,{variant:"outline",className:"w-8 h-8 flex items-center justify-center rounded-full bg-white/5",children:a.id}),(0,b.jsxs)("div",{children:["LEAVE"===a.type?(0,b.jsxs)("div",{className:"line-through text-muted-foreground",children:["Class ",a.classId]}):(0,b.jsxs)("div",{className:"font-bold text-lg",children:["Class ",a.classId]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"SUBSTITUTION"===a.type?(0,b.jsxs)("span",{className:"text-blue-400",children:["Covering for ",u[a.originalTeacherId]||a.originalTeacherId]}):"LEAVE"===a.type?(0,b.jsxs)("span",{className:"text-red-400",children:["On Leave (",a.note,")"]}):n[a.subjectId]?.name||a.subjectId||"Regular Class"})]})]}),"SUBSTITUTION"===a.type&&(0,b.jsx)(f.Badge,{children:"SUBSTITUTION"}),"LEAVE"===a.type&&(0,b.jsx)(f.Badge,{variant:"destructive",children:"ON LEAVE"})]},a.id))})})]}),(0,b.jsxs)(e.Card,{className:"bg-black/20 border-white/10",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Weekly Overview"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-white/10",children:[(0,b.jsx)("th",{className:"p-3 text-left",children:"Day"}),[1,2,3,4,5,6,7,8].map(a=>(0,b.jsxs)("th",{className:"p-3 text-center",children:["P",a]},a))]})}),(0,b.jsx)("tbody",{children:["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"].map((a,c)=>{let d=new Date,e=d.getDay(),f=new Date(d);f.setDate(d.getDate()+(c+1-e));let g=B(f);return(0,b.jsxs)("tr",{className:`border-b border-white/5 transition-colors ${g?"bg-red-500/5 text-red-400/50":"hover:bg-white/5"}`,children:[(0,b.jsxs)("td",{className:"p-3 font-medium text-muted-foreground flex flex-col",children:[(0,b.jsx)("span",{children:a.substring(0,3)}),(0,b.jsx)("span",{className:"text-[10px] opacity-40 font-normal",children:f.toLocaleDateString([],{month:"short",day:"numeric"})})]}),g?(0,b.jsx)("td",{colSpan:8,className:"p-3 text-center text-red-500/50 font-bold uppercase tracking-widest text-[10px]",children:"Holiday"}):[1,2,3,4,5,6,7,8].map(c=>{let d=`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}-${String(f.getDate()).padStart(2,"0")}`,e=q.find(a=>a.date===d&&a.slotId===c&&"ORIGINAL"===a.role),g=q.find(a=>a.date===d&&a.slotId===c&&"SUBSTITUTE"===a.role);if(g)return(0,b.jsxs)("td",{className:"p-3 text-center border-l border-white/5 bg-blue-500/10",children:[(0,b.jsx)("div",{className:"font-bold text-blue-400",children:g.classId}),(0,b.jsx)("div",{className:"text-[10px] uppercase font-bold text-blue-500/60",children:"Covering"})]},c);if(e)return(0,b.jsxs)("td",{className:"p-3 text-center border-l border-white/5 bg-red-500/10 opacity-40",children:[(0,b.jsx)("div",{className:"font-bold line-through text-red-500/50",children:"OFF"}),(0,b.jsx)("div",{className:"text-[10px] uppercase font-bold text-red-500/40",children:"On Leave"})]},c);let h=o?.[a]?.[c];if(!h)return(0,b.jsx)("td",{className:"p-3 border-l border-white/5"},c);let i="object"==typeof h?h.classId:h,j="object"==typeof h?h.subjectId:null;return(0,b.jsxs)("td",{className:"p-3 text-center border-l border-white/5",children:[(0,b.jsx)("div",{className:"font-bold",children:i}),j&&(0,b.jsx)("div",{className:"text-[10px] text-muted-foreground",children:n[j]?.name||j})]},c)})]},a)})})]})})})]})]})}a.s(["default",()=>n])}];

//# sourceMappingURL=_0987fe82._.js.map