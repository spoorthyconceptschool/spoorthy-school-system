{"version":3,"sources":["../../../../src/app/admin/fees/pending/page.tsx","../../../../src/components/admin/fee-slip-generator.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { collection, getDocs, query, orderBy, where } from \"firebase/firestore\";\r\nimport { db } from \"@/lib/firebase\";\r\nimport { Loader2, Download, Printer, Search, FileText, Bell, User, MapPin, ShieldAlert } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { useMasterData } from \"@/context/MasterDataContext\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { DataTable } from \"@/components/ui/data-table\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { useAuth } from \"@/context/AuthContext\";\r\nimport { toast } from \"@/lib/toast-store\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { FeeSlipGenerator } from \"@/components/admin/fee-slip-generator\";\r\n\r\nexport default function FeePendingsPage() {\r\n    const [ledgers, setLedgers] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [search, setSearch] = useState(\"\");\r\n    const [classFilter, setClassFilter] = useState(\"all\");\r\n    const [villageFilter, setVillageFilter] = useState(\"all\");\r\n    const router = useRouter();\r\n\r\n    const { user } = useAuth();\r\n\r\n    // Report Wizard State\r\n    const [isWizardOpen, setIsWizardOpen] = useState(false);\r\n    const [wizardType, setWizardType] = useState<'csv' | 'table' | 'notify'>('table');\r\n    const [selectedClasses, setSelectedClasses] = useState<string[]>([]);\r\n    const [selectedVillages, setSelectedVillages] = useState<string[]>([]);\r\n    const [sending, setSending] = useState(false);\r\n\r\n    const { classes: classesData, villages: villagesData, branding } = useMasterData();\r\n    const classes = Object.values(classesData || {}).map((c: any) => ({ id: c.id, name: c.name, order: c.order || 99 })).sort((a: any, b: any) => a.order - b.order);\r\n    const villages = Object.values(villagesData || {}).map((v: any) => ({ id: v.id, name: v.name })).sort((a: any, b: any) => a.name.localeCompare(b.name));\r\n\r\n    const fetchPendings = async () => {\r\n        try {\r\n            // 1. Fetch ledgers with pending status\r\n            const q = query(collection(db, \"student_fee_ledgers\"), where(\"status\", \"==\", \"PENDING\"));\r\n            const snap = await getDocs(q);\r\n            const rawLedgers: any[] = snap.docs.map(d => {\r\n                const data = d.data();\r\n                return {\r\n                    id: d.id,\r\n                    ...data,\r\n                    pendingAmount: (data.totalFee || 0) - (data.totalPaid || 0)\r\n                };\r\n            }).filter(l => l.pendingAmount > 0);\r\n\r\n            // 2. Fetch all students to join rich data (parent info, village, etc)\r\n            const studentsSnap = await getDocs(collection(db, \"students\"));\r\n            const studentMap: Record<string, any> = {};\r\n            studentsSnap.docs.forEach(d => {\r\n                const sData = d.data();\r\n                if (sData.schoolId && sData.status === \"ACTIVE\") studentMap[sData.schoolId] = sData;\r\n            });\r\n\r\n            // 3. Perform Join & Enrichment\r\n            const joined = rawLedgers.map(l => {\r\n                const student = studentMap[l.studentId];\r\n                if (!student) return null; // Skip non-active students\r\n\r\n                // Calculate breakdowns\r\n                let termPending = 0;\r\n                let transportPending = 0;\r\n                let customPending = 0;\r\n\r\n                // Simple logic: if totalPaid > 0, we deduct from term first, then transport, then custom\r\n                // But a better way is to check the ledger items if we had individual paid status.\r\n                // Since our system currently tracks totalPaid vs totalFee, we'll show the items totals for now.\r\n                // Or better: show \"Total Pending\" but also show what items exist.\r\n\r\n                const transportItem = l.items?.find((i: any) => i.type === \"TRANSPORT\");\r\n                const transportFee = transportItem?.amount || 0;\r\n\r\n                const customItems = l.items?.filter((i: any) => i.type === \"CUSTOM\");\r\n                const customFee = customItems?.reduce((sum: number, i: any) => sum + (i.amount || 0), 0) || 0;\r\n\r\n                return {\r\n                    ...l,\r\n                    parentName: student.parentName || \"N/A\",\r\n                    parentMobile: student.parentMobile || \"N/A\",\r\n                    villageId: student.villageId || \"\",\r\n                    villageName: student.villageName || \"N/A\",\r\n                    sectionName: student.sectionName || \"\",\r\n                    transportFee,\r\n                    customFee\r\n                };\r\n            }).filter(Boolean).sort((a, b) => b!.pendingAmount - a!.pendingAmount);\r\n\r\n            setLedgers(joined as any[]);\r\n        } catch (e) {\r\n            console.error(\"Fetch Pendings Error:\", e);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchPendings();\r\n    }, []);\r\n\r\n    const filtered = ledgers.filter(l => {\r\n        const matchesSearch = !search ||\r\n            l.studentId?.toLowerCase().includes(search.toLowerCase()) ||\r\n            l.studentName?.toLowerCase().includes(search.toLowerCase()) ||\r\n            l.parentName?.toLowerCase().includes(search.toLowerCase()) ||\r\n            l.parentMobile?.toLowerCase().includes(search.toLowerCase()) ||\r\n            l.villageName?.toLowerCase().includes(search.toLowerCase()) ||\r\n            l.className?.toLowerCase().includes(search.toLowerCase());\r\n\r\n        const matchesClass = classFilter === \"all\" || l.classId === classFilter || l.className === classFilter;\r\n        const matchesVillage = villageFilter === \"all\" || l.villageId === villageFilter || l.villageName === villageFilter;\r\n\r\n        return matchesSearch && matchesClass && matchesVillage;\r\n    });\r\n\r\n    const exportToCSV = (targetData: any[]) => {\r\n        const headers = [\"School ID\", \"Student Name\", \"Parent Name\", \"Mobile\", \"Village\", \"Class\", \"Term Fee\", \"Transport Fee\", \"Custom Fee\", \"Total Fee\", \"Paid\", \"Pending Balance\"];\r\n        const rows = targetData.map(l => [\r\n            l.studentId,\r\n            l.studentName,\r\n            l.parentName,\r\n            l.parentMobile || \"\",\r\n            l.villageName,\r\n            l.className,\r\n            (l.totalFee || 0) - (l.transportFee || 0) - (l.customFee || 0),\r\n            l.transportFee || 0,\r\n            l.customFee || 0,\r\n            l.totalFee,\r\n            l.totalPaid,\r\n            l.pendingAmount\r\n        ]);\r\n\r\n        const csvContent = [headers, ...rows].map(e => e.join(\",\")).join(\"\\n\");\r\n        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n        const link = document.createElement(\"a\");\r\n        const url = URL.createObjectURL(blob);\r\n        link.setAttribute(\"href\", url);\r\n        link.setAttribute(\"download\", `pending_dues_${new Date().toISOString().split('T')[0]}.csv`);\r\n        link.style.visibility = 'hidden';\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n        setIsWizardOpen(false);\r\n    };\r\n\r\n    const handlePrint = (targetData: any[]) => {\r\n        const printWindow = window.open('', '_blank');\r\n        if (!printWindow) return;\r\n\r\n        const timestamp = new Date().toLocaleString();\r\n        const subsetTotalDues = targetData.reduce((sum, l) => sum + (l.pendingAmount || 0), 0);\r\n\r\n        const content = `\r\n                <html>\r\n                <head>\r\n                    <title>Dues Report</title>\r\n                    <style>\r\n                        body { font-family: sans-serif; padding: 20px; color: #333; }\r\n                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }\r\n                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 11px; }\r\n                        th { background-color: #f2f2f2; }\r\n                        h1 { text-align: center; color: #cc0000; margin-bottom: 5px; }\r\n                        .header-meta { text-align: center; font-size: 12px; color: #666; margin-bottom: 20px; }\r\n                        .summary { margin: 20px 0; font-weight: bold; border: 1px solid #ffcccc; padding: 10px; background: #fff5f5; border-radius: 5px; }\r\n                        .branding { display: flex; align-items: center; justify-content: center; gap: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 20px; }\r\n                        .school-info h1 { margin: 0; font-size: 24px; text-align: left; }\r\n                        .school-info p { margin: 2px 0; font-size: 12px; color: #666; }\r\n                    </style>\r\n                </head>\r\n                <body>\r\n                    <div class=\"branding\">\r\n                        ${branding?.schoolLogo ? `<img src=\"${branding.schoolLogo}\" style=\"height: 60px;\" />` : ''}\r\n                        <div class=\"school-info\">\r\n                            <h1>${branding?.schoolName}</h1>\r\n                            <p>${branding?.address || \"\"}</p>\r\n                            <p><strong>Pending Dues Report</strong> | ${timestamp}</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"summary\">\r\n                        Total Outstanding: ₹${subsetTotalDues.toLocaleString()} | Total Pending Accounts: ${targetData.length}\r\n                    </div>\r\n                    <table>\r\n                        <thead>\r\n                            <tr>\r\n                                <th>Student Name</th>\r\n                                <th>Class & Sec</th>\r\n                                <th>Village</th>\r\n                                <th>Parent Name</th>\r\n                                <th>Parent Mobile</th>\r\n                                <th>Transport Fee</th>\r\n                                <th>Custom Fees</th>\r\n                                <th>Total Fee</th>\r\n                                <th>Paid</th>\r\n                                <th style=\"background: #ffe6e6;\">Balance Due</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            ${targetData.map(l => `\r\n                                <tr>\r\n                                    <td style=\"font-weight:bold;\">${l.studentName}</td>\r\n                                    <td>${l.className} - ${l.sectionName || ''}</td>\r\n                                    <td>${l.villageName}</td>\r\n                                    <td>${l.parentName}</td>\r\n                                    <td style=\"font-weight:bold; color: #1a56db;\">${l.parentMobile || \"\"}</td>\r\n                                    <td>₹${(l.transportFee || 0).toLocaleString()}</td>\r\n                                    <td>₹${(l.customFee || 0).toLocaleString()}</td>\r\n                                    <td>₹${l.totalFee?.toLocaleString()}</td>\r\n                                    <td>₹${l.totalPaid?.toLocaleString()}</td>\r\n                                    <td style=\"color:red; font-weight:black; font-size: 13px;\">₹${l.pendingAmount?.toLocaleString()}</td>\r\n                                </tr>\r\n                            `).join('')}\r\n                        </tbody>\r\n                    </table>\r\n                    <script>\r\n                        window.onload = () => { window.print(); window.close(); };\r\n                    </script>\r\n                </body>\r\n                </html>\r\n            `;\r\n\r\n        printWindow.document.write(content);\r\n        printWindow.document.close();\r\n        setIsWizardOpen(false);\r\n    };\r\n\r\n    const handleGenerateReport = async () => {\r\n        if (wizardType === 'notify') {\r\n            setSending(true);\r\n            try {\r\n                const token = await user?.getIdToken();\r\n                const res = await fetch(\"/api/admin/fees/notify\", {\r\n                    method: \"POST\",\r\n                    headers: {\r\n                        \"Content-Type\": \"application/json\",\r\n                        \"Authorization\": `Bearer ${token}`\r\n                    },\r\n                    body: JSON.stringify({ selectedClasses, selectedVillages })\r\n                });\r\n                const data = await res.json();\r\n                if (data.success) {\r\n                    toast({ title: \"Notifications Sent\", description: data.message, type: \"success\" });\r\n                    setIsWizardOpen(false);\r\n                } else {\r\n                    throw new Error(data.error || \"Failed to send notifications\");\r\n                }\r\n            } catch (e: any) {\r\n                toast({ title: \"Error\", description: e.message, type: \"error\" });\r\n            } finally {\r\n                setSending(false);\r\n            }\r\n            return;\r\n        }\r\n\r\n        const targetData = ledgers.filter(l => {\r\n            const matchesClass = selectedClasses.length === 0 || selectedClasses.includes(l.classId) || selectedClasses.includes(l.className);\r\n            const matchesVillage = selectedVillages.length === 0 || selectedVillages.includes(l.villageId) || selectedVillages.includes(l.villageName);\r\n            return matchesClass && matchesVillage;\r\n        });\r\n\r\n        if (wizardType === 'csv') exportToCSV(targetData);\r\n        else handlePrint(targetData);\r\n    };\r\n\r\n    const totalDuesAmount = filtered.reduce((sum, l) => sum + (l.pendingAmount || 0), 0);\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in fade-in duration-500 max-w-none p-0 pb-20\">\r\n            {/* Header */}\r\n            <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between pt-4 gap-6 px-2 md:px-0\">\r\n                <div>\r\n                    <h1 className=\"text-3xl md:text-5xl font-display font-bold bg-gradient-to-r from-red-500 to-orange-400 bg-clip-text text-transparent italic leading-tight\">\r\n                        Pending Dues\r\n                    </h1>\r\n                    <p className=\"text-muted-foreground text-sm md:text-lg tracking-tight\">Recovering <span className=\"text-white font-bold\">outstanding school fees</span></p>\r\n                </div>\r\n\r\n                <div className=\"flex flex-wrap items-center gap-2 md:gap-3\">\r\n                    <Button\r\n                        variant=\"destructive\"\r\n                        className=\"h-11 gap-2 bg-red-600/10 border-red-500/20 text-red-400 rounded-xl hover:bg-red-600 hover:text-white transition-all shadow-lg shadow-red-500/10\"\r\n                        onClick={() => { setWizardType('notify'); setIsWizardOpen(true); }}\r\n                    >\r\n                        <Bell size={16} /> <span className=\"hidden sm:inline\">Bulk Notify</span><span className=\"sm:hidden\">Notify</span>\r\n                    </Button>\r\n                    <FeeSlipGenerator\r\n                        students={ledgers.map(l => ({\r\n                            schoolId: l.studentId,\r\n                            studentName: l.studentName,\r\n                            className: l.className,\r\n                            sectionName: l.sectionName || \"\"\r\n                        }))}\r\n                    />\r\n                    <Button variant=\"outline\" onClick={() => { setWizardType('table'); setIsWizardOpen(true); }} className=\"h-11 gap-2 border-white/10 bg-white/5 rounded-xl hover:bg-white/10\">\r\n                        <Printer size={16} /> <span className=\"hidden sm:inline\">Print Dues List</span><span className=\"sm:hidden\">Print</span>\r\n                    </Button>\r\n                    <Button variant=\"outline\" onClick={() => { setWizardType('csv'); setIsWizardOpen(true); }} className=\"h-11 gap-2 border-white/10 bg-white/5 rounded-xl hover:bg-white/10\">\r\n                        <Download size={16} /> <span className=\"hidden sm:inline\">Export CSV</span><span className=\"sm:hidden\">CSV</span>\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Stats Overview */}\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 px-2 md:px-0\">\r\n                <div className=\"bg-red-500/5 border border-red-500/10 p-5 rounded-2xl backdrop-blur-sm shadow-xl flex items-center gap-4\">\r\n                    <div className=\"w-12 h-12 rounded-2xl bg-red-500/20 flex items-center justify-center\">\r\n                        <ShieldAlert size={24} className=\"text-red-400\" />\r\n                    </div>\r\n                    <div>\r\n                        <p className=\"text-[10px] font-black uppercase tracking-widest text-red-400 mb-0.5 italic\">Total Outstanding</p>\r\n                        <div className=\"text-3xl font-mono font-black text-white\">₹{totalDuesAmount.toLocaleString()}</div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"bg-orange-500/5 border border-orange-500/10 p-5 rounded-2xl backdrop-blur-sm shadow-xl flex items-center gap-4\">\r\n                    <div className=\"w-12 h-12 rounded-2xl bg-orange-500/20 flex items-center justify-center\">\r\n                        <User size={24} className=\"text-orange-400\" />\r\n                    </div>\r\n                    <div>\r\n                        <p className=\"text-[10px] font-black uppercase tracking-widest text-orange-400 mb-0.5 italic\">Pending Accounts</p>\r\n                        <div className=\"text-3xl font-mono font-black text-white\">{filtered.length} <span className=\"text-xs text-orange-400/50\">Students</span></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Filters */}\r\n            <div className=\"bg-black/20 p-4 md:p-5 rounded-2xl border border-white/10 backdrop-blur-md space-y-4 shadow-2xl mx-2 md:mx-0\">\r\n                <div className=\"relative w-full\">\r\n                    <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\r\n                    <Input\r\n                        placeholder=\"Search by student name, parent, or mobile...\"\r\n                        className=\"pl-11 h-12 bg-white/5 border-white/10 rounded-xl focus:ring-accent/30\"\r\n                        value={search}\r\n                        onChange={e => setSearch(e.target.value)}\r\n                    />\r\n                </div>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:flex lg:flex-wrap gap-2\">\r\n                    <Select value={classFilter} onValueChange={setClassFilter}>\r\n                        <SelectTrigger className=\"w-full lg:w-[180px] h-12 bg-white/5 border-white/10 rounded-xl\">\r\n                            <SelectValue placeholder=\"All Classes\" />\r\n                        </SelectTrigger>\r\n                        <SelectContent className=\"bg-zinc-900 border-white/10 text-white\">\r\n                            <SelectItem value=\"all\">All Classes</SelectItem>\r\n                            {classes.map(c => <SelectItem key={c.id} value={c.id}>{c.name}</SelectItem>)}\r\n                        </SelectContent>\r\n                    </Select>\r\n                    <Select value={villageFilter} onValueChange={setVillageFilter}>\r\n                        <SelectTrigger className=\"w-full lg:w-[180px] h-12 bg-white/5 border-white/10 rounded-xl\">\r\n                            <SelectValue placeholder=\"All Villages\" />\r\n                        </SelectTrigger>\r\n                        <SelectContent className=\"bg-zinc-900 border-white/10 text-white\">\r\n                            <SelectItem value=\"all\">All Villages</SelectItem>\r\n                            {villages.map(v => <SelectItem key={v.id} value={v.id}>{v.name}</SelectItem>)}\r\n                        </SelectContent>\r\n                    </Select>\r\n                    {(classFilter !== \"all\" || villageFilter !== \"all\" || search) && (\r\n                        <Button variant=\"ghost\" size=\"sm\" onClick={() => { setSearch(\"\"); setClassFilter(\"all\"); setVillageFilter(\"all\"); }} className=\"h-12 px-6 text-[10px] font-black uppercase tracking-widest text-muted-foreground hover:text-white rounded-xl border border-dashed border-white/10 transition-all\">\r\n                            Clear Filters\r\n                        </Button>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Content View */}\r\n            <DataTable\r\n                data={filtered}\r\n                isLoading={loading}\r\n                onRowClick={(l) => router.push(`/admin/students/${l.studentDocId || l.id}`)}\r\n                columns={[\r\n                    {\r\n                        key: \"studentName\",\r\n                        header: \"Student Info\",\r\n                        render: (l: any) => (\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center border border-white/5\">\r\n                                    <User size={14} className=\"text-white/40\" />\r\n                                </div>\r\n                                <div className=\"flex flex-col\">\r\n                                    <span className=\"font-bold text-sm text-white leading-tight group-hover:text-red-400 transition-colors uppercase\">{l.studentName}</span>\r\n                                    <span className=\"text-[10px] font-mono text-white/40 tracking-tighter uppercase\">{l.studentId}</span>\r\n                                </div>\r\n                            </div>\r\n                        )\r\n                    },\r\n                    {\r\n                        key: \"className\",\r\n                        header: \"Class & Village\",\r\n                        render: (l: any) => (\r\n                            <div className=\"flex flex-col gap-1\">\r\n                                <span className=\"text-[10px] uppercase font-black text-muted-foreground tracking-tighter bg-white/5 px-2 py-0.5 rounded border border-white/5 w-fit\">{l.className}</span>\r\n                                <div className=\"flex items-center gap-1 text-[10px] text-white/30\">\r\n                                    <MapPin size={10} />\r\n                                    <span className=\"truncate max-w-[120px]\">{l.villageName}</span>\r\n                                </div>\r\n                            </div>\r\n                        )\r\n                    },\r\n                    {\r\n                        key: \"totalFee\",\r\n                        header: \"Total Fee\",\r\n                        headerClassName: \"text-right\",\r\n                        cellClassName: \"text-right\",\r\n                        render: (l: any) => <span className=\"font-mono font-bold text-sm text-white/40 italic\">₹{l.totalFee?.toLocaleString()}</span>\r\n                    },\r\n                    {\r\n                        key: \"totalPaid\",\r\n                        header: \"Paid\",\r\n                        headerClassName: \"text-right\",\r\n                        cellClassName: \"text-right\",\r\n                        render: (l: any) => <span className=\"font-mono font-black text-sm text-emerald-400/60\">₹{l.totalPaid?.toLocaleString()}</span>\r\n                    },\r\n                    {\r\n                        key: \"pendingAmount\",\r\n                        header: \"Balance Due\",\r\n                        headerClassName: \"text-right\",\r\n                        cellClassName: \"text-right\",\r\n                        render: (l: any) => (\r\n                            <div className=\"flex flex-col items-end\">\r\n                                <span className=\"font-mono font-black text-lg text-red-500\">₹{l.pendingAmount?.toLocaleString()}</span>\r\n                                {l.totalPaid > 0 && <span className=\"text-[8px] font-black text-emerald-500/50 uppercase tracking-tighter\">Partially Paid</span>}\r\n                            </div>\r\n                        )\r\n                    },\r\n                    {\r\n                        key: \"parentName\",\r\n                        header: \"Parent Info\",\r\n                        render: (l: any) => (\r\n                            <div className=\"flex flex-col\">\r\n                                <span className=\"text-sm font-semibold text-white/90\">{l.parentName || \"N/A\"}</span>\r\n                                <span className=\"text-[10px] font-mono text-emerald-400\">{l.parentMobile || \"N/A\"}</span>\r\n                            </div>\r\n                        )\r\n                    },\r\n                    {\r\n                        key: \"breakdown\",\r\n                        header: \"Breakdown\",\r\n                        render: (l: any) => (\r\n                            <div className=\"flex flex-col gap-0.5 text-[10px]\">\r\n                                <span className=\"text-white/40 italic\">Transport: ₹{l.transportFee || 0}</span>\r\n                                <span className=\"text-white/40 italic\">Custom: ₹{l.customFee || 0}</span>\r\n                            </div>\r\n                        )\r\n                    },\r\n                    {\r\n                        key: \"status\",\r\n                        header: \"Status\",\r\n                        headerClassName: \"text-center\",\r\n                        cellClassName: \"text-center\",\r\n                        render: (l: any) => (\r\n                            <Badge variant=\"destructive\" className=\"text-[9px] font-black uppercase tracking-tighter py-0 h-5 border-none bg-red-500/20 text-red-400 hover:bg-red-500/30\">\r\n                                {l.status}\r\n                            </Badge>\r\n                        )\r\n                    }\r\n                ]}\r\n                actions={(l) => (\r\n                    <div className=\"flex flex-col gap-1\">\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            onClick={() => router.push(`/admin/students/${l.studentDocId || l.id}`)}\r\n                            className=\"w-full justify-start gap-2 h-9 text-xs font-bold uppercase tracking-tighter text-red-400 hover:text-white hover:bg-red-500/20\"\r\n                        >\r\n                            Collect Fees\r\n                        </Button>\r\n                    </div>\r\n                )}\r\n            />\r\n\r\n            <Dialog open={isWizardOpen} onOpenChange={setIsWizardOpen}>\r\n                <DialogContent className=\"max-w-2xl bg-[#0A192F] border-white/10 text-white shadow-2xl backdrop-blur-3xl rounded-3xl\">\r\n                    <DialogHeader>\r\n                        <DialogTitle className=\"text-2xl font-display font-bold italic bg-gradient-to-r from-red-500 to-orange-400 bg-clip-text text-transparent\">\r\n                            {wizardType === 'notify' ? 'Fee Notification Wizard' : 'Report Configuration'}\r\n                        </DialogTitle>\r\n                    </DialogHeader>\r\n\r\n                    <div className=\"space-y-6 py-4\">\r\n                        {wizardType === 'notify' && (\r\n                            <div className=\"p-4 bg-red-500/10 border border-red-500/20 rounded-2xl text-[11px] text-red-200/80 leading-relaxed italic\">\r\n                                <strong className=\"text-red-400 block mb-1\">Warning:</strong>\r\n                                Bulk notifications will be sent to parents of students with outstanding dues in the selected categories. This action is tracked in the system audit logs.\r\n                            </div>\r\n                        )}\r\n                        <div className=\"grid grid-cols-2 gap-8\">\r\n                            {/* Classes Section */}\r\n                            <div className=\"space-y-3 p-4 bg-white/5 rounded-2xl border border-white/5\">\r\n                                <Label className=\"text-[10px] font-black uppercase tracking-widest text-emerald-400\">Target Classes</Label>\r\n                                <div className=\"max-h-[300px] overflow-y-auto space-y-2 pr-2 custom-scrollbar\">\r\n                                    <div className=\"flex items-center gap-3 pb-2 border-b border-white/5\">\r\n                                        <Checkbox\r\n                                            id=\"all-classes\"\r\n                                            className=\"border-white/20 data-[state=checked]:bg-emerald-500 data-[state=checked]:border-emerald-500\"\r\n                                            checked={selectedClasses.length === 0}\r\n                                            onCheckedChange={(checked) => checked ? setSelectedClasses([]) : null}\r\n                                        />\r\n                                        <Label htmlFor=\"all-classes\" className=\"text-sm font-bold opacity-80 cursor-pointer\">All Classes</Label>\r\n                                    </div>\r\n                                    {classes.map(c => (\r\n                                        <div key={c.id} className=\"flex items-center gap-3 py-1\">\r\n                                            <Checkbox\r\n                                                id={`class-${c.id}`}\r\n                                                className=\"border-white/10 data-[state=checked]:bg-emerald-500 data-[state=checked]:border-emerald-500\"\r\n                                                checked={selectedClasses.includes(c.id)}\r\n                                                onCheckedChange={(checked) => {\r\n                                                    if (checked) setSelectedClasses([...selectedClasses, c.id]);\r\n                                                    else setSelectedClasses(selectedClasses.filter(id => id !== c.id));\r\n                                                }}\r\n                                            />\r\n                                            <Label htmlFor={`class-${c.id}`} className=\"text-xs font-medium opacity-60 cursor-pointer hover:opacity-100 transition-opacity\">{c.name}</Label>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Villages Section */}\r\n                            <div className=\"space-y-3 p-4 bg-white/5 rounded-2xl border border-white/5\">\r\n                                <Label className=\"text-[10px] font-black uppercase tracking-widest text-cyan-400\">Target Villages</Label>\r\n                                <div className=\"max-h-[300px] overflow-y-auto space-y-2 pr-2 custom-scrollbar\">\r\n                                    <div className=\"flex items-center gap-3 pb-2 border-b border-white/5\">\r\n                                        <Checkbox\r\n                                            id=\"all-villages\"\r\n                                            className=\"border-white/20 data-[state=checked]:bg-cyan-500 data-[state=checked]:border-cyan-500\"\r\n                                            checked={selectedVillages.length === 0}\r\n                                            onCheckedChange={(checked) => checked ? setSelectedVillages([]) : null}\r\n                                        />\r\n                                        <Label htmlFor=\"all-villages\" className=\"text-sm font-bold opacity-80 cursor-pointer\">All Villages</Label>\r\n                                    </div>\r\n                                    {villages.map(v => (\r\n                                        <div key={v.id} className=\"flex items-center gap-3 py-1\">\r\n                                            <Checkbox\r\n                                                id={`village-${v.id}`}\r\n                                                className=\"border-white/10 data-[state=checked]:bg-cyan-500 data-[state=checked]:border-cyan-500\"\r\n                                                checked={selectedVillages.includes(v.id)}\r\n                                                onCheckedChange={(checked) => {\r\n                                                    if (checked) setSelectedVillages([...selectedVillages, v.id]);\r\n                                                    else setSelectedVillages(selectedVillages.filter(id => id !== v.id));\r\n                                                }}\r\n                                            />\r\n                                            <Label htmlFor={`village-${v.id}`} className=\"text-xs font-medium opacity-60 cursor-pointer hover:opacity-100 transition-opacity\">{v.name}</Label>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <DialogFooter className=\"gap-2\">\r\n                        <Button variant=\"ghost\" onClick={() => setIsWizardOpen(false)} className=\"rounded-xl hover:bg-white/5\">Cancel</Button>\r\n                        <Button\r\n                            className={cn(\r\n                                \"text-white font-black uppercase tracking-tighter gap-2 rounded-xl border-none shadow-lg transition-all\",\r\n                                wizardType === 'notify' ? \"bg-red-600 hover:bg-red-500 shadow-red-500/20\" : \"bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 shadow-emerald-500/20\"\r\n                            )}\r\n                            onClick={handleGenerateReport}\r\n                            disabled={sending}\r\n                        >\r\n                            {sending ? <Loader2 className=\"animate-spin\" size={16} /> : (\r\n                                wizardType === 'csv' ? <Download size={16} /> :\r\n                                    wizardType === 'notify' ? <Bell size={16} /> : <Printer size={16} />\r\n                            )}\r\n                            {wizardType === 'notify' ? 'Dispatch Notifications' : 'Generate Dataset'}\r\n                        </Button>\r\n                    </DialogFooter>\r\n                </DialogContent>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Printer, Loader2, X, CheckCircle2, ChevronRight, FileText } from \"lucide-react\";\r\nimport { collection, query, where, getDocs } from \"firebase/firestore\";\r\nimport { db } from \"@/lib/firebase\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { useMasterData } from \"@/context/MasterDataContext\";\r\n\r\ninterface FeeSlipGeneratorProps {\r\n    students: any[];\r\n}\r\n\r\nexport function FeeSlipGenerator({ students }: FeeSlipGeneratorProps) {\r\n    const [open, setOpen] = useState(false);\r\n    const [loading, setLoading] = useState(false);\r\n    const [slips, setSlips] = useState<any[]>([]);\r\n    const [selectedClasses, setSelectedClasses] = useState<string[]>([]);\r\n    const [step, setStep] = useState<\"SELECT\" | \"PREVIEW\">(\"SELECT\");\r\n    const { branding } = useMasterData();\r\n\r\n    const availableClasses = Array.from(new Set(students.map(s => s.className))).filter(Boolean).sort();\r\n\r\n    useEffect(() => {\r\n        if (open) {\r\n            setSelectedClasses(availableClasses);\r\n            setStep(\"SELECT\");\r\n            setSlips([]);\r\n        }\r\n    }, [open]);\r\n\r\n    const handleClassToggle = (className: string) => {\r\n        setSelectedClasses(prev =>\r\n            prev.includes(className)\r\n                ? prev.filter(c => c !== className)\r\n                : [...prev, className]\r\n        );\r\n    };\r\n\r\n    const generateSlips = async () => {\r\n        if (selectedClasses.length === 0) {\r\n            alert(\"Please select at least one class\");\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            const ledgersRef = collection(db, \"student_fee_ledgers\");\r\n            const q = query(ledgersRef, where(\"academicYearId\", \"==\", \"2025-2026\"));\r\n            const lSnap = await getDocs(q);\r\n            const ledgerMap: Record<string, any> = {};\r\n            lSnap.forEach(doc => ledgerMap[doc.data().studentId] = doc.data());\r\n\r\n            const today = new Date().toISOString().split('T')[0];\r\n            const targetStudents = students.filter(s => selectedClasses.includes(s.className));\r\n\r\n            const processedSlips = targetStudents.map(s => {\r\n                const ledger = ledgerMap[s.schoolId];\r\n                if (!ledger) return null;\r\n\r\n                const sortedItems = (ledger.items || []).sort((a: any, b: any) => (a.dueDate || \"\").localeCompare(b.dueDate || \"\"));\r\n                const termItems = sortedItems.filter((item: any) => item.type === \"TERM\");\r\n                const transportItems = sortedItems.filter((item: any) => item.type === \"TRANSPORT\");\r\n                const customItems = sortedItems.filter((item: any) => item.type === \"CUSTOM\");\r\n\r\n                let totalPaidRemaining = ledger.totalPaid || 0;\r\n                let thisTerm = termItems.find((t: any) => t.dueDate >= today) || termItems[termItems.length - 1];\r\n\r\n                const pendingTerms: { name: string, total: number, pending: number, dueDate: string }[] = [];\r\n\r\n                termItems.forEach((term: any) => {\r\n                    const termAmount = term.amount || 0;\r\n                    const paid = Math.min(termAmount, totalPaidRemaining);\r\n                    const pending = termAmount - paid;\r\n                    totalPaidRemaining -= paid;\r\n\r\n                    if (pending > 0) {\r\n                        pendingTerms.push({\r\n                            name: term.name,\r\n                            total: termAmount,\r\n                            pending: pending,\r\n                            dueDate: term.dueDate\r\n                        });\r\n                    }\r\n                });\r\n\r\n                let busPending = 0;\r\n                transportItems.forEach((item: any) => {\r\n                    const paid = Math.min(item.amount || 0, totalPaidRemaining);\r\n                    busPending += (item.amount || 0) - paid;\r\n                    totalPaidRemaining -= paid;\r\n                });\r\n\r\n                let customPending = 0;\r\n                customItems.forEach((item: any) => {\r\n                    const paid = Math.min(item.amount || 0, totalPaidRemaining);\r\n                    customPending += (item.amount || 0) - paid;\r\n                    totalPaidRemaining -= paid;\r\n                });\r\n\r\n                const currentTermDueDate = thisTerm?.dueDate || \"\";\r\n                // Only show terms that are due or past due\r\n                const activePendingTerms = pendingTerms.filter(pt => pt.dueDate <= currentTermDueDate);\r\n\r\n                if (activePendingTerms.length === 0 && busPending <= 0 && customPending <= 0) return null;\r\n\r\n                const activePendingTotal = activePendingTerms.reduce((sum: number, pt: any) => sum + pt.pending, 0);\r\n                const totalDisplayPending = activePendingTotal + busPending + customPending;\r\n\r\n                return {\r\n                    name: s.studentName,\r\n                    id: s.schoolId,\r\n                    class: s.className,\r\n                    section: s.sectionName,\r\n                    totalFee: ledger.totalFee || 0,\r\n                    totalPending: totalDisplayPending,\r\n                    pendingTerms: activePendingTerms,\r\n                    busPending,\r\n                    customPending,\r\n                    printDate: new Date().toLocaleDateString('en-IN', { day: '2-digit', month: '2-digit', year: 'numeric' })\r\n                };\r\n            }).filter(Boolean);\r\n\r\n            setSlips(processedSlips);\r\n            setStep(\"PREVIEW\");\r\n        } catch (error) {\r\n            console.error(error);\r\n            alert(\"Failed to load fee data\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handlePrint = () => {\r\n        const printWindow = window.open('', '_blank');\r\n        if (!printWindow) return;\r\n\r\n        const groupedSlips: Record<string, any[]> = {};\r\n        slips.forEach(s => {\r\n            if (!groupedSlips[s.class]) groupedSlips[s.class] = [];\r\n            groupedSlips[s.class].push(s);\r\n        });\r\n\r\n        const html = `\r\n            <html>\r\n            <head>\r\n                <title>Fee Slips</title>\r\n                <style>\r\n                    @page { size: A4; margin: 0; }\r\n                    body { font-family: sans-serif; margin: 0; padding: 0; background: #fff; line-height: 1.1; }\r\n                    .slips-container { \r\n                        display: grid; \r\n                        grid-template-columns: 1fr 1fr; \r\n                        grid-template-rows: auto repeat(5, 1fr); \r\n                        gap: 1.5mm; \r\n                        height: 297mm;\r\n                        width: 210mm;\r\n                        padding: 4mm 6mm;\r\n                        box-sizing: border-box;\r\n                        page-break-after: always;\r\n                    }\r\n                    .slip { \r\n                        border: 2pt solid #000;\r\n                        padding: 2mm; \r\n                        display: flex; \r\n                        flex-direction: column; \r\n                        justify-content: flex-start;\r\n                        font-size: 8.5px;\r\n                        overflow: hidden;\r\n                        height: 100%;\r\n                        box-sizing: border-box;\r\n                        position: relative;\r\n                    }\r\n                    .header { text-align: center; border-bottom: 2pt solid #000; margin-bottom: 1mm; padding-bottom: 0.5mm; display: flex; align-items: center; justify-content: center; gap: 5mm; }\r\n                    .school-name { font-weight: 900; font-size: 11px; text-transform: uppercase; }\r\n                    .logo-mini { height: 25px; width: auto; object-fit: contain; }\r\n                    .title { font-size: 8px; font-weight: bold; background: #000; color: #fff; padding: 1px 4px; display: inline-block; }\r\n                    .row { display: flex; justify-content: space-between; margin-bottom: 0.5mm; }\r\n                    .label { color: #000; font-weight: bold; }\r\n                    .value { font-weight: bold; }\r\n                    \r\n                    .fee-table { width: 100%; border-collapse: collapse; margin-top: 1mm; }\r\n                    .fee-table th, .fee-table td { border: 0.5pt solid #000; padding: 0.3mm 1mm; text-align: left; font-size: 7.5px; }\r\n                    .fee-table th { background: #f0f0f0; font-weight: bold; }\r\n                    .fee-table td.amount { text-align: right; font-weight: 800; }\r\n                    \r\n                    .total-box-horizontal { \r\n                        border: 1.5pt solid #000; \r\n                        padding: 1mm 2mm; \r\n                        margin-top: 1.5mm; \r\n                        display: flex; \r\n                        justify-content: space-between; \r\n                        align-items: center;\r\n                        background: #000;\r\n                        color: #fff;\r\n                    }\r\n                    .total-label { font-size: 9px; font-weight: 900; letter-spacing: 0.5px; }\r\n                    .total-value { font-size: 11px; font-weight: 900; }\r\n                    .footer { text-align: center; font-size: 7px; color: #000; margin-top: auto; padding-top: 1mm; border-top: 0.5pt dashed #ccc; }\r\n                    .class-header { \r\n                        grid-column: span 2; \r\n                        text-align: center; \r\n                        font-weight: 900; \r\n                        font-size: 10px; \r\n                        color: #000; \r\n                        border-bottom: 1.5pt solid #000;\r\n                        margin-bottom: 1.5mm;\r\n                        padding: 0.5mm;\r\n                        text-transform: uppercase;\r\n                        letter-spacing: 1.5px;\r\n                    }\r\n                </style>\r\n            </head>\r\n            <body>\r\n                ${Object.entries(groupedSlips).map(([className, classSlips]) => {\r\n            const chunks = [];\r\n            for (let i = 0; i < classSlips.length; i += 10) {\r\n                chunks.push(classSlips.slice(i, i + 10));\r\n            }\r\n            return chunks.map(chunk => `\r\n                        <div class=\"slips-container\">\r\n                            <div class=\"class-header\">CLASS: ${className}</div>\r\n                            ${chunk.map(slip => `\r\n                                <div class=\"slip\">\r\n                                    <div class=\"header\">\r\n                                        ${branding?.schoolLogo ? `<img src=\"${branding.schoolLogo}\" class=\"logo-mini\" />` : ''}\r\n                                        <div>\r\n                                            <div class=\"school-name\">${branding?.schoolName}</div>\r\n                                            <div class=\"title\">FEE REMINDER SLIP</div>\r\n                                        </div>\r\n                                    </div>\r\n                                    \r\n                                    <div class=\"row\">\r\n                                        <span class=\"label\">Student:</span>\r\n                                        <span class=\"value\">${slip.name.toUpperCase()}</span>\r\n                                    </div>\r\n                                    <div class=\"row\">\r\n                                        <span class=\"label\">ID / Class:</span>\r\n                                        <span class=\"value\">${slip.id} (${slip.class}) ${slip.section ? `- ${slip.section}` : ''}</span>\r\n                                    </div>\r\n                                    <div class=\"row\">\r\n                                        <span class=\"label\">Print Date:</span>\r\n                                        <span class=\"value\">${slip.printDate}</span>\r\n                                    </div>\r\n                                    \r\n                                    <div style=\"margin: 0.5mm 0; border-top: 1pt solid #000;\"></div>\r\n                                    \r\n                                    <table class=\"fee-table\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                <th>Fee Particulars</th>\r\n                                                <th style=\"text-align:right\">Pending Amount</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            ${(slip.pendingTerms || []).map((pt: any) => `\r\n                                                <tr>\r\n                                                    <td>${pt.name}</td>\r\n                                                    <td class=\"amount\" style=\"color:#d32f2f\">₹${pt.pending}</td>\r\n                                                </tr>\r\n                                            `).join('')}\r\n                                            ${slip.busPending > 0 ? `\r\n                                                <tr>\r\n                                                    <td>Transport Fee</td>\r\n                                                    <td class=\"amount\">₹${slip.busPending}</td>\r\n                                                </tr>\r\n                                            ` : ''}\r\n                                            ${slip.customPending > 0 ? `\r\n                                                <tr>\r\n                                                    <td>Other Fees</td>\r\n                                                    <td class=\"amount\">₹${slip.customPending}</td>\r\n                                                </tr>\r\n                                            ` : ''}\r\n                                        </tbody>\r\n                                    </table>\r\n\r\n                                    <div class=\"total-box-horizontal\">\r\n                                        <span class=\"total-label\">PLEASE PAY TOTAL:</span>\r\n                                        <span class=\"total-value\">₹${slip.totalPending}</span>\r\n                                    </div>\r\n                                    \r\n                                    <div class=\"footer\">Kindly clear the dues at office. Thank you.</div>\r\n                                </div>\r\n                            `).join('')}\r\n                        </div>\r\n                    `).join('');\r\n        }).join('')}\r\n                <script>\r\n                    window.onload = () => { window.print(); window.close(); };\r\n                </script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        printWindow.document.write(html);\r\n        printWindow.document.close();\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={setOpen}>\r\n            <DialogTrigger asChild>\r\n                <Button\r\n                    variant=\"outline\"\r\n                    className=\"h-11 gap-2 border-white/10 bg-white/5 text-white/70 hover:bg-white/10 rounded-xl px-4 md:px-6 transition-all\"\r\n                >\r\n                    <FileText className=\"w-4 h-4\" /> <span className=\"hidden sm:inline\">Fee Slips</span><span className=\"sm:hidden\">Slips</span>\r\n                </Button>\r\n            </DialogTrigger>\r\n            <DialogContent className=\"bg-black/95 border-white/10 text-white max-w-lg\">\r\n                <DialogHeader>\r\n                    <DialogTitle className=\"flex items-center gap-2\">\r\n                        <Printer className=\"w-5 h-5 text-amber-500\" />\r\n                        Generate Fee Slips\r\n                    </DialogTitle>\r\n                </DialogHeader>\r\n\r\n                <div className=\"py-2\">\r\n                    {step === \"SELECT\" && (\r\n                        <div className=\"space-y-4\">\r\n                            <div className=\"bg-amber-500/5 border border-amber-500/10 p-3 rounded-lg text-xs text-amber-200/70\">\r\n                                Select the classes you want to generate slips for. Only students with pending term fees will be included.\r\n                            </div>\r\n\r\n                            <div className=\"flex justify-between items-center px-1\">\r\n                                <span className=\"text-sm font-medium text-muted-foreground uppercase tracking-wider\">Available Classes</span>\r\n                                <div className=\"flex gap-4\">\r\n                                    <Button\r\n                                        variant=\"link\"\r\n                                        className=\"text-amber-500 h-auto p-0 text-xs\"\r\n                                        onClick={() => setSelectedClasses(availableClasses)}\r\n                                    >\r\n                                        Select All\r\n                                    </Button>\r\n                                    <Button\r\n                                        variant=\"link\"\r\n                                        className=\"text-white/40 hover:text-white h-auto p-0 text-xs\"\r\n                                        onClick={() => setSelectedClasses([])}\r\n                                    >\r\n                                        Clear All\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-2 max-h-[300px] overflow-y-auto p-1 pr-2\">\r\n                                {availableClasses.map(c => (\r\n                                    <div\r\n                                        key={c}\r\n                                        className={`flex items-center space-x-3 p-3 rounded-lg border transition-all cursor-pointer ${selectedClasses.includes(c)\r\n                                            ? \"bg-amber-500/10 border-amber-500/30 text-white\"\r\n                                            : \"bg-white/5 border-white/5 text-muted-foreground hover:bg-white/10\"\r\n                                            }`}\r\n                                        onClick={() => handleClassToggle(c)}\r\n                                    >\r\n                                        <Checkbox\r\n                                            id={`class-${c}`}\r\n                                            checked={selectedClasses.includes(c)}\r\n                                            onCheckedChange={() => handleClassToggle(c)}\r\n                                            className=\"border-white/20 data-[state=checked]:bg-amber-500 data-[state=checked]:text-black\"\r\n                                        />\r\n                                        <label\r\n                                            htmlFor={`class-${c}`}\r\n                                            className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer\"\r\n                                        >\r\n                                            {c}\r\n                                        </label>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n\r\n                            <Button\r\n                                className=\"w-full h-12 bg-amber-500 text-black hover:bg-amber-600 font-bold gap-2 mt-4\"\r\n                                onClick={generateSlips}\r\n                                disabled={loading || selectedClasses.length === 0}\r\n                            >\r\n                                {loading ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : <ChevronRight className=\"w-5 h-5\" />}\r\n                                {loading ? \"Analyzing Data...\" : `Proceed with ${selectedClasses.length} Classes`}\r\n                            </Button>\r\n                        </div>\r\n                    )}\r\n\r\n                    {step === \"PREVIEW\" && (\r\n                        <div className=\"space-y-6\">\r\n                            <div className=\"p-4 bg-green-500/10 border border-green-500/20 rounded-lg flex items-center gap-4\">\r\n                                <div className=\"bg-green-500 p-2 rounded-full text-black\">\r\n                                    <CheckCircle2 className=\"w-6 h-6\" />\r\n                                </div>\r\n                                <div>\r\n                                    <p className=\"font-bold text-lg\">{slips.length} Slips Prepared</p>\r\n                                    <p className=\"text-xs text-muted-foreground\">Automatically grouped by class for easy sorting.</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"bg-white/5 border border-white/10 rounded-lg p-2 max-h-[200px] overflow-y-auto\">\r\n                                {slips.slice(0, 5).map(s => (\r\n                                    <div key={s.id} className=\"flex justify-between items-center p-2 border-b border-white/5 last:border-0 text-xs text-muted-foreground\">\r\n                                        <div className=\"flex flex-col\">\r\n                                            <span className=\"text-white font-medium\">{s.name}</span>\r\n                                            <span className=\"text-[10px]\">{s.class}</span>\r\n                                        </div>\r\n                                        <span className=\"text-amber-500 font-mono\">₹{s.totalPending}</span>\r\n                                    </div>\r\n                                ))}\r\n                                {slips.length > 5 && <p className=\"text-center py-2 text-[10px] text-muted-foreground italic\">And {slips.length - 5} others...</p>}\r\n                            </div>\r\n\r\n                            <div className=\"flex gap-3 pt-4\">\r\n                                <Button className=\"flex-1 bg-white text-black hover:bg-white/90 font-bold h-12 gap-2 text-lg\" onClick={handlePrint}>\r\n                                    <Printer className=\"w-5 h-5\" /> Print All Slips\r\n                                </Button>\r\n                                <Button variant=\"ghost\" className=\"h-12 px-6\" onClick={() => setOpen(false)}>Close</Button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}