module.exports=[87487,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(99570),e=a.i(91119),f=a.i(41675),g=a.i(32860),h=a.i(16201),i=a.i(73570),j=a.i(96221),k=a.i(15618),l=a.i(99464),m=a.i(91965),n=a.i(24669),o=a.i(60246),p=a.i(14574),q=a.i(86304),r=a.i(66718),s=a.i(70430),t=a.i(80701),u=a.i(56025),v=a.i(56711),w={};!function a(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=!!(b.Worker&&b.Blob&&b.Promise&&b.OffscreenCanvas&&b.OffscreenCanvasRenderingContext2D&&b.HTMLCanvasElement&&b.HTMLCanvasElement.prototype.transferControlToOffscreen&&b.URL&&b.URL.createObjectURL),r="function"==typeof Path2D&&"function"==typeof DOMMatrix;function s(){}function t(a){var d=c.exports.Promise,e=void 0!==d?d:b.Promise;return"function"==typeof e?new e(a):(a(s,s),null)}var u=(f=function(){if(!b.OffscreenCanvas)return!1;try{var a=new OffscreenCanvas(1,1),c=a.getContext("2d");c.fillRect(0,0,1,1);var d=a.transferToImageBitmap();c.createPattern(d,"no-repeat")}catch(a){return!1}return!0}(),g=new Map,{transform:function(a){if(f)return a;if(g.has(a))return g.get(a);var b=new OffscreenCanvas(a.width,a.height);return b.getContext("2d").drawImage(a,0,0),g.set(a,b),b},clear:function(){g.clear()}}),v=(j=Math.floor(1e3/60),k={},l=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(h=function(a){var b=Math.random();return k[b]=requestAnimationFrame(function c(d){l===d||l+j-1<d?(l=d,delete k[b],a()):k[b]=requestAnimationFrame(c)}),b},i=function(a){k[a]&&cancelAnimationFrame(k[a])}):(h=function(a){return setTimeout(a,j)},i=function(a){return clearTimeout(a)}),{frame:h,cancel:i}),w=(o={},function(){if(m)return m;if(!d&&q){var b=["var CONFETTI, SIZE = {}, module = {};","("+a.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {\n  if (msg.data.options) {\n    CONFETTI(msg.data.options).then(function () {\n      if (msg.data.callback) {\n        postMessage({ callback: msg.data.callback });\n      }\n    });\n  } else if (msg.data.reset) {\n    CONFETTI && CONFETTI.reset();\n  } else if (msg.data.resize) {\n    SIZE.width = msg.data.resize.width;\n    SIZE.height = msg.data.resize.height;\n  } else if (msg.data.canvas) {\n    SIZE.width = msg.data.canvas.width;\n    SIZE.height = msg.data.canvas.height;\n    CONFETTI = module.exports.create(msg.data.canvas);\n  }\n}"].join("\n");try{m=new Worker(URL.createObjectURL(new Blob([b])))}catch(a){return"u">typeof console&&"function"==typeof console.warn&&console.warn("ðŸŽŠ Could not load worker",a),null}var c=m;function e(a,b){c.postMessage({options:a||{},callback:b})}c.init=function(a){var b=a.transferControlToOffscreen();c.postMessage({canvas:b},[b])},c.fire=function(a,b,d){if(n)return e(a,null),n;var f=Math.random().toString(36).slice(2);return n=t(function(b){function g(a){a.data.callback===f&&(delete o[f],c.removeEventListener("message",g),n=null,u.clear(),d(),b())}c.addEventListener("message",g),e(a,f),o[f]=g.bind(null,{data:{callback:f}})})},c.reset=function(){for(var a in c.postMessage({reset:!0}),o)o[a](),delete o[a]}}return m}),x={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function y(a,b,c){var d;return d=a&&null!=a[b]?a[b]:x[b],c?c(d):d}function z(a){return a<0?0:Math.floor(a)}function A(a){return parseInt(a,16)}function B(a){return a.map(C)}function C(a){var b=String(a).replace(/[^0-9a-f]/gi,"");return b.length<6&&(b=b[0]+b[0]+b[1]+b[1]+b[2]+b[2]),{r:A(b.substring(0,2)),g:A(b.substring(2,4)),b:A(b.substring(4,6))}}function D(a){a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight}function E(a){var b=a.getBoundingClientRect();a.width=b.width,a.height=b.height}function F(a,c){var f,g=!a,h=!!y(c||{},"resize"),i=!1,j=y(c,"disableForReducedMotion",Boolean),k=q&&y(c||{},"useWorker")?w():null,l=g?D:E,m=!!a&&!!k&&!!a.__confetti_initialized,n="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function o(c){var o,p=j||y(c,"disableForReducedMotion",Boolean),q=y(c,"zIndex",Number);if(p&&n)return t(function(a){a()});g&&f?a=f.canvas:g&&!a&&((o=document.createElement("canvas")).style.position="fixed",o.style.top="0px",o.style.left="0px",o.style.pointerEvents="none",o.style.zIndex=q,a=o,document.body.appendChild(a)),h&&!m&&l(a);var s={width:a.width,height:a.height};function w(){if(k){var b={getBoundingClientRect:function(){if(!g)return a.getBoundingClientRect()}};l(b),k.postMessage({resize:{width:b.width,height:b.height}});return}s.width=s.height=null}function x(){f=null,h&&(i=!1,b.removeEventListener("resize",w)),g&&a&&(document.body.contains(a)&&document.body.removeChild(a),a=null,m=!1)}return(k&&!m&&k.init(a),m=!0,k&&(a.__confetti_initialized=!0),h&&!i&&(i=!0,b.addEventListener("resize",w,!1)),k)?k.fire(c,s,x):function(b,c,g){for(var h,i,j,k,m,n,o,p=y(b,"particleCount",z),q=y(b,"angle",Number),s=y(b,"spread",Number),w=y(b,"startVelocity",Number),x=y(b,"decay",Number),A=y(b,"gravity",Number),C=y(b,"drift",Number),D=y(b,"colors",B),E=y(b,"ticks",Number),F=y(b,"shapes"),G=y(b,"scalar"),H=!!y(b,"flat"),I=((h=y(b,"origin",Object)).x=y(h,"x",Number),h.y=y(h,"y",Number),h),J=p,K=[],L=a.width*I.x,M=a.height*I.y;J--;)K.push(function(a){var b=a.angle*(Math.PI/180),c=a.spread*(Math.PI/180);return{x:a.x,y:a.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*a.startVelocity+Math.random()*a.startVelocity,angle2D:-b+(.5*c-Math.random()*c),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:a.color,shape:a.shape,tick:0,totalTicks:a.ticks,decay:a.decay,drift:a.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*a.gravity,ovalScalar:.6,scalar:a.scalar,flat:a.flat}}({x:L,y:M,angle:q,spread:s,startVelocity:w,color:D[J%D.length],shape:F[Math.floor(Math.random()*(F.length-0))+0],ticks:E,decay:x,gravity:A,drift:C,scalar:G,flat:H}));return f?f.addFettis(K):(i=a,m=K.slice(),n=i.getContext("2d"),o=t(function(a){function b(){j=k=null,n.clearRect(0,0,c.width,c.height),u.clear(),g(),a()}j=v.frame(function a(){d&&(c.width!==e.width||c.height!==e.height)&&(c.width=i.width=e.width,c.height=i.height=e.height),c.width||c.height||(l(i),c.width=i.width,c.height=i.height),n.clearRect(0,0,c.width,c.height),(m=m.filter(function(a){return function(a,b){b.x+=Math.cos(b.angle2D)*b.velocity+b.drift,b.y+=Math.sin(b.angle2D)*b.velocity+b.gravity,b.velocity*=b.decay,b.flat?(b.wobble=0,b.wobbleX=b.x+10*b.scalar,b.wobbleY=b.y+10*b.scalar,b.tiltSin=0,b.tiltCos=0,b.random=1):(b.wobble+=b.wobbleSpeed,b.wobbleX=b.x+10*b.scalar*Math.cos(b.wobble),b.wobbleY=b.y+10*b.scalar*Math.sin(b.wobble),b.tiltAngle+=.1,b.tiltSin=Math.sin(b.tiltAngle),b.tiltCos=Math.cos(b.tiltAngle),b.random=Math.random()+2);var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,s,t=b.tick++/b.totalTicks,v=b.x+b.random*b.tiltCos,w=b.y+b.random*b.tiltSin,x=b.wobbleX+b.random*b.tiltCos,y=b.wobbleY+b.random*b.tiltSin;if(a.fillStyle="rgba("+b.color.r+", "+b.color.g+", "+b.color.b+", "+(1-t)+")",a.beginPath(),r&&"path"===b.shape.type&&"string"==typeof b.shape.path&&Array.isArray(b.shape.matrix)){a.fill((c=b.shape.path,d=b.shape.matrix,e=b.x,f=b.y,g=.1*Math.abs(x-v),h=.1*Math.abs(y-w),i=Math.PI/10*b.wobble,j=new Path2D(c),(k=new Path2D).addPath(j,new DOMMatrix(d)),(l=new Path2D).addPath(k,new DOMMatrix([Math.cos(i)*g,Math.sin(i)*g,-Math.sin(i)*h,Math.cos(i)*h,e,f])),l))}else if("bitmap"===b.shape.type){var z=Math.PI/10*b.wobble,A=.1*Math.abs(x-v),B=.1*Math.abs(y-w),C=b.shape.bitmap.width*b.scalar,D=b.shape.bitmap.height*b.scalar,E=new DOMMatrix([Math.cos(z)*A,Math.sin(z)*A,-Math.sin(z)*B,Math.cos(z)*B,b.x,b.y]);E.multiplySelf(new DOMMatrix(b.shape.matrix));var F=a.createPattern(u.transform(b.shape.bitmap),"no-repeat");F.setTransform(E),a.globalAlpha=1-t,a.fillStyle=F,a.fillRect(b.x-C/2,b.y-D/2,C,D),a.globalAlpha=1}else if("circle"===b.shape)a.ellipse?a.ellipse(b.x,b.y,Math.abs(x-v)*b.ovalScalar,Math.abs(y-w)*b.ovalScalar,Math.PI/10*b.wobble,0,2*Math.PI):(m=b.x,n=b.y,o=Math.abs(x-v)*b.ovalScalar,p=Math.abs(y-w)*b.ovalScalar,q=Math.PI/10*b.wobble,s=2*Math.PI,a.save(),a.translate(m,n),a.rotate(q),a.scale(o,p),a.arc(0,0,1,0,s,void 0),a.restore());else if("star"===b.shape)for(var G=Math.PI/2*3,H=4*b.scalar,I=8*b.scalar,J=b.x,K=b.y,L=5,M=Math.PI/5;L--;)J=b.x+Math.cos(G)*I,K=b.y+Math.sin(G)*I,a.lineTo(J,K),G+=M,J=b.x+Math.cos(G)*H,K=b.y+Math.sin(G)*H,a.lineTo(J,K),G+=M;else a.moveTo(Math.floor(b.x),Math.floor(b.y)),a.lineTo(Math.floor(b.wobbleX),Math.floor(w)),a.lineTo(Math.floor(x),Math.floor(y)),a.lineTo(Math.floor(v),Math.floor(b.wobbleY));return a.closePath(),a.fill(),b.tick<b.totalTicks}(n,a)})).length?j=v.frame(a):b()}),k=b}),(f={addFettis:function(a){return m=m.concat(a),o},canvas:i,promise:o,reset:function(){j&&v.cancel(j),k&&k()}}).promise)}(c,s,x)}return o.reset=function(){k&&k.reset(),f&&f.reset()},o}function G(){return p||(p=F(null,{useWorker:!0,resize:!0})),p}c.exports=function(){return G().apply(this,arguments)},c.exports.reset=function(){G().reset()},c.exports.create=F,c.exports.shapeFromPath=function(a){if(!r)throw Error("path confetti are not supported in this browser");"string"==typeof a?d=a:(d=a.path,e=a.matrix);var b=new Path2D(d),c=document.createElement("canvas").getContext("2d");if(!e){for(var d,e,f,g,h=1e3,i=1e3,j=0,k=0,l=0;l<1e3;l+=2)for(var m=0;m<1e3;m+=2)c.isPointInPath(b,l,m,"nonzero")&&(h=Math.min(h,l),i=Math.min(i,m),j=Math.max(j,l),k=Math.max(k,m));f=j-h;var n=Math.min(10/f,10/(g=k-i));e=[n,0,0,n,-Math.round(f/2+h)*n,-Math.round(g/2+i)*n]}return{type:"path",path:d,matrix:e}},c.exports.shapeFromText=function(a){var b,c=1,d="#000000",e='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';"string"==typeof a?b=a:(b=a.text,c="scalar"in a?a.scalar:c,e="fontFamily"in a?a.fontFamily:e,d="color"in a?a.color:d);var f=10*c,g=""+f+"px "+e,h=new OffscreenCanvas(f,f),i=h.getContext("2d");i.font=g;var j=i.measureText(b),k=Math.ceil(j.actualBoundingBoxRight+j.actualBoundingBoxLeft),l=Math.ceil(j.actualBoundingBoxAscent+j.actualBoundingBoxDescent),m=j.actualBoundingBoxLeft+2,n=j.actualBoundingBoxAscent+2;k+=4,l+=4,(i=(h=new OffscreenCanvas(k,l)).getContext("2d")).font=g,i.fillStyle=d,i.fillText(b,m,n);var o=1/c;return{type:"bitmap",bitmap:h.transferToImageBitmap(),matrix:[o,0,0,o,-k*o/2,-l*o/2]}}}(function(){return"u">typeof self?self:this||{}}(),w,!1);let x=w.exports;function y(){let{user:a}=(0,u.useAuth)(),[w,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)("SETUP"),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(""),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(null),[T,U]=(0,c.useState)({label:"",startDate:"",endDate:""}),[V,W]=(0,c.useState)(!1),X=async()=>{try{let b=await a?.getIdToken(),c=await fetch("/api/admin/academic-years/history",{headers:{Authorization:`Bearer ${b}`}});if(c.ok){let a=await c.json();y(a.years||[])}}catch(a){console.error("Failed to fetch years",a)}finally{A(!1)}};(0,c.useEffect)(()=>{a&&X()},[a]);let Y=async()=>{if(L){O(!0);try{let b=await a?.getIdToken(),c=await fetch("/api/admin/academic-years/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({yearLabel:L})}),d=await c.json();d.success?(K(!1),M(""),X()):alert(d.error)}catch(a){alert(a.message)}finally{O(!1)}}},Z=async()=>{if(D){G("EXECUTING");try{let b=await a?.getIdToken(),c=await fetch("/api/admin/academic-years/start-new",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({newYearLabel:D})}),d=await c.json();d.success?(I(d.stats),G("DONE"),x({particleCount:150,spread:80,origin:{y:.6},colors:["#3b82f6","#10b981","#ffffff"]}),await X()):(alert("Error: "+d.error),G("SETUP"))}catch(a){alert("Error: "+a.message),G("SETUP")}}},$=a=>{S(a),U({label:a.year,startDate:a.startDate?new Date(a.startDate).toISOString().split("T")[0]:"",endDate:a.endDate?new Date(a.endDate).toISOString().split("T")[0]:""}),Q(!0)},_=async()=>{if(R){W(!0);try{let b={targetYear:R.year,newLabel:T.label,startDate:T.startDate?new Date(T.startDate).toISOString():null,endDate:T.endDate?new Date(T.endDate).toISOString():null},c=await a?.getIdToken(),d=await fetch("/api/admin/academic-years/update",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify(b)}),e=await d.json();e.success?(Q(!1),S(null),X()):alert(e.error)}catch(a){alert(a.message)}finally{W(!1)}}},aa=w.find(a=>a.isActive),ab=w.filter(a=>a.isUpcoming),ac=w.filter(a=>!a.isActive&&!a.isUpcoming).sort((a,b)=>b.year.localeCompare(a.year));return(0,b.jsxs)("div",{className:"space-y-4 md:space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-end gap-3 md:gap-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-0.5 md:mb-1",children:[(0,b.jsx)(m.History,{className:"w-4 h-4 md:w-5 md:h-5 text-blue-400"}),(0,b.jsx)("h2",{className:"text-base md:text-xl font-bold text-white",children:"Academic Lifecycle"})]}),(0,b.jsx)("p",{className:"text-[10px] md:text-sm text-slate-400",children:"Archiving, student promotion, and multi-year management."})]}),(0,b.jsxs)("div",{className:"flex gap-2 md:gap-3",children:[(0,b.jsxs)(d.Button,{onClick:()=>K(!0),variant:"outline",className:"bg-slate-900/50 border-slate-800 text-slate-300 hover:text-white h-8 md:h-10 text-[10px] md:text-sm px-2 md:px-4",children:[(0,b.jsx)(k.Plus,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"})," Define New Year"]}),(0,b.jsxs)(d.Button,{onClick:()=>{E(ab[0]?.year||""),C(!0),G("SETUP")},variant:"default",className:"bg-blue-600 hover:bg-blue-500 text-white shadow-xl shadow-blue-500/20 h-8 md:h-10 text-[10px] md:text-sm px-2 md:px-4",disabled:0===ab.length,children:[(0,b.jsx)(n.TrendingUp,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"})," Start Transition"]})]})]}),aa&&(0,b.jsxs)(e.Card,{className:"overflow-hidden border-white/10 bg-gradient-to-br from-indigo-900/20 via-zinc-900/40 to-black/40 backdrop-blur-xl relative group shadow-2xl ring-1 ring-white/5",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-indigo-500/10 via-transparent to-transparent opacity-50"}),(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",className:"absolute top-3 right-3 z-10 text-zinc-500 hover:text-white hover:bg-white/10 w-8 h-8 rounded-full transition-all",onClick:()=>$(aa),children:(0,b.jsx)(l.Pencil,{className:"w-3.5 h-3.5"})}),(0,b.jsxs)(e.CardContent,{className:"p-5 md:p-8 flex items-center justify-between relative z-0",children:[(0,b.jsxs)("div",{className:"space-y-3 md:space-y-5",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"flex items-center gap-3 mb-2",children:(0,b.jsx)(q.Badge,{className:"bg-emerald-500/10 text-emerald-400 border-emerald-500/20 px-2.5 py-0.5 text-[9px] font-bold tracking-widest uppercase shadow-[0_0_10px_rgba(16,185,129,0.2)]",children:"Live Session"})}),(0,b.jsx)("h3",{className:"text-3xl md:text-6xl font-mono font-bold text-white tracking-tighter drop-shadow-xl",children:aa.year})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-4 md:gap-8 pt-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-zinc-400 bg-black/20 px-3 py-1.5 rounded-full border border-white/5",children:[(0,b.jsx)(f.Calendar,{className:"w-3.5 h-3.5 text-indigo-400"}),(0,b.jsxs)("span",{className:"text-[10px] md:text-xs font-medium",children:["Started ",aa.startDate?(0,v.format)(new Date(aa.startDate),"MMM d, yyyy"):"Recently"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-zinc-400 bg-black/20 px-3 py-1.5 rounded-full border border-white/5",children:[(0,b.jsx)(o.Users,{className:"w-3.5 h-3.5 text-indigo-400"}),(0,b.jsx)("span",{className:"text-[10px] md:text-xs font-medium",children:"Full Enrolment"})]})]})]}),(0,b.jsxs)("div",{className:"hidden md:flex flex-col items-center gap-2",children:[(0,b.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-b from-emerald-500/20 to-emerald-500/5 border border-emerald-500/20 flex items-center justify-center shadow-[0_0_15px_rgba(16,185,129,0.15)]",children:(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-emerald-400 animate-pulse box-shadow-[0_0_8px_#34d399]"})}),(0,b.jsx)("span",{className:"text-[10px] uppercase tracking-widest text-emerald-500/80 font-bold",children:"Active"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:gap-8",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("h3",{className:"text-[10px] md:text-xs font-bold text-zinc-500 uppercase tracking-widest pl-1 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"})," Planned Sessions"]}),(0,b.jsx)("div",{className:"space-y-2",children:ab.length>0?ab.map(a=>(0,b.jsxs)("div",{className:"p-3 md:p-4 rounded-xl border border-white/5 bg-zinc-900/30 flex items-center justify-between group hover:bg-zinc-900/50 hover:border-indigo-500/20 transition-all cursor-default",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 md:gap-4",children:[(0,b.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-indigo-500/10 flex items-center justify-center text-indigo-400 border border-indigo-500/10 group-hover:scale-110 transition-transform",children:(0,b.jsx)(k.Plus,{className:"w-4 h-4 md:w-5 md:h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-mono text-sm md:text-base font-bold text-zinc-200 group-hover:text-white transition-colors",children:a.year}),(0,b.jsx)("p",{className:"text-[9px] text-zinc-500 hidden md:block",children:"Scheduled for future deployment"})]})]}),(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-600 hover:text-zinc-300 hover:bg-white/5 rounded-lg",onClick:()=>$(a),children:(0,b.jsx)(l.Pencil,{className:"w-3.5 h-3.5"})})]},a.year)):(0,b.jsx)("div",{className:"p-6 border border-dashed border-zinc-800 rounded-xl text-center",children:(0,b.jsx)("p",{className:"text-zinc-600 text-[10px] md:text-xs",children:"No future academic years defined."})})})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("h3",{className:"text-[10px] md:text-xs font-bold text-zinc-500 uppercase tracking-widest pl-1 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-zinc-600"})," Archives"]}),(0,b.jsx)("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:ac.map(a=>(0,b.jsxs)("div",{className:"p-3 md:p-4 rounded-xl border border-white/5 bg-black/20 flex items-center justify-between group grayscale hover:grayscale-0 transition-all hover:bg-zinc-900/40",children:[(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-mono text-sm md:text-base font-bold text-zinc-500 group-hover:text-zinc-300 transition-colors",children:a.year}),(0,b.jsx)("div",{className:"text-[9px] text-zinc-700 group-hover:text-zinc-500 uppercase tracking-wider",children:a.endDate?(0,v.format)(new Date(a.endDate),"MMM yyyy"):"Closed"})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"hidden sm:flex gap-4 text-right",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-[9px] text-zinc-600 uppercase",children:"Promoted"}),(0,b.jsx)("div",{className:"text-xs font-bold text-zinc-400 group-hover:text-emerald-400 transition-colors",children:a.stats?.promoted||0})]})}),(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-700 hover:text-white hover:bg-white/5 rounded-lg",onClick:()=>$(a),children:(0,b.jsx)(l.Pencil,{className:"w-3.5 h-3.5"})})]})]},a.year))})]})]}),(0,b.jsx)(p.Dialog,{open:J,onOpenChange:K,children:(0,b.jsxs)(p.DialogContent,{className:"bg-slate-950 border-slate-800 text-white sm:max-w-md",children:[(0,b.jsxs)(p.DialogHeader,{children:[(0,b.jsx)(p.DialogTitle,{children:"Define New Session"}),(0,b.jsx)(p.DialogDescription,{className:"text-slate-400",children:"Add a future academic year to the planning queue."})]}),(0,b.jsxs)("div",{className:"py-4",children:[(0,b.jsx)(s.Label,{className:"text-slate-400 mb-2 block",children:"Year Label"}),(0,b.jsx)(r.Input,{value:L,onChange:a=>M(a.target.value),placeholder:"e.g. 2027-2028",className:"bg-slate-900 border-slate-800 text-lg py-6"})]}),(0,b.jsxs)(p.DialogFooter,{children:[(0,b.jsx)(d.Button,{variant:"ghost",onClick:()=>K(!1),children:"Cancel"}),(0,b.jsx)(d.Button,{onClick:Y,disabled:!L||N,className:"bg-blue-600 text-white hover:bg-blue-500",children:N?(0,b.jsx)(j.Loader2,{className:"animate-spin"}):"Confirm Year"})]})]})}),(0,b.jsx)(p.Dialog,{open:P,onOpenChange:Q,children:(0,b.jsxs)(p.DialogContent,{className:"bg-slate-950 border-slate-800 text-white sm:max-w-md",children:[(0,b.jsxs)(p.DialogHeader,{children:[(0,b.jsx)(p.DialogTitle,{children:"Refine Academic Details"}),(0,b.jsxs)(p.DialogDescription,{className:"text-slate-400",children:["Modify properties for the ",R?.year," session."]})]}),(0,b.jsxs)("div",{className:"py-4 space-y-5",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{className:"text-slate-500 uppercase text-[10px] tracking-widest font-bold",children:"Year Identifier"}),(0,b.jsx)(r.Input,{value:T.label,onChange:a=>U({...T,label:a.target.value}),className:"bg-slate-900 border-slate-800"})]}),(!R?.isUpcoming||R?.isActive)&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{className:"text-slate-500 uppercase text-[10px] tracking-widest font-bold",children:"Session Start"}),(0,b.jsx)(r.Input,{type:"date",value:T.startDate,onChange:a=>U({...T,startDate:a.target.value}),className:"bg-slate-900 border-slate-800"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{className:"text-slate-500 uppercase text-[10px] tracking-widest font-bold",children:"Archival Date"}),(0,b.jsx)(r.Input,{type:"date",value:T.endDate,onChange:a=>U({...T,endDate:a.target.value}),className:"bg-slate-900 border-slate-800"})]})]}),R?.isUpcoming&&(0,b.jsx)("div",{className:"p-4 bg-blue-500/5 border border-blue-500/10 rounded-lg text-xs text-blue-300",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.CheckCircle,{className:"w-4 h-4 shrink-0"}),(0,b.jsx)("span",{children:"Date selection is managed automatically during the transition process. Only the label can be changed at this stage."})]})})]}),(0,b.jsxs)(p.DialogFooter,{children:[(0,b.jsx)(d.Button,{variant:"ghost",className:"text-slate-400",onClick:()=>Q(!1),children:"Cancel"}),(0,b.jsx)(d.Button,{onClick:_,disabled:!T.label||V,className:"bg-blue-600 text-white",children:V?(0,b.jsx)(j.Loader2,{className:"animate-spin"}):"Persist Changes"})]})]})}),(0,b.jsx)(p.Dialog,{open:B,onOpenChange:a=>{(a||"EXECUTING"!==F)&&C(a)},children:(0,b.jsxs)(p.DialogContent,{className:"bg-slate-950 border-slate-800 text-white sm:max-w-xl",children:[(0,b.jsxs)(p.DialogHeader,{children:[(0,b.jsxs)(p.DialogTitle,{className:"text-2xl font-bold flex items-center gap-2",children:[(0,b.jsx)(n.TrendingUp,{className:"text-blue-500"}),"Academic Transition"]}),(0,b.jsxs)(p.DialogDescription,{className:"text-slate-400",children:["Move system from ",(0,b.jsx)("strong",{children:aa?.year})," to a new session."]})]}),"SETUP"===F&&(0,b.jsxs)("div",{className:"space-y-6 py-4",children:[(0,b.jsxs)("div",{className:"p-5 bg-amber-500/10 border border-amber-500/20 rounded-xl text-sm text-amber-200 flex gap-4",children:[(0,b.jsx)(i.AlertTriangle,{className:"w-6 h-6 shrink-0 text-amber-500"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{className:"block mb-2 text-amber-400 uppercase tracking-widest text-xs",children:"Automated Lifecycle Actions:"}),(0,b.jsxs)("ul",{className:"space-y-2 text-xs opacity-90",children:[(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)(g.ArrowRight,{className:"w-3 h-3 text-amber-500 shrink-0 mt-0.5"})," ",(0,b.jsx)("strong",{children:"Student Promotion"}),": Promoted students move to next class level."]}),(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)(g.ArrowRight,{className:"w-3 h-3 text-amber-500 shrink-0 mt-0.5"})," ",(0,b.jsx)("strong",{children:"Fee Carryover"}),": Pending balances are added to new year's ledger."]}),(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)(g.ArrowRight,{className:"w-3 h-3 text-amber-500 shrink-0 mt-0.5"})," ",(0,b.jsx)("strong",{children:"Staffing Preservation"}),": Subject and teacher assignments are cloned."]})]})]})]}),(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{className:"text-slate-400 uppercase text-[10px] tracking-widest pl-1",children:"Target Entry Year"}),(0,b.jsxs)(t.Select,{value:D,onValueChange:E,children:[(0,b.jsx)(t.SelectTrigger,{className:"bg-slate-900 border-slate-800 h-14 text-xl font-mono",children:(0,b.jsx)(t.SelectValue,{placeholder:"Select Year..."})}),(0,b.jsx)(t.SelectContent,{className:"bg-slate-950 border-slate-800",children:ab.map(a=>(0,b.jsx)(t.SelectItem,{value:a.year,className:"text-lg font-mono",children:a.year},a.year))})]})]})})]}),"EXECUTING"===F&&(0,b.jsxs)("div",{className:"py-20 flex flex-col items-center justify-center space-y-6 text-center",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(j.Loader2,{className:"w-20 h-20 animate-spin text-blue-500 opacity-20"}),(0,b.jsx)(n.TrendingUp,{className:"w-10 h-10 text-blue-400 absolute inset-0 m-auto animate-pulse"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-2xl font-bold text-white tracking-tight",children:"Syncing Lifecycle Hub..."}),(0,b.jsx)("p",{className:"text-sm text-slate-400 mt-2 max-w-xs",children:"Bulk updating students, cloning assignments, and calculating fee carryovers."})]})]}),"DONE"===F&&(0,b.jsxs)("div",{className:"py-12 flex flex-col items-center justify-center space-y-6 text-center",children:[(0,b.jsx)("div",{className:"w-24 h-24 bg-emerald-500/10 rounded-full flex items-center justify-center border border-emerald-500/20 shadow-2xl shadow-emerald-500/10",children:(0,b.jsx)(h.CheckCircle,{className:"w-12 h-12 text-emerald-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-3xl font-black text-white tracking-tight italic",children:"SYSTEM ADVANCED!"}),(0,b.jsxs)("p",{className:"text-slate-400 mt-2",children:["Successful transition to ",(0,b.jsx)("span",{className:"text-white font-bold",children:D}),"."]}),(0,b.jsxs)("div",{className:"mt-8 flex gap-4 justify-center",children:[(0,b.jsxs)("div",{className:"bg-white/5 px-4 py-2 rounded-lg border border-white/5",children:[(0,b.jsx)("div",{className:"text-[10px] uppercase text-slate-500",children:"Promoted"}),(0,b.jsx)("div",{className:"text-lg font-bold text-emerald-400",children:H?.promoted})]}),(0,b.jsxs)("div",{className:"bg-white/5 px-4 py-2 rounded-lg border border-white/5",children:[(0,b.jsx)("div",{className:"text-[10px] uppercase text-slate-500",children:"Retained"}),(0,b.jsx)("div",{className:"text-lg font-bold text-blue-400",children:H?.retained})]})]})]})]}),(0,b.jsxs)(p.DialogFooter,{className:"bg-slate-900/50 p-6 border-t border-slate-800 rounded-b-xl",children:["SETUP"===F&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.Button,{variant:"ghost",className:"text-slate-400",onClick:()=>C(!1),children:"Cancel"}),(0,b.jsx)(d.Button,{onClick:Z,disabled:!D,className:"bg-blue-600 hover:bg-blue-500 text-white px-8",children:"Initiate Deployment"})]}),"DONE"===F&&(0,b.jsx)(d.Button,{onClick:()=>{C(!1),window.location.reload()},className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white",children:"Enter New Session"})]})]})})]})}w.exports.create;var z=a.i(20237),A=a.i(73320),B=a.i(14548),C=a.i(38632),D=a.i(70106);let E=(0,D.default)("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]]);var F=a.i(67453),G=a.i(88110),H=a.i(91410);function I(){let{branding:a}=(0,H.useMasterData)(),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(""),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(""),[y,D]=(0,c.useState)(""),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a&&(i(a.schoolName||""),l(a.address||""),n(a.schoolLogo||""),p(a.principalSignature||""))},[a]);let M=async(a,b)=>{let c=await z.auth.currentUser?.getIdToken(),d=new FormData;d.append("file",a),d.append("type",b);let e=await fetch("/api/admin/media/upload",{method:"POST",headers:{Authorization:`Bearer ${c}`},body:d}),f=await e.json();if(!e.ok||!f.success)throw Error(f.error||"Upload failed");return f.url},N=async(b,c)=>{let d="logo"===c;d?(t(!0),x(URL.createObjectURL(b))):(v(!0),D(URL.createObjectURL(b)));try{let a=await M(b,c);d?(n(a),(0,G.toast)({title:"Logo Ready",description:"Cloud storage sync complete.",type:"success"})):(p(a),(0,G.toast)({title:"Signature Ready",description:"Cloud storage sync complete.",type:"success"}))}catch(b){(0,G.toast)({title:"Upload Blocked",description:"Cannot reach storage. Please try pasting a direct URL using the button above.",type:"error"}),d?(x(""),n(a.schoolLogo||"")):(D(""),p(a.principalSignature||""))}finally{d?t(!1):v(!1)}},O=(a,b)=>{a.target.files&&a.target.files[0]&&N(a.target.files[0],b)},P=async()=>{g(!0);try{let a=await z.auth.currentUser?.getIdToken(),b=await fetch("/api/admin/settings/branding",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({schoolName:h,address:k,schoolLogo:m,principalSignature:o})}),c=await b.json();if(!b.ok||!c.success)throw Error(c.error);x(""),D(""),(0,G.toast)({title:"Settings Saved",description:"Branding updated successfully!",type:"success"})}catch(a){(0,G.toast)({title:"Save Failed",description:a.message,type:"error"})}finally{g(!1)}},Q=q||u,R=h!==(a.schoolName||"")||k!==(a.address||"")||m!==(a.schoolLogo||"")||o!==(a.principalSignature||"");return(0,b.jsxs)(e.Card,{className:"bg-zinc-900/40 border-white/10 overflow-hidden shadow-2xl relative backdrop-blur-xl ring-1 ring-white/5",children:[(f||q||u)&&(0,b.jsx)("div",{className:"absolute top-0 left-0 w-full h-0.5 z-50 overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-indigo-500 animate-pulse shadow-[0_0_10px_#6366f1]",style:{width:"100%"}})}),(0,b.jsx)(e.CardHeader,{className:"bg-white/5 border-b border-white/5 pb-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-indigo-500/10 rounded-lg border border-indigo-500/20",children:(0,b.jsx)(E,{className:"w-5 h-5 text-indigo-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(e.CardTitle,{className:"text-base md:text-lg font-bold text-white tracking-tight",children:"Organization Identity"}),(0,b.jsx)(e.CardDescription,{className:"text-zinc-400 text-xs mt-0.5",children:"Manage official school branding and assets."})]})]})}),(0,b.jsxs)(e.CardContent,{className:"p-4 md:p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 md:gap-6 pb-4 md:pb-6 border-b border-white/5",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{className:"text-[10px] md:text-xs font-semibold uppercase tracking-wider text-zinc-500 flex items-center gap-1.5",children:"School Name"}),(0,b.jsx)(r.Input,{value:h,onChange:a=>i(a.target.value),className:"bg-zinc-950/50 border-white/10 h-10 md:h-11 rounded-lg focus:ring-indigo-500/20 focus:border-indigo-500/50 transition-all text-white font-medium text-xs md:text-sm placeholder:text-zinc-700",placeholder:"e.g. Spoorthy Concept School"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{className:"text-[10px] md:text-xs font-semibold uppercase tracking-wider text-zinc-500 flex items-center gap-1.5",children:"Address Line"}),(0,b.jsx)(r.Input,{value:k,onChange:a=>l(a.target.value),className:"bg-zinc-950/50 border-white/10 h-10 md:h-11 rounded-lg focus:ring-indigo-500/20 focus:border-indigo-500/50 transition-all text-white font-medium text-xs md:text-sm placeholder:text-zinc-700",placeholder:"City, State, Country"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 md:gap-8",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)(s.Label,{className:"text-xs md:text-sm font-semibold text-zinc-300",children:"School Logo"}),(0,b.jsx)(d.Button,{variant:"ghost",size:"sm",onClick:()=>J(!I),className:"text-[10px] font-medium text-zinc-500 hover:text-indigo-400 h-6 px-2 hover:bg-transparent",children:I?"Upload File":"Paste URL"})]}),I?(0,b.jsx)(r.Input,{value:m,onChange:a=>n(a.target.value),className:"bg-zinc-950/50 border-white/10 h-10 rounded-lg font-mono text-[10px] md:text-xs text-zinc-300",placeholder:"https://..."}):(0,b.jsxs)("div",{className:"border border-dashed border-zinc-700/50 rounded-xl p-4 flex flex-col items-center justify-center gap-3 bg-zinc-900/30 hover:bg-zinc-900/50 hover:border-indigo-500/30 transition-all relative group h-32 md:h-48 overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute inset-0 opacity-[0.03] bg-[radial-gradient(#fff_1px,transparent_1px)] [background-size:8px_8px] pointer-events-none"}),(0,b.jsx)("div",{className:"w-16 h-16 md:w-24 md:h-24 relative flex items-center justify-center bg-zinc-950 rounded-xl border border-white/5 shadow-inner",children:w||m?(0,b.jsxs)("div",{className:"relative w-full h-full p-2",children:[(0,b.jsx)("img",{src:w||m,alt:"Logo",className:"w-full h-full object-contain"}),!q&&m&&(0,b.jsx)("div",{className:"absolute -bottom-1 -right-1 bg-emerald-500 rounded-full p-0.5 shadow-lg ring-2 ring-black",children:(0,b.jsx)(F.CheckCircle2,{className:"w-3 h-3 text-white"})})]}):(0,b.jsx)(C.Image,{className:"w-8 h-8 md:w-10 md:h-10 text-zinc-800"})}),q&&(0,b.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-[2px] z-10 flex items-center justify-center rounded-xl",children:(0,b.jsx)(j.Loader2,{className:"w-6 h-6 animate-spin text-indigo-500"})}),!q&&(0,b.jsxs)(d.Button,{variant:"secondary",size:"sm",className:"relative pointer-events-none h-7 md:h-9 px-3 text-[10px] md:text-xs bg-zinc-800 text-zinc-300 border border-white/5 shadow-sm",children:[(0,b.jsx)(A.Upload,{className:"w-3 h-3 mr-1.5"}),(0,b.jsx)("span",{className:"hidden md:inline",children:"Select File"})," ",(0,b.jsx)("span",{className:"md:hidden",children:"Upload"})]}),(0,b.jsx)("input",{type:"file",accept:"image/*",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20",onChange:a=>O(a,"logo"),disabled:q})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)(s.Label,{className:"text-xs md:text-sm font-semibold text-zinc-300",children:"Principal Signature"}),(0,b.jsx)(d.Button,{variant:"ghost",size:"sm",onClick:()=>L(!K),className:"text-[10px] font-medium text-zinc-500 hover:text-indigo-400 h-6 px-2 hover:bg-transparent",children:K?"Upload File":"Paste URL"})]}),K?(0,b.jsx)(r.Input,{value:o,onChange:a=>p(a.target.value),className:"bg-zinc-950/50 border-white/10 h-10 rounded-lg font-mono text-[10px] md:text-xs text-zinc-300",placeholder:"https://..."}):(0,b.jsxs)("div",{className:"border border-dashed border-zinc-700/50 rounded-xl p-4 flex flex-col items-center justify-center gap-3 bg-zinc-900/30 hover:bg-zinc-900/50 hover:border-indigo-500/30 transition-all relative group h-32 md:h-48 overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute inset-0 opacity-[0.03] bg-[radial-gradient(#fff_1px,transparent_1px)] [background-size:8px_8px] pointer-events-none"}),(0,b.jsx)("div",{className:"w-24 h-12 md:w-36 md:h-20 relative flex items-center justify-center bg-white rounded-lg border border-white/10 shadow-sm",children:y||o?(0,b.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center p-2",children:[(0,b.jsx)("img",{src:y||o,alt:"Signature",className:"w-full h-full object-contain"}),!u&&o&&(0,b.jsx)("div",{className:"absolute -bottom-1 -right-1 bg-emerald-500 rounded-full p-0.5 shadow-lg ring-2 ring-black",children:(0,b.jsx)(F.CheckCircle2,{className:"w-3 h-3 text-white"})})]}):(0,b.jsx)("span",{className:"text-zinc-200 text-[10px] font-mono italic",children:"NO SIGNATURE"})}),u&&(0,b.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-[2px] z-10 flex items-center justify-center rounded-xl",children:(0,b.jsx)(j.Loader2,{className:"w-6 h-6 animate-spin text-indigo-500"})}),!u&&(0,b.jsxs)(d.Button,{variant:"secondary",size:"sm",className:"relative pointer-events-none h-7 md:h-9 px-3 text-[10px] md:text-xs bg-zinc-800 text-zinc-300 border border-white/5 shadow-sm",children:[(0,b.jsx)(A.Upload,{className:"w-3 h-3 mr-1.5"}),(0,b.jsx)("span",{className:"hidden md:inline",children:"Select File"})," ",(0,b.jsx)("span",{className:"md:hidden",children:"Upload"})]}),(0,b.jsx)("input",{type:"file",accept:"image/*",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20",onChange:a=>O(a,"signature"),disabled:u})]})]})]}),(0,b.jsx)("div",{className:"flex justify-end pt-4 border-t border-white/5",children:(0,b.jsxs)(d.Button,{onClick:P,disabled:f||Q||!R,className:"bg-indigo-600 hover:bg-indigo-500 text-white w-full md:w-auto px-8 h-10 md:h-11 rounded-lg font-semibold text-xs md:text-sm shadow-lg shadow-indigo-500/20 transition-all active:scale-95",children:[f?(0,b.jsx)(j.Loader2,{className:"animate-spin mr-2 w-4 h-4"}):(0,b.jsx)(B.Save,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})}var J=a.i(3314),K=a.i(46842);let L=(0,D.default)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var M=a.i(81402),N=a.i(81560);a.i(69387);var O=a.i(60574),P=a.i(4416);function Q({isOpen:a,onClose:e,onSuccess:f}){let[g,h]=(0,c.useState)({name:"",email:"",password:"",role:"MANAGER"}),[i,k]=(0,c.useState)(!1),l=async a=>{a.preventDefault(),k(!0);try{let a=await fetch("/api/admin/users/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}),b=await a.json();if(!a.ok)throw Error(b.error);(0,G.toast)({title:"User Created",description:`System access granted to ${g.name} as ${g.role}`,type:"success"}),h({name:"",email:"",password:"",role:"MANAGER"}),f(),e()}catch(a){(0,G.toast)({title:"Creation Failed",description:a.message||"Something went wrong.",type:"error"})}finally{k(!1)}};return(0,b.jsx)(p.Dialog,{open:a,onOpenChange:e,children:(0,b.jsxs)(p.DialogContent,{className:"bg-black/95 border-white/10 text-white sm:max-w-[425px]",children:[(0,b.jsx)(p.DialogHeader,{children:(0,b.jsxs)(p.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(P.ShieldCheck,{className:"text-accent",size:20}),"Add System User"]})}),(0,b.jsxs)("form",{onSubmit:l,className:"space-y-4 py-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{children:"Full Name"}),(0,b.jsx)(r.Input,{required:!0,value:g.name,onChange:a=>h({...g,name:a.target.value}),className:"bg-white/5 border-white/10",placeholder:"e.g. John Doe"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{children:"Email Address"}),(0,b.jsx)(r.Input,{required:!0,type:"email",value:g.email,onChange:a=>h({...g,email:a.target.value}),className:"bg-white/5 border-white/10",placeholder:"user@school.com"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{children:"Initial Password"}),(0,b.jsx)(r.Input,{required:!0,type:"text",value:g.password,onChange:a=>h({...g,password:a.target.value}),className:"bg-white/5 border-white/10 font-mono",placeholder:"Secure password"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{children:"System Role"}),(0,b.jsxs)(t.Select,{value:g.role,onValueChange:a=>h({...g,role:a}),children:[(0,b.jsx)(t.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,b.jsx)(t.SelectValue,{placeholder:"Select Role"})}),(0,b.jsxs)(t.SelectContent,{className:"bg-black border-white/10 text-white",children:[(0,b.jsx)(t.SelectItem,{value:"MANAGER",children:"Manager"}),(0,b.jsx)(t.SelectItem,{value:"ADMIN",children:"Administrator"}),(0,b.jsx)(t.SelectItem,{value:"TIMETABLE_EDITOR",children:"Timetable Editor"})]})]}),(0,b.jsxs)("p",{className:"text-[10px] text-muted-foreground mt-1",children:["MANAGER"===g.role&&"Can manage academic operations but cannot access payroll or system settings.","ADMIN"===g.role&&"Full system access including payroll, settings, and user management.","TIMETABLE_EDITOR"===g.role&&"Restricted to timetable and faculty coverage management."]})]}),(0,b.jsx)(p.DialogFooter,{className:"mt-4 pt-4 border-t border-white/5",children:(0,b.jsx)(d.Button,{type:"submit",disabled:i,className:"w-full bg-white text-black hover:bg-zinc-200",children:i?(0,b.jsx)(j.Loader2,{className:"w-4 h-4 animate-spin"}):"Gant System Access"})})]})]})})}var R=a.i(35732),S=a.i(68114),T=a.i(62244),U=a.i(9450);function V(){let{user:a}=(0,u.useAuth)(),[f,g]=(0,c.useState)([]),[h,i]=(0,c.useState)(!0),[j,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(null);(0,c.useEffect)(()=>{let a=(0,O.query)((0,O.collection)(z.db,"users"),(0,O.orderBy)("role")),b=(0,O.onSnapshot)(a,a=>{g(a.docs.map(a=>({id:a.id,...a.data()})).filter(a=>["ADMIN","MANAGER","TIMETABLE_EDITOR"].includes(a.role))),i(!1)});return()=>b()},[]);let r=async b=>{if(m&&a&&!(await fetch("/api/admin/user-actions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await a.getIdToken()}`},body:JSON.stringify({targetId:m.id,role:m.role,action:"DEACTIVATE",reason:b})})).ok)throw Error("Failed to deactivate user")},s=async b=>{if(m&&a&&!(await fetch("/api/admin/user-actions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await a.getIdToken()}`},body:JSON.stringify({targetId:m.id,role:m.role,action:"DELETE_HARD",reason:b})})).ok)throw Error("Failed to permanently delete user")};return(0,b.jsxs)(e.Card,{className:"bg-black/20 border-white/10 backdrop-blur-md",children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between border-b border-white/5 pb-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)(e.CardTitle,{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)(J.Shield,{className:"text-accent",size:20}),"System Access Control"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-widest font-bold",children:"Manage administrative accounts"})]}),(0,b.jsxs)(d.Button,{onClick:()=>l(!0),size:"sm",className:"bg-white text-black hover:bg-zinc-200",children:[(0,b.jsx)(k.Plus,{size:16,className:"mr-1"})," Add User"]})]}),(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsx)("div",{className:"space-y-3",children:h?(0,b.jsx)("div",{className:"p-10 text-center animate-pulse text-muted-foreground",children:"Syncing access matrix..."}):0===f.length?(0,b.jsx)("div",{className:"p-10 text-center border border-dashed border-white/5 rounded-xl text-muted-foreground italic",children:"No secondary system users found."}):f.map(a=>(0,b.jsxs)("div",{className:(0,S.cn)("flex items-center justify-between p-4 rounded-xl bg-white/5 border border-white/5 hover:border-white/10 transition-all group","inactive"===a.status&&"opacity-50 grayscale"),children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/5 flex items-center justify-center border border-white/10 group-hover:border-accent/30 transition-colors",children:(0,b.jsx)(K.User,{size:18,className:"text-white/40 group-hover:text-accent transition-colors"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"font-bold text-sm text-white flex items-center gap-2",children:[a.name||a.email,"inactive"===a.status&&(0,b.jsx)("span",{className:"text-[9px] bg-red-500/10 text-red-500 px-1 rounded uppercase",children:"Inactive"})]}),(0,b.jsx)("div",{className:"text-[10px] font-mono text-white/40",children:a.email})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(q.Badge,{className:(0,S.cn)("text-[9px] font-black uppercase tracking-tighter py-0 h-5 border-none","ADMIN"===a.role?"bg-accent/10 text-accent":"MANAGER"===a.role?"bg-blue-500/10 text-blue-400":"bg-purple-500/10 text-purple-400"),children:a.role}),(0,b.jsxs)(R.DropdownMenu,{children:[(0,b.jsx)(R.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-white/40 hover:text-white",children:(0,b.jsx)(L,{size:16})})}),(0,b.jsxs)(R.DropdownMenuContent,{align:"end",className:"bg-zinc-900 border-white/10 text-white",children:[(0,b.jsxs)(R.DropdownMenuItem,{className:"gap-2 text-xs font-bold text-amber-500",onClick:()=>{n(a),p("password")},children:[(0,b.jsx)(M.Key,{size:14})," Reset Password"]}),(0,b.jsxs)(R.DropdownMenuItem,{className:"gap-2 text-xs font-bold text-red-500",onClick:()=>{n(a),p("delete")},children:[(0,b.jsx)(N.Trash2,{size:14})," Revoke Access"]})]})]})]})]},a.id))})}),(0,b.jsx)(Q,{isOpen:j,onClose:()=>l(!1),onSuccess:()=>{}}),m&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(T.DeleteUserModal,{isOpen:"delete"===o,onClose:()=>{p(null),n(null)},user:{id:m.id,schoolId:m.email,name:m.name||"System User",role:m.role},checkEligibility:async()=>({canDelete:!0}),onDeactivate:r,onDelete:s}),(0,b.jsx)(U.AdminChangePasswordModal,{isOpen:"password"===o,onClose:()=>{p(null),n(null)},user:{uid:m.id,schoolId:m.email,name:m.name||"System User",role:m.role}})]})]})}var W=a.i(50944),X=a.i(66384),Y=a.i(38246);function Z(){let{user:a}=(0,u.useAuth)();(0,W.useRouter)();let[e,f]=(0,c.useState)(null),[g,h]=(0,c.useState)(!0);return((0,c.useEffect)(()=>{if(!a)return;let b=(0,O.onSnapshot)((0,O.doc)(z.db,"users",a.uid),a=>{f(a.exists()?a.data().role:null),h(!1)});return()=>b()},[a]),g)?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center h-[60vh] gap-4",children:[(0,b.jsx)(j.Loader2,{className:"w-8 h-8 animate-spin text-accent"}),(0,b.jsx)("p",{className:"text-muted-foreground animate-pulse",children:"Verifying credentials..."})]}):e&&!["ADMIN","SUPER_ADMIN","OWNER","DEVELOPER"].includes(e.toUpperCase())?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center h-[60vh] gap-6 text-center animate-in zoom-in-95 duration-500",children:[(0,b.jsx)("div",{className:"w-20 h-20 rounded-full bg-rose-500/10 flex items-center justify-center border border-rose-500/20 shadow-2xl shadow-rose-500/20",children:(0,b.jsx)(X.ShieldAlert,{className:"w-10 h-10 text-rose-500"})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h1",{className:"text-3xl font-display font-bold text-white",children:"Restricted Access"}),(0,b.jsx)("p",{className:"text-muted-foreground max-w-md mx-auto",children:"This terminal is restricted to Level 1 Administrators. Your current clearance does not permit modification of system-wide settings."})]}),(0,b.jsx)(d.Button,{asChild:!0,variant:"outline",className:"border-white/10 hover:bg-white/5",children:(0,b.jsx)(Y.default,{href:"/admin",children:"Return to Dashboard"})})]}):(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:gap-8 p-3 md:p-8 max-w-7xl mx-auto pb-20",children:[(0,b.jsxs)("div",{className:"flex-none",children:[(0,b.jsxs)("h1",{className:"text-xl md:text-3xl font-display font-bold text-white italic tracking-tight",children:["System ",(0,b.jsx)("span",{className:"text-accent underline decoration-accent/20",children:"Settings"})]}),(0,b.jsx)("p",{className:"text-[10px] md:text-sm text-muted-foreground uppercase tracking-widest font-bold opacity-50",children:"L1 Administrative Control Panel"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-8 items-start",children:[(0,b.jsxs)("div",{className:"w-full space-y-4 md:space-y-8",children:[(0,b.jsx)(I,{}),(0,b.jsx)(V,{})]}),(0,b.jsx)("div",{className:"w-full",children:(0,b.jsx)(y,{})})]})]})}a.s(["default",()=>Z],87487)}];

//# sourceMappingURL=src_app_admin_settings_page_tsx_ab516ef5._.js.map