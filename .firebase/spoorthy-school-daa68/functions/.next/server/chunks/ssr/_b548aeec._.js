module.exports=[91119,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-2xl border border-[#64FFDA]/10 bg-[#112240]/40 backdrop-blur-lg text-white shadow-xl transition-all duration-300 hover:bg-[#112240]/60 hover:border-[#64FFDA]/30 hover:shadow-[0_0_20px_-5px_rgba(100,255,218,0.1)] group",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("font-bold text-xl tracking-tight text-white group-hover:text-accent transition-colors",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-white/60 font-medium",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},77994,a=>{"use strict";var b=a.i(72131);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},66718,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,type:c,...e},f)=>(0,b.jsx)("input",{type:c,className:(0,d.cn)("flex h-12 w-full rounded-full border border-white/10 bg-[#282828] px-4 py-3 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all shadow-inner hover:bg-[#333]",a),ref:f,...e}));e.displayName="Input",a.s(["Input",()=>e])},70430,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("label",{ref:e,className:(0,d.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",a),...c}));e.displayName="Label",a.s(["Label",()=>e])},14548,a=>{"use strict";let b=(0,a.i(70106).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);a.s(["Save",()=>b],14548)},69520,a=>{"use strict";let b=(0,a.i(70106).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);a.s(["RefreshCw",()=>b],69520)},63658,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(7554),e=a.i(70121),f=a.i(50104),g=a.i(25152),h=a.i(77994),i=a.i(3688),j=a.i(30553),k="Switch",[l,m]=(0,f.createContextScope)(k),[n,o]=l(k),p=c.forwardRef((a,f)=>{let{__scopeSwitch:h,name:i,checked:l,defaultChecked:m,required:o,disabled:p,value:q="on",onCheckedChange:r,form:u,...v}=a,[w,x]=c.useState(null),y=(0,e.useComposedRefs)(f,a=>x(a)),z=c.useRef(!1),A=!w||u||!!w.closest("form"),[B,C]=(0,g.useControllableState)({prop:l,defaultProp:m??!1,onChange:r,caller:k});return(0,b.jsxs)(n,{scope:h,checked:B,disabled:p,children:[(0,b.jsx)(j.Primitive.button,{type:"button",role:"switch","aria-checked":B,"aria-required":o,"data-state":t(B),"data-disabled":p?"":void 0,disabled:p,value:q,...v,ref:y,onClick:(0,d.composeEventHandlers)(a.onClick,a=>{C(a=>!a),A&&(z.current=a.isPropagationStopped(),z.current||a.stopPropagation())})}),A&&(0,b.jsx)(s,{control:w,bubbles:!z.current,name:i,value:q,checked:B,required:o,disabled:p,form:u,style:{transform:"translateX(-100%)"}})]})});p.displayName=k;var q="SwitchThumb",r=c.forwardRef((a,c)=>{let{__scopeSwitch:d,...e}=a,f=o(q,d);return(0,b.jsx)(j.Primitive.span,{"data-state":t(f.checked),"data-disabled":f.disabled?"":void 0,...e,ref:c})});r.displayName=q;var s=c.forwardRef(({__scopeSwitch:a,control:d,checked:f,bubbles:g=!0,...j},k)=>{let l=c.useRef(null),m=(0,e.useComposedRefs)(l,k),n=(0,h.usePrevious)(f),o=(0,i.useSize)(d);return c.useEffect(()=>{let a=l.current;if(!a)return;let b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(n!==f&&b){let c=new Event("click",{bubbles:g});b.call(a,f),a.dispatchEvent(c)}},[n,f,g]),(0,b.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:f,...j,tabIndex:-1,ref:m,style:{...j.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function t(a){return a?"checked":"unchecked"}s.displayName="SwitchBubbleInput";var u=a.i(68114);let v=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(p,{className:(0,u.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...c,ref:d,children:(0,b.jsx)(r,{className:(0,u.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));v.displayName=p.displayName,a.s(["Switch",()=>v],63658)},9801,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(69387);var d=a.i(60574),e=a.i(20237),f=a.i(38246),g=a.i(99570),h=a.i(66718),i=a.i(70430),j=a.i(63658),k=a.i(96221),l=a.i(14548),m=a.i(15618),n=a.i(81560),o=a.i(69520);let p=(0,a.i(70106).default)("bus",[["path",{d:"M8 6v6",key:"18i7km"}],["path",{d:"M15 6v6",key:"1sg6z9"}],["path",{d:"M2 12h19.6",key:"de5uta"}],["path",{d:"M18 18h3s.5-1.7.8-2.8c.1-.4.2-.8.2-1.2 0-.4-.1-.8-.2-1.2l-1.4-5C20.1 6.8 19.1 6 18 6H4a2 2 0 0 0-2 2v10h3",key:"1wwztk"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M9 18h5",key:"lrx6i"}],["circle",{cx:"16",cy:"18",r:"2",key:"1v4tcr"}]]);var q=a.i(91119),r=a.i(91410);function s(){let{classes:p}=(0,r.useMasterData)(),[s,u]=(0,c.useState)([]),[v,w]=(0,c.useState)({}),[x,y]=(0,c.useState)(!0),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),D=Object.values(p).map(a=>({id:a.id,name:a.name,order:a.order||99})).sort((a,b)=>a.order-b.order);(0,c.useEffect)(()=>{(async()=>{try{let a=(0,d.doc)(e.db,"config","fees"),b=await (0,d.getDoc)(a);if(b.exists()){let a=b.data();a.terms&&u(a.terms),a.transportFees&&w(a.transportFees)}}catch(a){console.error("Error fetching data:",a)}finally{y(!1)}})()},[]);let E=async()=>{A(!0);try{let b=(0,d.doc)(e.db,"config","fees");await (0,d.setDoc)(b,{terms:s,transportFees:v},{merge:!0});let{syncAllStudentLedgers:c}=await a.A(82765),f=await c(e.db);alert(`Fee structure saved and ${f} students synchronized successfully!`)}catch(a){console.error("Error saving fees:",a),alert("Failed to save.")}finally{A(!1)}},F=async()=>{if(confirm("This will synchronize fee structures for ALL students based on their class. This allows new fee terms to appear in their ledgers. Existing payments will remain safe. Continue?")){C(!0);try{let{syncAllStudentLedgers:b}=await a.A(82765),c=await b(e.db);alert(`Synced successfully for ${c} students.`)}catch(a){console.error("Sync failed:",a),alert("Sync Failed: "+a.message)}finally{C(!1)}}};return x?(0,b.jsx)("div",{className:"flex justify-center p-12",children:(0,b.jsx)(k.Loader2,{className:"w-6 h-6 animate-spin"})}):(0,b.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500 pb-20",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"font-display text-3xl font-bold",children:"Fee Management"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Configure term fees for each class and transportation."})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Button,{asChild:!0,variant:"secondary",className:"h-9 border-white/10 bg-white/10 hover:bg-white/20 text-white",children:(0,b.jsx)(f.default,{href:"/admin/fees/custom",children:"Custom Fees"})}),(0,b.jsxs)(g.Button,{onClick:F,disabled:B||z,variant:"outline",className:"gap-2 border-emerald-500/20 bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20",children:[(0,b.jsx)(o.RefreshCw,{className:`w-4 h-4 ${B?"animate-spin":""}`}),B?"Syncing All...":"Sync All Students"]}),(0,b.jsxs)(g.Button,{onClick:()=>{u([...s,{id:Date.now().toString(),name:"New Term",dueDate:new Date().toISOString().split("T")[0],isActive:!0,amounts:{}}])},variant:"outline",className:"gap-2 border-white/10 bg-white/5",children:[(0,b.jsx)(m.Plus,{className:"w-4 h-4"})," Add Term"]}),(0,b.jsxs)(g.Button,{onClick:E,disabled:z,className:"gap-2 bg-accent text-accent-foreground",children:[z?(0,b.jsx)(k.Loader2,{className:"w-4 h-4 animate-spin"}):(0,b.jsx)(l.Save,{className:"w-4 h-4"}),"Save Changes"]})]})]}),(0,b.jsx)("div",{className:"grid gap-6",children:s.map((a,c)=>(0,b.jsxs)(q.Card,{className:"p-6 bg-black/20 border-white/10",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,b.jsx)(j.Switch,{checked:a.isActive,onCheckedChange:()=>{let a;(a=[...s])[c].isActive=!a[c].isActive,u(a)}}),(0,b.jsx)("div",{className:"flex-1 max-w-sm gap-2 flex items-center",children:(0,b.jsx)(h.Input,{value:a.name,onChange:a=>{var b;let d;return b=a.target.value,void((d=[...s])[c].name=b,u(d))},className:"font-bold text-lg h-auto py-1 px-2 -ml-2 bg-transparent border-transparent hover:border-white/10 focus:border-white/20 focus:bg-black/40 transition-all"})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.Input,{type:"date",value:a.dueDate,onChange:a=>{let b=[...s];b[c].dueDate=a.target.value,u(b)},className:"w-40 bg-white/5 border-white/10"}),(0,b.jsx)(g.Button,{size:"icon",variant:"ghost",className:"text-red-500 hover:bg-red-500/10",onClick:()=>{let a;(a=[...s]).splice(c,1),u(a)},children:(0,b.jsx)(n.Trash2,{className:"w-4 h-4"})})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:D.map(d=>(0,b.jsxs)("div",{className:"space-y-1.5 p-3 rounded-lg bg-white/5 border border-white/5 hover:border-white/10 transition-all",children:[(0,b.jsx)(i.Label,{className:"text-xs text-muted-foreground uppercase",children:d.name}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-muted-foreground text-xs",children:"₹"}),(0,b.jsx)(h.Input,{type:"number",value:a.amounts?.[d.name]||"",onChange:a=>{var b,e;let f;return b=d.name,e=a.target.value,void((f=[...s])[c].amounts={...f[c].amounts,[b]:parseInt(e)||0},u(f))},className:"bg-black/20 border-white/10 h-8 text-sm pl-5",placeholder:"0"})]})]},d.id))})]},a.id))}),(0,b.jsx)(t,{transportFees:v,setTransportFees:w,saving:z}),0===s.length&&(0,b.jsx)("div",{className:"text-center py-20 text-muted-foreground border border-dashed border-white/10 rounded-xl",children:'No terms configured. Click "Add Term" to start.'})]})}function t({transportFees:a,setTransportFees:c,saving:d}){let{villages:e}=(0,r.useMasterData)(),f=Object.values(e).sort((a,b)=>a.name.localeCompare(b.name));return(0,b.jsxs)(q.Card,{className:"p-6 bg-black/20 border-white/10 mt-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)(p,{className:"w-5 h-5 text-yellow-500"}),"Transport Fees"]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set annual transport fee based on village/route."})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:[f.map(d=>(0,b.jsxs)("div",{className:"space-y-1.5 p-3 rounded-lg bg-white/5 border border-white/5 hover:border-white/10 transition-all",children:[(0,b.jsx)(i.Label,{className:"text-xs text-muted-foreground uppercase truncate block",title:d.name,children:d.name}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-muted-foreground text-xs",children:"₹"}),(0,b.jsx)(h.Input,{type:"number",value:a[d.id]||"",onChange:b=>{var e,f;return e=d.id,f=b.target.value,void c({...a,[e]:parseInt(f)||0})},className:"bg-black/20 border-white/10 h-8 text-sm pl-5",placeholder:"0"})]})]},d.id)),0===f.length&&(0,b.jsx)("div",{className:"col-span-full text-muted-foreground text-sm",children:"No villages found. Add them in Master Data."})]})]})}a.s(["default",()=>s],9801)},82765,a=>{a.v(b=>Promise.all(["server/chunks/ssr/src_lib_services_fee-service_ts_1e519c71._.js"].map(b=>a.l(b))).then(()=>b(47649)))}];

//# sourceMappingURL=_b548aeec._.js.map