(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let r=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("rounded-2xl border border-[#64FFDA]/10 bg-[#112240]/40 backdrop-blur-lg text-white shadow-xl transition-all duration-300 hover:bg-[#112240]/60 hover:border-[#64FFDA]/30 hover:shadow-[0_0_20px_-5px_rgba(100,255,218,0.1)] group",e),...a}));r.displayName="Card";let i=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...a}));i.displayName="CardHeader";let n=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("h3",{ref:r,className:(0,s.cn)("font-bold text-xl tracking-tight text-white group-hover:text-accent transition-colors",e),...a}));n.displayName="CardTitle";let o=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("p",{ref:r,className:(0,s.cn)("text-sm text-white/60 font-medium",e),...a}));o.displayName="CardDescription";let l=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",e),...a}));l.displayName="CardContent",a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>l,"CardDescription",()=>o,"CardHeader",()=>i,"CardTitle",()=>n])},19455,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(91918),r=e.i(75157);let i=a.forwardRef(({className:e,variant:a="default",size:i="default",asChild:n=!1,...o},l)=>{let d=n?s.Slot:"button";return(0,t.jsx)(d,{className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-full text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 tracking-wide",{"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:scale-105 active:scale-95 transition-transform":"default"===a,"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm":"destructive"===a,"border border-white/20 bg-transparent hover:bg-white/10 hover:text-accent-foreground":"outline"===a,"bg-secondary text-secondary-foreground hover:bg-secondary/80":"secondary"===a,"hover:bg-white/10 hover:text-accent font-normal":"ghost"===a,"text-primary underline-offset-4 hover:underline":"link"===a,"bg-gradient-to-r from-accent to-accent/80 text-black font-bold hover:brightness-110 border-0 shadow-lg hover:shadow-accent/20":"gradient"===a,"bg-accent text-black font-bold hover:bg-accent/90 hover:scale-105 active:scale-95 transition-transform shadow-lg":"spotify"===a,"h-10 px-6 py-2":"default"===i,"h-9 px-4 text-xs":"sm"===i,"h-12 px-8 text-base":"lg"===i,"h-14 px-10 text-lg":"xl"===i,"h-10 w-10":"icon"===i},e),ref:l,...o})});i.displayName="Button",e.s(["Button",()=>i])},93479,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let r=a.forwardRef(({className:e,type:a,...r},i)=>(0,t.jsx)("input",{type:a,className:(0,s.cn)("flex h-12 w-full rounded-full border border-white/10 bg-[#282828] px-4 py-3 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all shadow-inner hover:bg-[#333]",e),ref:i,...r}));r.displayName="Input",e.s(["Input",()=>r])},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},77572,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(81140),r=e.i(30030),i=e.i(42727),n=e.i(96626),o=e.i(48425),l=e.i(86318),d=e.i(69340),c=e.i(10772),u="Tabs",[f,x]=(0,r.createContextScope)(u,[i.createRovingFocusGroupScope]),m=(0,i.createRovingFocusGroupScope)(),[b,h]=f(u),p=a.forwardRef((e,a)=>{let{__scopeTabs:s,value:r,onValueChange:i,defaultValue:n,orientation:f="horizontal",dir:x,activationMode:m="automatic",...h}=e,p=(0,l.useDirection)(x),[g,v]=(0,d.useControllableState)({prop:r,onChange:i,defaultProp:n??"",caller:u});return(0,t.jsx)(b,{scope:s,baseId:(0,c.useId)(),value:g,onValueChange:v,orientation:f,dir:p,activationMode:m,children:(0,t.jsx)(o.Primitive.div,{dir:p,"data-orientation":f,...h,ref:a})})});p.displayName=u;var g="TabsList",v=a.forwardRef((e,a)=>{let{__scopeTabs:s,loop:r=!0,...n}=e,l=h(g,s),d=m(s);return(0,t.jsx)(i.Root,{asChild:!0,...d,orientation:l.orientation,dir:l.dir,loop:r,children:(0,t.jsx)(o.Primitive.div,{role:"tablist","aria-orientation":l.orientation,...n,ref:a})})});v.displayName=g;var w="TabsTrigger",y=a.forwardRef((e,a)=>{let{__scopeTabs:r,value:n,disabled:l=!1,...d}=e,c=h(w,r),u=m(r),f=C(c.baseId,n),x=T(c.baseId,n),b=n===c.value;return(0,t.jsx)(i.Item,{asChild:!0,...u,focusable:!l,active:b,children:(0,t.jsx)(o.Primitive.button,{type:"button",role:"tab","aria-selected":b,"aria-controls":x,"data-state":b?"active":"inactive","data-disabled":l?"":void 0,disabled:l,id:f,...d,ref:a,onMouseDown:(0,s.composeEventHandlers)(e.onMouseDown,e=>{l||0!==e.button||!1!==e.ctrlKey?e.preventDefault():c.onValueChange(n)}),onKeyDown:(0,s.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&c.onValueChange(n)}),onFocus:(0,s.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==c.activationMode;b||l||!e||c.onValueChange(n)})})})});y.displayName=w;var j="TabsContent",N=a.forwardRef((e,s)=>{let{__scopeTabs:r,value:i,forceMount:l,children:d,...c}=e,u=h(j,r),f=C(u.baseId,i),x=T(u.baseId,i),m=i===u.value,b=a.useRef(m);return a.useEffect(()=>{let e=requestAnimationFrame(()=>b.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,t.jsx)(n.Presence,{present:l||m,children:({present:a})=>(0,t.jsx)(o.Primitive.div,{"data-state":m?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":f,hidden:!a,id:x,tabIndex:0,...c,ref:s,style:{...e.style,animationDuration:b.current?"0s":void 0},children:a&&d})})});function C(e,t){return`${e}-trigger-${t}`}function T(e,t){return`${e}-content-${t}`}N.displayName=j;var S=e.i(75157);let A=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)(v,{ref:s,className:(0,S.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...a}));A.displayName=v.displayName;let k=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)(y,{ref:s,className:(0,S.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...a}));k.displayName=y.displayName;let R=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)(N,{ref:s,className:(0,S.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...a}));R.displayName=N.displayName,e.s(["Tabs",()=>p,"TabsContent",()=>R,"TabsList",()=>A,"TabsTrigger",()=>k],77572)},24687,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let r=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...a}));r.displayName="Textarea",e.s(["Textarea",()=>r])},14764,e=>{"use strict";let t=(0,e.i(75254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],14764)},33235,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(32341),r=e.i(19455),i=e.i(93479),n=e.i(24687),o=e.i(67489),l=e.i(77572),d=e.i(15288),c=e.i(31278),u=e.i(14764),f=e.i(71689);e.i(36180);var x=e.i(98925),m=e.i(59141),b=e.i(22016);function h(){let{user:e}=(0,s.useAuth)(),[h,p]=(0,a.useState)([]),[g,v]=(0,a.useState)([]),[w,y]=(0,a.useState)([]),[j,N]=(0,a.useState)(!1),[C,T]=(0,a.useState)(!1),[S,A]=(0,a.useState)(!1),[k,R]=(0,a.useState)(""),[I,D]=(0,a.useState)(""),[E,L]=(0,a.useState)("");(0,a.useEffect)(()=>{e?.uid&&F()},[e]),(0,a.useEffect)(()=>{if(!e?.uid)return;let t=!0,a=C?(0,x.query)((0,x.collection)(m.db,"notices"),(0,x.where)("senderId","==",e.uid)):(0,x.query)((0,x.collection)(m.db,"notices"),(0,x.where)("senderId","==",e.uid),(0,x.orderBy)("createdAt","desc")),s=(0,x.onSnapshot)(a,e=>{if(!t)return;let a=e.docs.map(e=>({id:e.id,...e.data()}));C&&(a=a.sort((e,t)=>(t.createdAt?.seconds||0)-(e.createdAt?.seconds||0))),p(a)},e=>{t&&e.message.includes("index")&&!C&&(console.warn("Sent notices index missing, enabling fallback."),T(!0))});return()=>{t=!1,s()}},[e,C]),(0,a.useEffect)(()=>{if(!e?.uid)return;let t=!0,a=S?(0,x.query)((0,x.collection)(m.db,"notices"),(0,x.where)("target","in",["ALL","TEACHERS"])):(0,x.query)((0,x.collection)(m.db,"notices"),(0,x.where)("target","in",["ALL","TEACHERS"]),(0,x.orderBy)("createdAt","desc")),s=(0,x.onSnapshot)(a,a=>{if(!t)return;let s=Date.now(),r=a.docs.map(e=>({id:e.id,...e.data()})).filter(t=>t.senderId!==e.uid&&(!t.expiresAt||!(1e3*t.expiresAt.seconds<s)));S&&(r=r.sort((e,t)=>(t.createdAt?.seconds||0)-(e.createdAt?.seconds||0))),v(r)},e=>{t&&(e.message.includes("index")&&!S?(console.warn("Inbox notices index missing, enabling fallback."),A(!0)):e.message.includes("index")||console.error("Inbox stream error:",e))});return()=>{t=!1,s()}},[e,S]);let F=async()=>{try{let t=await e?.getIdToken(),a=await fetch("/api/timetable/my-schedule",{headers:{Authorization:`Bearer ${t}`}}),s=await a.json();if(s.success){let e=s.data.weeklySchedule||{},t=new Set;Object.values(e).forEach(e=>{Object.values(e).forEach(e=>{"object"==typeof e&&t.add(e.classId)})}),y(Array.from(t))}}catch(e){}},H=async t=>{t.preventDefault(),N(!0);try{let t=await fetch("/api/teacher/notices/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await e?.getIdToken()}`},body:JSON.stringify({targetClassId:k,title:I,content:E})}),a=await t.json();a.success?(alert("Notice Sent!"),D(""),L("")):alert(a.error)}catch(e){alert(e.message)}finally{N(!1)}};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-6 space-y-6 animate-in fade-in",children:[(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)(b.default,{href:"/teacher",className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-white transition-colors mb-2",children:[(0,t.jsx)(f.ArrowLeft,{className:"w-4 h-4"})," Back to Dashboard"]}),(0,t.jsx)("h1",{className:"text-3xl font-display font-bold",children:"Notices"})]})}),(0,t.jsxs)(l.Tabs,{defaultValue:"inbox",className:"w-full",children:[(0,t.jsxs)(l.TabsList,{className:"bg-black/20 border border-white/10",children:[(0,t.jsx)(l.TabsTrigger,{value:"inbox",children:"Inbox"}),(0,t.jsx)(l.TabsTrigger,{value:"compose",children:"Compose"}),(0,t.jsx)(l.TabsTrigger,{value:"sent",children:"Sent History"})]}),(0,t.jsx)(l.TabsContent,{value:"inbox",className:"mt-4",children:(0,t.jsx)("div",{className:"space-y-4",children:0===g.length?(0,t.jsx)(d.Card,{className:"bg-black/20 border-white/10",children:(0,t.jsx)(d.CardContent,{className:"py-10 text-center text-muted-foreground",children:"No notices received."})}):g.map(e=>(0,t.jsxs)(d.Card,{className:"bg-black/20 border-white/10 relative overflow-hidden group",children:["HOLIDAY"===e.type&&(0,t.jsx)("div",{className:"absolute top-0 left-0 w-1 h-full bg-yellow-500"}),(0,t.jsxs)(d.CardContent,{className:"p-5",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h3",{className:"font-bold text-lg",children:e.title}),"HOLIDAY"===e.type&&(0,t.jsx)("span",{className:"text-[10px] bg-yellow-500/20 text-yellow-500 px-2 py-0.5 rounded-full font-bold uppercase",children:"Holiday"})]}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleDateString():"Just now"})]}),(0,t.jsx)("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:e.content}),(0,t.jsxs)("div",{className:"mt-4 pt-3 border-t border-white/5 flex justify-between items-center text-[10px] text-muted-foreground uppercase tracking-widest font-bold",children:[(0,t.jsxs)("span",{children:["From: ",e.senderName]}),(0,t.jsx)("span",{children:e.senderRole})]})]})]},e.id))})}),(0,t.jsx)(l.TabsContent,{value:"compose",className:"mt-4",children:(0,t.jsxs)(d.Card,{className:"bg-black/20 border-white/10 max-w-xl",children:[(0,t.jsxs)(d.CardHeader,{children:[(0,t.jsx)(d.CardTitle,{children:"Send Notice"}),(0,t.jsx)(d.CardDescription,{children:"Notices expire automatically after 3 days."})]}),(0,t.jsx)(d.CardContent,{children:(0,t.jsxs)("form",{onSubmit:H,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{children:"Target Class"}),(0,t.jsxs)(o.Select,{onValueChange:R,value:k,children:[(0,t.jsx)(o.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(o.SelectValue,{placeholder:"Select Class"})}),(0,t.jsx)(o.SelectContent,{children:w.map(e=>(0,t.jsxs)(o.SelectItem,{value:e,children:["Class ",e]},e))})]})]}),(0,t.jsx)(i.Input,{required:!0,placeholder:"Title",value:I,onChange:e=>D(e.target.value),className:"bg-white/5 border-white/10"}),(0,t.jsx)(n.Textarea,{required:!0,placeholder:"Message...",value:E,onChange:e=>L(e.target.value),className:"bg-white/5 border-white/10 min-h-[100px]"}),(0,t.jsx)(r.Button,{type:"submit",disabled:j,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:j?(0,t.jsx)(c.Loader2,{className:"animate-spin"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Send,{className:"w-4 h-4 mr-2"})," Send Notice"]})})]})})]})}),(0,t.jsx)(l.TabsContent,{value:"sent",className:"mt-4",children:(0,t.jsx)("div",{className:"space-y-3",children:h.map(e=>(0,t.jsx)(d.Card,{className:"bg-white/5 border-white/10",children:(0,t.jsx)(d.CardContent,{className:"p-4",children:(0,t.jsx)("div",{className:"flex justify-between items-start",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-bold",children:e.title}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.content}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground mt-2",children:["To: Class ",e.target?.id||e.targetClassId," â€¢ Expires: ",e.expiresAt?new Date(1e3*e.expiresAt.seconds).toLocaleDateString():"N/A"]})]})})})},e.id))})})]})]})}e.s(["default",()=>h])}]);