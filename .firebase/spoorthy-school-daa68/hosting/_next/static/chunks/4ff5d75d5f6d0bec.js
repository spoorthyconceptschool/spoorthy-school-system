(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75157);let r=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("rounded-2xl border border-[#64FFDA]/10 bg-[#112240]/40 backdrop-blur-lg text-white shadow-xl transition-all duration-300 hover:bg-[#112240]/60 hover:border-[#64FFDA]/30 hover:shadow-[0_0_20px_-5px_rgba(100,255,218,0.1)] group",e),...s}));r.displayName="Card";let d=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...s}));d.displayName="CardHeader";let l=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("h3",{ref:r,className:(0,a.cn)("font-bold text-xl tracking-tight text-white group-hover:text-accent transition-colors",e),...s}));l.displayName="CardTitle";let i=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-white/60 font-medium",e),...s}));i.displayName="CardDescription";let o=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent",s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>o,"CardDescription",()=>i,"CardHeader",()=>d,"CardTitle",()=>l])},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},51298,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(32341),r=e.i(15288),d=e.i(87486),l=e.i(22016),i=e.i(31278),o=e.i(87316),c=e.i(71689);e.i(36180);var n=e.i(98925),x=e.i(59141),h=e.i(72498);function u(){let{user:e}=(0,a.useAuth)(),{subjects:u}=(0,h.useMasterData)(),[m,p]=(0,s.useState)(null),[f,b]=(0,s.useState)([]),[j,y]=(0,s.useState)(!0),[N,g]=(0,s.useState)({}),[w,v]=(0,s.useState)([]);(0,s.useEffect)(()=>{e&&(S(),T(),I())},[e]);let I=async()=>{try{let e=(0,n.query)((0,n.collection)(x.db,"notices"),(0,n.where)("type","==","HOLIDAY")),t=await (0,n.getDocs)(e);v(t.docs.map(e=>({id:e.id,...e.data()})))}catch(e){console.error(e)}},T=async()=>{try{let e=(0,n.query)((0,n.collection)(x.db,"teachers")),t=await (0,n.getDocs)(e),s={};t.docs.forEach(e=>{let t=e.data();t.schoolId&&(s[t.schoolId]=t.name),s[e.id]=t.name}),g(s)}catch(e){console.error("Error fetching teachers:",e)}},S=async()=>{try{let t=await fetch("/api/timetable/my-schedule",{headers:{Authorization:`Bearer ${await e?.getIdToken()}`}}),s=await t.json();s.success&&(p(s.data.weeklySchedule||{}),b(s.data.substitutions||[]))}catch(e){console.error(e)}finally{y(!1)}},C=e=>w.some(t=>{let s=t.date?.seconds?new Date(1e3*t.date.seconds):t.createdAt?.seconds?new Date(1e3*t.createdAt.seconds):new Date,a=t.expiresAt?.seconds?new Date(1e3*t.expiresAt.seconds):new Date;return s.setHours(0,0,0,0),a.setHours(23,59,59,999),e>=s&&e<=a}),D=(()=>{let e=new Date,t=e.toLocaleDateString("en-US",{weekday:"long"}).toUpperCase(),s=e.toISOString().split("T")[0];if(C(e))return{dayName:t,dateKey:s,slots:[],isHoliday:!0};if(!m||!m[t])return{dayName:t,dateKey:s,slots:[]};let a=[],r=m[t]||{};for(let e=1;e<=8;e++){let t=f.find(t=>t.date===s&&t.slotId===e&&"ORIGINAL"===t.role),d=f.find(t=>t.date===s&&t.slotId===e&&"SUBSTITUTE"===t.role);if(d){a.push({id:e,type:"SUBSTITUTION",classId:d.classId,note:"Substitution",originalTeacherId:d.originalTeacherId});continue}if(t){a.push({id:e,type:"LEAVE",...r[e],note:"LEISURE"===t.resolutionType?"Marked Leisure":"Subst. Assigned"});continue}let l=r[e];if(l){let t="string"==typeof l?l:l.classId,s="object"==typeof l?l.subjectId:null;a.push({id:e,type:"REGULAR",classId:t,subjectId:s})}}return{dayName:t,dateKey:s,slots:a,isHoliday:!1}})();return j?(0,t.jsx)("div",{className:"p-10 flex justify-center",children:(0,t.jsx)(i.Loader2,{className:"animate-spin"})}):(0,t.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto p-4 md:p-6 animate-in fade-in",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(l.default,{href:"/teacher",className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-white transition-colors mb-2",children:[(0,t.jsx)(c.ArrowLeft,{className:"w-4 h-4"})," Back to Dashboard"]}),(0,t.jsx)("h1",{className:"text-3xl font-display font-bold",children:"My Schedule"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Teacher Portal"})]}),(0,t.jsxs)(r.Card,{className:`overflow-hidden relative border-white/10 ${D.isHoliday?"bg-red-500/10 border-red-500/20":"bg-black/20"}`,children:[(0,t.jsx)("div",{className:`absolute top-0 left-0 w-1 h-full ${D.isHoliday?"bg-red-500":"bg-blue-500"}`}),(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)(r.CardTitle,{className:"flex justify-between",children:[(0,t.jsxs)("span",{children:["Today (",D.dayName,")"]}),(0,t.jsx)("span",{className:"text-sm font-normal text-muted-foreground",children:D.dateKey})]})}),(0,t.jsx)(r.CardContent,{children:D.isHoliday?(0,t.jsxs)("div",{className:"py-12 flex flex-col items-center justify-center text-red-400 gap-4",children:[(0,t.jsx)(o.Calendar,{className:"w-12 h-12 opacity-50"}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold uppercase tracking-widest",children:"Holiday"}),(0,t.jsx)("p",{className:"text-sm text-red-400/60 mt-1",children:"School is closed for today. Enjoy your rest!"})]})]}):0===D.slots.length?(0,t.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No classes today."}):(0,t.jsx)("div",{className:"space-y-2",children:D.slots.map(e=>(0,t.jsxs)("div",{className:`p-4 rounded border flex items-center justify-between
                                         ${"SUBSTITUTION"===e.type?"bg-blue-500/10 border-blue-500/30":"LEAVE"===e.type?"bg-red-500/10 border-red-500/30 opacity-60 dashed-border":"bg-white/5 border-white/10"}
                                     `,children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(d.Badge,{variant:"outline",className:"w-8 h-8 flex items-center justify-center rounded-full bg-white/5",children:e.id}),(0,t.jsxs)("div",{children:["LEAVE"===e.type?(0,t.jsxs)("div",{className:"line-through text-muted-foreground",children:["Class ",e.classId]}):(0,t.jsxs)("div",{className:"font-bold text-lg",children:["Class ",e.classId]}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"SUBSTITUTION"===e.type?(0,t.jsxs)("span",{className:"text-blue-400",children:["Covering for ",N[e.originalTeacherId]||e.originalTeacherId]}):"LEAVE"===e.type?(0,t.jsxs)("span",{className:"text-red-400",children:["On Leave (",e.note,")"]}):u[e.subjectId]?.name||e.subjectId||"Regular Class"})]})]}),"SUBSTITUTION"===e.type&&(0,t.jsx)(d.Badge,{children:"SUBSTITUTION"}),"LEAVE"===e.type&&(0,t.jsx)(d.Badge,{variant:"destructive",children:"ON LEAVE"})]},e.id))})})]}),(0,t.jsxs)(r.Card,{className:"bg-black/20 border-white/10",children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{children:"Weekly Overview"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-white/10",children:[(0,t.jsx)("th",{className:"p-3 text-left",children:"Day"}),[1,2,3,4,5,6,7,8].map(e=>(0,t.jsxs)("th",{className:"p-3 text-center",children:["P",e]},e))]})}),(0,t.jsx)("tbody",{children:["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"].map((e,s)=>{let a=new Date,r=a.getDay(),d=new Date(a);d.setDate(a.getDate()+(s+1-r));let l=C(d);return(0,t.jsxs)("tr",{className:`border-b border-white/5 transition-colors ${l?"bg-red-500/5 text-red-400/50":"hover:bg-white/5"}`,children:[(0,t.jsxs)("td",{className:"p-3 font-medium text-muted-foreground flex flex-col",children:[(0,t.jsx)("span",{children:e.substring(0,3)}),(0,t.jsx)("span",{className:"text-[10px] opacity-40 font-normal",children:d.toLocaleDateString([],{month:"short",day:"numeric"})})]}),l?(0,t.jsx)("td",{colSpan:8,className:"p-3 text-center text-red-500/50 font-bold uppercase tracking-widest text-[10px]",children:"Holiday"}):[1,2,3,4,5,6,7,8].map(s=>{let a=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`,r=f.find(e=>e.date===a&&e.slotId===s&&"ORIGINAL"===e.role),l=f.find(e=>e.date===a&&e.slotId===s&&"SUBSTITUTE"===e.role);if(l)return(0,t.jsxs)("td",{className:"p-3 text-center border-l border-white/5 bg-blue-500/10",children:[(0,t.jsx)("div",{className:"font-bold text-blue-400",children:l.classId}),(0,t.jsx)("div",{className:"text-[10px] uppercase font-bold text-blue-500/60",children:"Covering"})]},s);if(r)return(0,t.jsxs)("td",{className:"p-3 text-center border-l border-white/5 bg-red-500/10 opacity-40",children:[(0,t.jsx)("div",{className:"font-bold line-through text-red-500/50",children:"OFF"}),(0,t.jsx)("div",{className:"text-[10px] uppercase font-bold text-red-500/40",children:"On Leave"})]},s);let i=m?.[e]?.[s];if(!i)return(0,t.jsx)("td",{className:"p-3 border-l border-white/5"},s);let o="object"==typeof i?i.classId:i,c="object"==typeof i?i.subjectId:null;return(0,t.jsxs)("td",{className:"p-3 text-center border-l border-white/5",children:[(0,t.jsx)("div",{className:"font-bold",children:o}),c&&(0,t.jsx)("div",{className:"text-[10px] text-muted-foreground",children:u[c]?.name||c})]},s)})]},e)})})]})})})]})]})}e.s(["default",()=>u])}]);