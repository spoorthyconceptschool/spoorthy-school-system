(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3281,e=>{"use strict";let t=(0,e.i(75254).default)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);e.s(["Printer",()=>t],3281)},93479,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let l=a.forwardRef(({className:e,type:a,...l},r)=>(0,t.jsx)("input",{type:a,className:(0,s.cn)("flex h-12 w-full rounded-full border border-white/10 bg-[#282828] px-4 py-3 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all shadow-inner hover:bg-[#333]",e),ref:r,...l}));l.displayName="Input",e.s(["Input",()=>l])},10204,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let l=a.forwardRef(({className:e,...a},l)=>(0,t.jsx)("label",{ref:l,className:(0,s.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...a}));l.displayName="Label",e.s(["Label",()=>l])},76639,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(26999),l=e.i(37727),r=e.i(75157);let i=s.Root,n=s.Trigger,d=s.Portal;s.Close;let o=a.forwardRef(({className:e,...a},l)=>(0,t.jsx)(s.Overlay,{ref:l,className:(0,r.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a}));o.displayName=s.Overlay.displayName;let c=a.forwardRef(({className:e,children:a,...i},n)=>(0,t.jsxs)(d,{children:[(0,t.jsx)(o,{}),(0,t.jsxs)(s.Content,{ref:n,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...i,children:[a,(0,t.jsxs)(s.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(l.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));c.displayName=s.Content.displayName;let m=({className:e,...a})=>(0,t.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...a});m.displayName="DialogHeader";let h=({className:e,...a})=>(0,t.jsx)("div",{className:(0,r.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...a});h.displayName="DialogFooter";let x=a.forwardRef(({className:e,...a},l)=>(0,t.jsx)(s.Title,{ref:l,className:(0,r.cn)("text-lg font-semibold leading-none tracking-tight",e),...a}));x.displayName=s.Title.displayName;let p=a.forwardRef(({className:e,...a},l)=>(0,t.jsx)(s.Description,{ref:l,className:(0,r.cn)("text-sm text-muted-foreground",e),...a}));p.displayName=s.Description.displayName,e.s(["Dialog",()=>i,"DialogContent",()=>c,"DialogDescription",()=>p,"DialogFooter",()=>h,"DialogHeader",()=>m,"DialogTitle",()=>x,"DialogTrigger",()=>n])},84774,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let l=a.forwardRef(({className:e,...a},l)=>(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:l,className:(0,s.cn)("w-full caption-bottom text-sm",e),...a})}));l.displayName="Table";let r=a.forwardRef(({className:e,...a},l)=>(0,t.jsx)("thead",{ref:l,className:(0,s.cn)("[&_tr]:border-b",e),...a}));r.displayName="TableHeader";let i=a.forwardRef(({className:e,...a},l)=>(0,t.jsx)("tbody",{ref:l,className:(0,s.cn)("[&_tr:last-child]:border-0",e),...a}));i.displayName="TableBody",a.forwardRef(({className:e,...a},l)=>(0,t.jsx)("tfoot",{ref:l,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...a})).displayName="TableFooter";let n=a.forwardRef(({className:e,...a},l)=>(0,t.jsx)("tr",{ref:l,className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...a}));n.displayName="TableRow";let d=a.forwardRef(({className:e,...a},l)=>(0,t.jsx)("th",{ref:l,className:(0,s.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...a}));d.displayName="TableHead";let o=a.forwardRef(({className:e,...a},l)=>(0,t.jsx)("td",{ref:l,className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...a}));o.displayName="TableCell",a.forwardRef(({className:e,...a},l)=>(0,t.jsx)("caption",{ref:l,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",e),...a})).displayName="TableCaption",e.s(["Table",()=>l,"TableBody",()=>i,"TableCell",()=>o,"TableHead",()=>d,"TableHeader",()=>r,"TableRow",()=>n])},69049,41071,e=>{"use strict";var t=e.i(43476),a=e.i(84774),s=e.i(75157),l=e.i(19455);let r=(0,e.i(75254).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>r],41071);var i=e.i(55146);function n({data:e,columns:n,isLoading:d,onRowClick:o,actions:c}){return d?(0,t.jsx)("div",{className:"w-full h-48 flex items-center justify-center bg-white/5 rounded-xl animate-pulse",children:(0,t.jsx)("div",{className:"h-4 w-4 bg-accent/50 rounded-full animate-ping"})}):(0,t.jsxs)("div",{className:"w-full space-y-3",children:[(0,t.jsx)("div",{className:"overflow-x-auto rounded-xl md:rounded-2xl border border-white/10 bg-black/20 backdrop-blur-md custom-scrollbar",children:(0,t.jsxs)(a.Table,{className:"w-full",children:[(0,t.jsx)(a.TableHeader,{className:"bg-white/5",children:(0,t.jsxs)(a.TableRow,{className:"border-white/10 hover:bg-transparent",children:[n.map(e=>(0,t.jsx)(a.TableHead,{className:(0,s.cn)("text-muted-foreground font-black uppercase text-[7px] md:text-[10px] tracking-widest h-8 md:h-12 whitespace-nowrap px-2 md:px-6 italic",e.headerClassName),children:e.header},e.key)),c&&(0,t.jsx)(a.TableHead,{className:"w-[30px] md:w-[50px] whitespace-nowrap px-2 md:px-6"})]})}),(0,t.jsx)(a.TableBody,{children:0===e.length?(0,t.jsx)(a.TableRow,{children:(0,t.jsx)(a.TableCell,{colSpan:n.length+ +!!c,className:"h-24 md:h-32 text-center text-muted-foreground border-white/10 whitespace-nowrap text-[10px] md:text-sm italic",children:"No results found."})}):e.map((e,d)=>(0,t.jsxs)(a.TableRow,{className:(0,s.cn)("border-white/5 transition-all duration-300 hover:bg-[#64FFDA]/5 group cursor-default",o&&"cursor-pointer"),onClick:()=>o?.(e),children:[n.map(l=>(0,t.jsx)(a.TableCell,{className:(0,s.cn)("py-2 md:py-4 px-2 md:px-6 font-medium whitespace-nowrap text-[10px] md:text-sm",l.cellClassName),children:(0,t.jsx)("div",{className:"flex flex-col",children:l.render?l.render(e,d):(0,t.jsx)("span",{className:"text-white group-hover:text-accent transition-colors",children:e[l.key]})})},`${e.id}-${l.key}`)),c&&(0,t.jsx)(a.TableCell,{className:"px-2 md:px-6",children:(0,t.jsxs)(i.DropdownMenu,{children:[(0,t.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(l.Button,{variant:"ghost",className:"h-7 w-7 md:h-8 md:w-8 p-0 hover:bg-white/10 text-muted-foreground hover:text-white",children:[(0,t.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,t.jsx)(r,{className:"h-3 w-3 md:h-4 md:w-4"})]})}),(0,t.jsxs)(i.DropdownMenuContent,{align:"end",className:"bg-[#0A192F] border-white/10 backdrop-blur-xl rounded-xl",children:[(0,t.jsx)(i.DropdownMenuLabel,{className:"text-[10px] uppercase font-black tracking-widest text-muted-foreground/60 p-3 italic",children:"Operations"}),(0,t.jsx)(i.DropdownMenuSeparator,{className:"bg-white/5"}),(0,t.jsx)("div",{className:"p-1",children:c(e)})]})]})})]},e.id||d))})]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between py-2 md:py-4 px-3 md:px-6 bg-white/5 border border-white/10 rounded-xl md:rounded-2xl",children:[(0,t.jsxs)("div",{className:"text-[8px] md:text-xs font-black uppercase tracking-widest text-muted-foreground italic",children:["Scope: ",(0,t.jsxs)("span",{className:"text-white ml-1",children:[e.length," items"]})]}),(0,t.jsxs)("div",{className:"flex gap-1 md:gap-2",children:[(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",disabled:!0,className:"h-6 md:h-8 px-2 md:px-4 text-[8px] md:text-[10px] font-black uppercase tracking-widest border border-white/10 opacity-50",children:"Prev"}),(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",disabled:!0,className:"h-6 md:h-8 px-2 md:px-4 text-[8px] md:text-[10px] font-black uppercase tracking-widest border border-white/10 opacity-50",children:"Next"})]})]})]})}e.s(["DataTable",()=>n],69049)},40160,e=>{"use strict";let t=(0,e.i(75254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>t],40160)},95468,e=>{"use strict";let t=(0,e.i(75254).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],95468)},57428,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(20783),l=e.i(30030),r=e.i(81140),i=e.i(69340),n=e.i(99682),d=e.i(35804),o=e.i(96626),c=e.i(48425),m="Checkbox",[h,x]=(0,l.createContextScope)(m),[p,u]=h(m);function g(e){let{__scopeCheckbox:s,checked:l,children:r,defaultChecked:n,disabled:d,form:o,name:c,onCheckedChange:h,required:x,value:u="on",internal_do_not_use_render:g}=e,[f,b]=(0,i.useControllableState)({prop:l,defaultProp:n??!1,onChange:h,caller:m}),[w,N]=a.useState(null),[j,v]=a.useState(null),y=a.useRef(!1),C=!w||!!o||!!w.closest("form"),S={checked:f,disabled:d,setChecked:b,control:w,setControl:N,name:c,form:o,value:u,hasConsumerStoppedPropagationRef:y,required:x,defaultChecked:!k(n)&&n,isFormControl:C,bubbleInput:j,setBubbleInput:v};return(0,t.jsx)(p,{scope:s,...S,children:"function"==typeof g?g(S):r})}var f="CheckboxTrigger",b=a.forwardRef(({__scopeCheckbox:e,onKeyDown:l,onClick:i,...n},d)=>{let{control:o,value:m,disabled:h,checked:x,required:p,setControl:g,setChecked:b,hasConsumerStoppedPropagationRef:w,isFormControl:N,bubbleInput:j}=u(f,e),v=(0,s.useComposedRefs)(d,g),y=a.useRef(x);return a.useEffect(()=>{let e=o?.form;if(e){let t=()=>b(y.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[o,b]),(0,t.jsx)(c.Primitive.button,{type:"button",role:"checkbox","aria-checked":k(x)?"mixed":x,"aria-required":p,"data-state":C(x),"data-disabled":h?"":void 0,disabled:h,value:m,...n,ref:v,onKeyDown:(0,r.composeEventHandlers)(l,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,r.composeEventHandlers)(i,e=>{b(e=>!!k(e)||!e),j&&N&&(w.current=e.isPropagationStopped(),w.current||e.stopPropagation())})})});b.displayName=f;var w=a.forwardRef((e,a)=>{let{__scopeCheckbox:s,name:l,checked:r,defaultChecked:i,required:n,disabled:d,value:o,onCheckedChange:c,form:m,...h}=e;return(0,t.jsx)(g,{__scopeCheckbox:s,checked:r,defaultChecked:i,disabled:d,required:n,onCheckedChange:c,name:l,form:m,value:o,internal_do_not_use_render:({isFormControl:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b,{...h,ref:a,__scopeCheckbox:s}),e&&(0,t.jsx)(y,{__scopeCheckbox:s})]})})});w.displayName=m;var N="CheckboxIndicator",j=a.forwardRef((e,a)=>{let{__scopeCheckbox:s,forceMount:l,...r}=e,i=u(N,s);return(0,t.jsx)(o.Presence,{present:l||k(i.checked)||!0===i.checked,children:(0,t.jsx)(c.Primitive.span,{"data-state":C(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:a,style:{pointerEvents:"none",...e.style}})})});j.displayName=N;var v="CheckboxBubbleInput",y=a.forwardRef(({__scopeCheckbox:e,...l},r)=>{let{control:i,hasConsumerStoppedPropagationRef:o,checked:m,defaultChecked:h,required:x,disabled:p,name:g,value:f,form:b,bubbleInput:w,setBubbleInput:N}=u(v,e),j=(0,s.useComposedRefs)(r,N),y=(0,n.usePrevious)(m),C=(0,d.useSize)(i);a.useEffect(()=>{if(!w)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!o.current;if(y!==m&&e){let a=new Event("click",{bubbles:t});w.indeterminate=k(m),e.call(w,!k(m)&&m),w.dispatchEvent(a)}},[w,y,m,o]);let S=a.useRef(!k(m)&&m);return(0,t.jsx)(c.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:h??S.current,required:x,disabled:p,name:g,value:f,form:b,...l,tabIndex:-1,ref:j,style:{...l.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function k(e){return"indeterminate"===e}function C(e){return k(e)?"indeterminate":e?"checked":"unchecked"}y.displayName=v;var S=e.i(43531),T=e.i(75157);let D=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)(w,{ref:s,className:(0,T.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...a,children:(0,t.jsx)(j,{className:(0,T.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(S.Check,{className:"h-4 w-4"})})}));D.displayName=w.displayName,e.s(["Checkbox",()=>D],57428)},91130,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(36180);var s=e.i(98925),l=e.i(59141),r=e.i(31278),i=e.i(40160),n=e.i(3281),d=e.i(55436),o=e.i(45423),c=e.i(84614),m=e.i(46897),h=e.i(51737),x=e.i(19455),p=e.i(93479),u=e.i(87486),g=e.i(72498),f=e.i(67489),b=e.i(69049),w=e.i(76639),N=e.i(57428),j=e.i(10204),v=e.i(32341),y=e.i(80691),k=e.i(75157),C=e.i(18566),S=e.i(95468),T=e.i(63059),D=e.i(78583);function P({students:e}){let[i,d]=(0,a.useState)(!1),[o,c]=(0,a.useState)(!1),[m,h]=(0,a.useState)([]),[p,u]=(0,a.useState)([]),[f,b]=(0,a.useState)("SELECT"),{branding:j}=(0,g.useMasterData)(),v=Array.from(new Set(e.map(e=>e.className))).filter(Boolean).sort();(0,a.useEffect)(()=>{i&&(u(v),b("SELECT"),h([]))},[i]);let y=e=>{u(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},k=async()=>{if(0===p.length)return void alert("Please select at least one class");c(!0);try{let t=(0,s.collection)(l.db,"student_fee_ledgers"),a=(0,s.query)(t,(0,s.where)("academicYearId","==","2025-2026")),r=await (0,s.getDocs)(a),i={};r.forEach(e=>i[e.data().studentId]=e.data());let n=new Date().toISOString().split("T")[0],d=e.filter(e=>p.includes(e.className)).map(e=>{let t=i[e.schoolId];if(!t)return null;let a=(t.items||[]).sort((e,t)=>(e.dueDate||"").localeCompare(t.dueDate||"")),s=a.filter(e=>"TERM"===e.type),l=a.filter(e=>"TRANSPORT"===e.type),r=a.filter(e=>"CUSTOM"===e.type),d=t.totalPaid||0,o=s.find(e=>e.dueDate>=n)||s[s.length-1],c=[];s.forEach(e=>{let t=e.amount||0,a=Math.min(t,d),s=t-a;d-=a,s>0&&c.push({name:e.name,total:t,pending:s,dueDate:e.dueDate})});let m=0;l.forEach(e=>{let t=Math.min(e.amount||0,d);m+=(e.amount||0)-t,d-=t});let h=0;r.forEach(e=>{let t=Math.min(e.amount||0,d);h+=(e.amount||0)-t,d-=t});let x=o?.dueDate||"",p=c.filter(e=>e.dueDate<=x);if(0===p.length&&m<=0&&h<=0)return null;let u=p.reduce((e,t)=>e+t.pending,0)+m+h;return{name:e.studentName,id:e.schoolId,class:e.className,section:e.sectionName,totalFee:t.totalFee||0,totalPending:u,pendingTerms:p,busPending:m,customPending:h,printDate:new Date().toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"})}}).filter(Boolean);h(d),b("PREVIEW")}catch(e){console.error(e),alert("Failed to load fee data")}finally{c(!1)}};return(0,t.jsxs)(w.Dialog,{open:i,onOpenChange:d,children:[(0,t.jsx)(w.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(x.Button,{variant:"outline",className:"h-11 gap-2 border-white/10 bg-white/5 text-white/70 hover:bg-white/10 rounded-xl px-4 md:px-6 transition-all",children:[(0,t.jsx)(D.FileText,{className:"w-4 h-4"})," ",(0,t.jsx)("span",{className:"hidden sm:inline",children:"Fee Slips"}),(0,t.jsx)("span",{className:"sm:hidden",children:"Slips"})]})}),(0,t.jsxs)(w.DialogContent,{className:"bg-black/95 border-white/10 text-white max-w-lg",children:[(0,t.jsx)(w.DialogHeader,{children:(0,t.jsxs)(w.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(n.Printer,{className:"w-5 h-5 text-amber-500"}),"Generate Fee Slips"]})}),(0,t.jsxs)("div",{className:"py-2",children:["SELECT"===f&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"bg-amber-500/5 border border-amber-500/10 p-3 rounded-lg text-xs text-amber-200/70",children:"Select the classes you want to generate slips for. Only students with pending term fees will be included."}),(0,t.jsxs)("div",{className:"flex justify-between items-center px-1",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"Available Classes"}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(x.Button,{variant:"link",className:"text-amber-500 h-auto p-0 text-xs",onClick:()=>u(v),children:"Select All"}),(0,t.jsx)(x.Button,{variant:"link",className:"text-white/40 hover:text-white h-auto p-0 text-xs",onClick:()=>u([]),children:"Clear All"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-[300px] overflow-y-auto p-1 pr-2",children:v.map(e=>(0,t.jsxs)("div",{className:`flex items-center space-x-3 p-3 rounded-lg border transition-all cursor-pointer ${p.includes(e)?"bg-amber-500/10 border-amber-500/30 text-white":"bg-white/5 border-white/5 text-muted-foreground hover:bg-white/10"}`,onClick:()=>y(e),children:[(0,t.jsx)(N.Checkbox,{id:`class-${e}`,checked:p.includes(e),onCheckedChange:()=>y(e),className:"border-white/20 data-[state=checked]:bg-amber-500 data-[state=checked]:text-black"}),(0,t.jsx)("label",{htmlFor:`class-${e}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:e})]},e))}),(0,t.jsxs)(x.Button,{className:"w-full h-12 bg-amber-500 text-black hover:bg-amber-600 font-bold gap-2 mt-4",onClick:k,disabled:o||0===p.length,children:[o?(0,t.jsx)(r.Loader2,{className:"w-5 h-5 animate-spin"}):(0,t.jsx)(T.ChevronRight,{className:"w-5 h-5"}),o?"Analyzing Data...":`Proceed with ${p.length} Classes`]})]}),"PREVIEW"===f&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-lg flex items-center gap-4",children:[(0,t.jsx)("div",{className:"bg-green-500 p-2 rounded-full text-black",children:(0,t.jsx)(S.CheckCircle2,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-bold text-lg",children:[m.length," Slips Prepared"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Automatically grouped by class for easy sorting."})]})]}),(0,t.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-lg p-2 max-h-[200px] overflow-y-auto",children:[m.slice(0,5).map(e=>(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 border-b border-white/5 last:border-0 text-xs text-muted-foreground",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-white font-medium",children:e.name}),(0,t.jsx)("span",{className:"text-[10px]",children:e.class})]}),(0,t.jsxs)("span",{className:"text-amber-500 font-mono",children:["₹",e.totalPending]})]},e.id)),m.length>5&&(0,t.jsxs)("p",{className:"text-center py-2 text-[10px] text-muted-foreground italic",children:["And ",m.length-5," others..."]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsxs)(x.Button,{className:"flex-1 bg-white text-black hover:bg-white/90 font-bold h-12 gap-2 text-lg",onClick:()=>{let e=window.open("","_blank");if(!e)return;let t={};m.forEach(e=>{t[e.class]||(t[e.class]=[]),t[e.class].push(e)});let a=`
            <html>
            <head>
                <title>Fee Slips</title>
                <style>
                    @page { size: A4; margin: 0; }
                    body { font-family: sans-serif; margin: 0; padding: 0; background: #fff; line-height: 1.1; }
                    .slips-container { 
                        display: grid; 
                        grid-template-columns: 1fr 1fr; 
                        grid-template-rows: auto repeat(5, 1fr); 
                        gap: 1.5mm; 
                        height: 297mm;
                        width: 210mm;
                        padding: 4mm 6mm;
                        box-sizing: border-box;
                        page-break-after: always;
                    }
                    .slip { 
                        border: 2pt solid #000;
                        padding: 2mm; 
                        display: flex; 
                        flex-direction: column; 
                        justify-content: flex-start;
                        font-size: 8.5px;
                        overflow: hidden;
                        height: 100%;
                        box-sizing: border-box;
                        position: relative;
                    }
                    .header { text-align: center; border-bottom: 2pt solid #000; margin-bottom: 1mm; padding-bottom: 0.5mm; display: flex; align-items: center; justify-content: center; gap: 5mm; }
                    .school-name { font-weight: 900; font-size: 11px; text-transform: uppercase; }
                    .logo-mini { height: 25px; width: auto; object-fit: contain; }
                    .title { font-size: 8px; font-weight: bold; background: #000; color: #fff; padding: 1px 4px; display: inline-block; }
                    .row { display: flex; justify-content: space-between; margin-bottom: 0.5mm; }
                    .label { color: #000; font-weight: bold; }
                    .value { font-weight: bold; }
                    
                    .fee-table { width: 100%; border-collapse: collapse; margin-top: 1mm; }
                    .fee-table th, .fee-table td { border: 0.5pt solid #000; padding: 0.3mm 1mm; text-align: left; font-size: 7.5px; }
                    .fee-table th { background: #f0f0f0; font-weight: bold; }
                    .fee-table td.amount { text-align: right; font-weight: 800; }
                    
                    .total-box-horizontal { 
                        border: 1.5pt solid #000; 
                        padding: 1mm 2mm; 
                        margin-top: 1.5mm; 
                        display: flex; 
                        justify-content: space-between; 
                        align-items: center;
                        background: #000;
                        color: #fff;
                    }
                    .total-label { font-size: 9px; font-weight: 900; letter-spacing: 0.5px; }
                    .total-value { font-size: 11px; font-weight: 900; }
                    .footer { text-align: center; font-size: 7px; color: #000; margin-top: auto; padding-top: 1mm; border-top: 0.5pt dashed #ccc; }
                    .class-header { 
                        grid-column: span 2; 
                        text-align: center; 
                        font-weight: 900; 
                        font-size: 10px; 
                        color: #000; 
                        border-bottom: 1.5pt solid #000;
                        margin-bottom: 1.5mm;
                        padding: 0.5mm;
                        text-transform: uppercase;
                        letter-spacing: 1.5px;
                    }
                </style>
            </head>
            <body>
                ${Object.entries(t).map(([e,t])=>{let a=[];for(let e=0;e<t.length;e+=10)a.push(t.slice(e,e+10));return a.map(t=>`
                        <div class="slips-container">
                            <div class="class-header">CLASS: ${e}</div>
                            ${t.map(e=>`
                                <div class="slip">
                                    <div class="header">
                                        ${j?.schoolLogo?`<img src="${j.schoolLogo}" class="logo-mini" />`:""}
                                        <div>
                                            <div class="school-name">${j?.schoolName}</div>
                                            <div class="title">FEE REMINDER SLIP</div>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <span class="label">Student:</span>
                                        <span class="value">${e.name.toUpperCase()}</span>
                                    </div>
                                    <div class="row">
                                        <span class="label">ID / Class:</span>
                                        <span class="value">${e.id} (${e.class}) ${e.section?`- ${e.section}`:""}</span>
                                    </div>
                                    <div class="row">
                                        <span class="label">Print Date:</span>
                                        <span class="value">${e.printDate}</span>
                                    </div>
                                    
                                    <div style="margin: 0.5mm 0; border-top: 1pt solid #000;"></div>
                                    
                                    <table class="fee-table">
                                        <thead>
                                            <tr>
                                                <th>Fee Particulars</th>
                                                <th style="text-align:right">Pending Amount</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${(e.pendingTerms||[]).map(e=>`
                                                <tr>
                                                    <td>${e.name}</td>
                                                    <td class="amount" style="color:#d32f2f">₹${e.pending}</td>
                                                </tr>
                                            `).join("")}
                                            ${e.busPending>0?`
                                                <tr>
                                                    <td>Transport Fee</td>
                                                    <td class="amount">₹${e.busPending}</td>
                                                </tr>
                                            `:""}
                                            ${e.customPending>0?`
                                                <tr>
                                                    <td>Other Fees</td>
                                                    <td class="amount">₹${e.customPending}</td>
                                                </tr>
                                            `:""}
                                        </tbody>
                                    </table>

                                    <div class="total-box-horizontal">
                                        <span class="total-label">PLEASE PAY TOTAL:</span>
                                        <span class="total-value">₹${e.totalPending}</span>
                                    </div>
                                    
                                    <div class="footer">Kindly clear the dues at office. Thank you.</div>
                                </div>
                            `).join("")}
                        </div>
                    `).join("")}).join("")}
                <script>
                    window.onload = () => { window.print(); window.close(); };
                </script>
            </body>
            </html>
        `;e.document.write(a),e.document.close()},children:[(0,t.jsx)(n.Printer,{className:"w-5 h-5"})," Print All Slips"]}),(0,t.jsx)(x.Button,{variant:"ghost",className:"h-12 px-6",onClick:()=>d(!1),children:"Close"})]})]})]})]})]})}function L(){let[e,S]=(0,a.useState)([]),[T,D]=(0,a.useState)(!0),[L,$]=(0,a.useState)(""),[F,A]=(0,a.useState)("all"),[R,z]=(0,a.useState)("all"),I=(0,C.useRouter)(),{user:E}=(0,v.useAuth)(),[B,M]=(0,a.useState)(!1),[O,V]=(0,a.useState)("table"),[H,_]=(0,a.useState)([]),[U,K]=(0,a.useState)([]),[W,q]=(0,a.useState)(!1),{classes:G,villages:X,branding:Y}=(0,g.useMasterData)(),J=Object.values(G||{}).map(e=>({id:e.id,name:e.name,order:e.order||99})).sort((e,t)=>e.order-t.order),Q=Object.values(X||{}).map(e=>({id:e.id,name:e.name})).sort((e,t)=>e.name.localeCompare(t.name)),Z=async()=>{try{let e=(0,s.query)((0,s.collection)(l.db,"student_fee_ledgers"),(0,s.where)("status","==","PENDING")),t=(await (0,s.getDocs)(e)).docs.map(e=>{let t=e.data();return{id:e.id,...t,pendingAmount:(t.totalFee||0)-(t.totalPaid||0)}}).filter(e=>e.pendingAmount>0),a=await (0,s.getDocs)((0,s.collection)(l.db,"students")),r={};a.docs.forEach(e=>{let t=e.data();t.schoolId&&"ACTIVE"===t.status&&(r[t.schoolId]=t)});let i=t.map(e=>{let t=r[e.studentId];if(!t)return null;let a=e.items?.find(e=>"TRANSPORT"===e.type),s=a?.amount||0,l=e.items?.filter(e=>"CUSTOM"===e.type),i=l?.reduce((e,t)=>e+(t.amount||0),0)||0;return{...e,parentName:t.parentName||"N/A",parentMobile:t.parentMobile||"N/A",villageId:t.villageId||"",villageName:t.villageName||"N/A",sectionName:t.sectionName||"",transportFee:s,customFee:i}}).filter(Boolean).sort((e,t)=>t.pendingAmount-e.pendingAmount);S(i)}catch(e){console.error("Fetch Pendings Error:",e)}finally{D(!1)}};(0,a.useEffect)(()=>{Z()},[]);let ee=e.filter(e=>{let t=!L||e.studentId?.toLowerCase().includes(L.toLowerCase())||e.studentName?.toLowerCase().includes(L.toLowerCase())||e.parentName?.toLowerCase().includes(L.toLowerCase())||e.parentMobile?.toLowerCase().includes(L.toLowerCase())||e.villageName?.toLowerCase().includes(L.toLowerCase())||e.className?.toLowerCase().includes(L.toLowerCase()),a="all"===F||e.classId===F||e.className===F,s="all"===R||e.villageId===R||e.villageName===R;return t&&a&&s}),et=async()=>{if("notify"===O){q(!0);try{let e=await E?.getIdToken(),t=await fetch("/api/admin/fees/notify",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({selectedClasses:H,selectedVillages:U})}),a=await t.json();if(a.success)(0,y.toast)({title:"Notifications Sent",description:a.message,type:"success"}),M(!1);else throw Error(a.error||"Failed to send notifications")}catch(e){(0,y.toast)({title:"Error",description:e.message,type:"error"})}finally{q(!1)}return}let t=e.filter(e=>{let t=0===H.length||H.includes(e.classId)||H.includes(e.className),a=0===U.length||U.includes(e.villageId)||U.includes(e.villageName);return t&&a});if("csv"===O){let e,a,s;e=new Blob([[["School ID","Student Name","Parent Name","Mobile","Village","Class","Term Fee","Transport Fee","Custom Fee","Total Fee","Paid","Pending Balance"],...t.map(e=>[e.studentId,e.studentName,e.parentName,e.parentMobile||"",e.villageName,e.className,(e.totalFee||0)-(e.transportFee||0)-(e.customFee||0),e.transportFee||0,e.customFee||0,e.totalFee,e.totalPaid,e.pendingAmount])].map(e=>e.join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),s=URL.createObjectURL(e),a.setAttribute("href",s),a.setAttribute("download",`pending_dues_${new Date().toISOString().split("T")[0]}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),M(!1)}else(e=>{let t=window.open("","_blank");if(!t)return;let a=new Date().toLocaleString(),s=e.reduce((e,t)=>e+(t.pendingAmount||0),0),l=`
                <html>
                <head>
                    <title>Dues Report</title>
                    <style>
                        body { font-family: sans-serif; padding: 20px; color: #333; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 11px; }
                        th { background-color: #f2f2f2; }
                        h1 { text-align: center; color: #cc0000; margin-bottom: 5px; }
                        .header-meta { text-align: center; font-size: 12px; color: #666; margin-bottom: 20px; }
                        .summary { margin: 20px 0; font-weight: bold; border: 1px solid #ffcccc; padding: 10px; background: #fff5f5; border-radius: 5px; }
                        .branding { display: flex; align-items: center; justify-content: center; gap: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 20px; }
                        .school-info h1 { margin: 0; font-size: 24px; text-align: left; }
                        .school-info p { margin: 2px 0; font-size: 12px; color: #666; }
                    </style>
                </head>
                <body>
                    <div class="branding">
                        ${Y?.schoolLogo?`<img src="${Y.schoolLogo}" style="height: 60px;" />`:""}
                        <div class="school-info">
                            <h1>${Y?.schoolName}</h1>
                            <p>${Y?.address||""}</p>
                            <p><strong>Pending Dues Report</strong> | ${a}</p>
                        </div>
                    </div>
                    <div class="summary">
                        Total Outstanding: ₹${s.toLocaleString()} | Total Pending Accounts: ${e.length}
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Student Name</th>
                                <th>Class & Sec</th>
                                <th>Village</th>
                                <th>Parent Name</th>
                                <th>Parent Mobile</th>
                                <th>Transport Fee</th>
                                <th>Custom Fees</th>
                                <th>Total Fee</th>
                                <th>Paid</th>
                                <th style="background: #ffe6e6;">Balance Due</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${e.map(e=>`
                                <tr>
                                    <td style="font-weight:bold;">${e.studentName}</td>
                                    <td>${e.className} - ${e.sectionName||""}</td>
                                    <td>${e.villageName}</td>
                                    <td>${e.parentName}</td>
                                    <td style="font-weight:bold; color: #1a56db;">${e.parentMobile||""}</td>
                                    <td>₹${(e.transportFee||0).toLocaleString()}</td>
                                    <td>₹${(e.customFee||0).toLocaleString()}</td>
                                    <td>₹${e.totalFee?.toLocaleString()}</td>
                                    <td>₹${e.totalPaid?.toLocaleString()}</td>
                                    <td style="color:red; font-weight:black; font-size: 13px;">₹${e.pendingAmount?.toLocaleString()}</td>
                                </tr>
                            `).join("")}
                        </tbody>
                    </table>
                    <script>
                        window.onload = () => { window.print(); window.close(); };
                    </script>
                </body>
                </html>
            `;t.document.write(l),t.document.close(),M(!1)})(t)},ea=ee.reduce((e,t)=>e+(t.pendingAmount||0),0);return(0,t.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500 max-w-none p-0 pb-20",children:[(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between pt-4 gap-6 px-2 md:px-0",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl md:text-5xl font-display font-bold bg-gradient-to-r from-red-500 to-orange-400 bg-clip-text text-transparent italic leading-tight",children:"Pending Dues"}),(0,t.jsxs)("p",{className:"text-muted-foreground text-sm md:text-lg tracking-tight",children:["Recovering ",(0,t.jsx)("span",{className:"text-white font-bold",children:"outstanding school fees"})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2 md:gap-3",children:[(0,t.jsxs)(x.Button,{variant:"destructive",className:"h-11 gap-2 bg-red-600/10 border-red-500/20 text-red-400 rounded-xl hover:bg-red-600 hover:text-white transition-all shadow-lg shadow-red-500/10",onClick:()=>{V("notify"),M(!0)},children:[(0,t.jsx)(o.Bell,{size:16})," ",(0,t.jsx)("span",{className:"hidden sm:inline",children:"Bulk Notify"}),(0,t.jsx)("span",{className:"sm:hidden",children:"Notify"})]}),(0,t.jsx)(P,{students:e.map(e=>({schoolId:e.studentId,studentName:e.studentName,className:e.className,sectionName:e.sectionName||""}))}),(0,t.jsxs)(x.Button,{variant:"outline",onClick:()=>{V("table"),M(!0)},className:"h-11 gap-2 border-white/10 bg-white/5 rounded-xl hover:bg-white/10",children:[(0,t.jsx)(n.Printer,{size:16})," ",(0,t.jsx)("span",{className:"hidden sm:inline",children:"Print Dues List"}),(0,t.jsx)("span",{className:"sm:hidden",children:"Print"})]}),(0,t.jsxs)(x.Button,{variant:"outline",onClick:()=>{V("csv"),M(!0)},className:"h-11 gap-2 border-white/10 bg-white/5 rounded-xl hover:bg-white/10",children:[(0,t.jsx)(i.Download,{size:16})," ",(0,t.jsx)("span",{className:"hidden sm:inline",children:"Export CSV"}),(0,t.jsx)("span",{className:"sm:hidden",children:"CSV"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 px-2 md:px-0",children:[(0,t.jsxs)("div",{className:"bg-red-500/5 border border-red-500/10 p-5 rounded-2xl backdrop-blur-sm shadow-xl flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-2xl bg-red-500/20 flex items-center justify-center",children:(0,t.jsx)(h.ShieldAlert,{size:24,className:"text-red-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[10px] font-black uppercase tracking-widest text-red-400 mb-0.5 italic",children:"Total Outstanding"}),(0,t.jsxs)("div",{className:"text-3xl font-mono font-black text-white",children:["₹",ea.toLocaleString()]})]})]}),(0,t.jsxs)("div",{className:"bg-orange-500/5 border border-orange-500/10 p-5 rounded-2xl backdrop-blur-sm shadow-xl flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-2xl bg-orange-500/20 flex items-center justify-center",children:(0,t.jsx)(c.User,{size:24,className:"text-orange-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[10px] font-black uppercase tracking-widest text-orange-400 mb-0.5 italic",children:"Pending Accounts"}),(0,t.jsxs)("div",{className:"text-3xl font-mono font-black text-white",children:[ee.length," ",(0,t.jsx)("span",{className:"text-xs text-orange-400/50",children:"Students"})]})]})]})]}),(0,t.jsxs)("div",{className:"bg-black/20 p-4 md:p-5 rounded-2xl border border-white/10 backdrop-blur-md space-y-4 shadow-2xl mx-2 md:mx-0",children:[(0,t.jsxs)("div",{className:"relative w-full",children:[(0,t.jsx)(d.Search,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,t.jsx)(p.Input,{placeholder:"Search by student name, parent, or mobile...",className:"pl-11 h-12 bg-white/5 border-white/10 rounded-xl focus:ring-accent/30",value:L,onChange:e=>$(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:flex lg:flex-wrap gap-2",children:[(0,t.jsxs)(f.Select,{value:F,onValueChange:A,children:[(0,t.jsx)(f.SelectTrigger,{className:"w-full lg:w-[180px] h-12 bg-white/5 border-white/10 rounded-xl",children:(0,t.jsx)(f.SelectValue,{placeholder:"All Classes"})}),(0,t.jsxs)(f.SelectContent,{className:"bg-zinc-900 border-white/10 text-white",children:[(0,t.jsx)(f.SelectItem,{value:"all",children:"All Classes"}),J.map(e=>(0,t.jsx)(f.SelectItem,{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)(f.Select,{value:R,onValueChange:z,children:[(0,t.jsx)(f.SelectTrigger,{className:"w-full lg:w-[180px] h-12 bg-white/5 border-white/10 rounded-xl",children:(0,t.jsx)(f.SelectValue,{placeholder:"All Villages"})}),(0,t.jsxs)(f.SelectContent,{className:"bg-zinc-900 border-white/10 text-white",children:[(0,t.jsx)(f.SelectItem,{value:"all",children:"All Villages"}),Q.map(e=>(0,t.jsx)(f.SelectItem,{value:e.id,children:e.name},e.id))]})]}),("all"!==F||"all"!==R||L)&&(0,t.jsx)(x.Button,{variant:"ghost",size:"sm",onClick:()=>{$(""),A("all"),z("all")},className:"h-12 px-6 text-[10px] font-black uppercase tracking-widest text-muted-foreground hover:text-white rounded-xl border border-dashed border-white/10 transition-all",children:"Clear Filters"})]})]}),(0,t.jsx)(b.DataTable,{data:ee,isLoading:T,onRowClick:e=>I.push(`/admin/students/${e.studentDocId||e.id}`),columns:[{key:"studentName",header:"Student Info",render:e=>(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center border border-white/5",children:(0,t.jsx)(c.User,{size:14,className:"text-white/40"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-bold text-sm text-white leading-tight group-hover:text-red-400 transition-colors uppercase",children:e.studentName}),(0,t.jsx)("span",{className:"text-[10px] font-mono text-white/40 tracking-tighter uppercase",children:e.studentId})]})]})},{key:"className",header:"Class & Village",render:e=>(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("span",{className:"text-[10px] uppercase font-black text-muted-foreground tracking-tighter bg-white/5 px-2 py-0.5 rounded border border-white/5 w-fit",children:e.className}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-white/30",children:[(0,t.jsx)(m.MapPin,{size:10}),(0,t.jsx)("span",{className:"truncate max-w-[120px]",children:e.villageName})]})]})},{key:"totalFee",header:"Total Fee",headerClassName:"text-right",cellClassName:"text-right",render:e=>(0,t.jsxs)("span",{className:"font-mono font-bold text-sm text-white/40 italic",children:["₹",e.totalFee?.toLocaleString()]})},{key:"totalPaid",header:"Paid",headerClassName:"text-right",cellClassName:"text-right",render:e=>(0,t.jsxs)("span",{className:"font-mono font-black text-sm text-emerald-400/60",children:["₹",e.totalPaid?.toLocaleString()]})},{key:"pendingAmount",header:"Balance Due",headerClassName:"text-right",cellClassName:"text-right",render:e=>(0,t.jsxs)("div",{className:"flex flex-col items-end",children:[(0,t.jsxs)("span",{className:"font-mono font-black text-lg text-red-500",children:["₹",e.pendingAmount?.toLocaleString()]}),e.totalPaid>0&&(0,t.jsx)("span",{className:"text-[8px] font-black text-emerald-500/50 uppercase tracking-tighter",children:"Partially Paid"})]})},{key:"parentName",header:"Parent Info",render:e=>(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-white/90",children:e.parentName||"N/A"}),(0,t.jsx)("span",{className:"text-[10px] font-mono text-emerald-400",children:e.parentMobile||"N/A"})]})},{key:"breakdown",header:"Breakdown",render:e=>(0,t.jsxs)("div",{className:"flex flex-col gap-0.5 text-[10px]",children:[(0,t.jsxs)("span",{className:"text-white/40 italic",children:["Transport: ₹",e.transportFee||0]}),(0,t.jsxs)("span",{className:"text-white/40 italic",children:["Custom: ₹",e.customFee||0]})]})},{key:"status",header:"Status",headerClassName:"text-center",cellClassName:"text-center",render:e=>(0,t.jsx)(u.Badge,{variant:"destructive",className:"text-[9px] font-black uppercase tracking-tighter py-0 h-5 border-none bg-red-500/20 text-red-400 hover:bg-red-500/30",children:e.status})}],actions:e=>(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsx)(x.Button,{variant:"ghost",onClick:()=>I.push(`/admin/students/${e.studentDocId||e.id}`),className:"w-full justify-start gap-2 h-9 text-xs font-bold uppercase tracking-tighter text-red-400 hover:text-white hover:bg-red-500/20",children:"Collect Fees"})})}),(0,t.jsx)(w.Dialog,{open:B,onOpenChange:M,children:(0,t.jsxs)(w.DialogContent,{className:"max-w-2xl bg-[#0A192F] border-white/10 text-white shadow-2xl backdrop-blur-3xl rounded-3xl",children:[(0,t.jsx)(w.DialogHeader,{children:(0,t.jsx)(w.DialogTitle,{className:"text-2xl font-display font-bold italic bg-gradient-to-r from-red-500 to-orange-400 bg-clip-text text-transparent",children:"notify"===O?"Fee Notification Wizard":"Report Configuration"})}),(0,t.jsxs)("div",{className:"space-y-6 py-4",children:["notify"===O&&(0,t.jsxs)("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-2xl text-[11px] text-red-200/80 leading-relaxed italic",children:[(0,t.jsx)("strong",{className:"text-red-400 block mb-1",children:"Warning:"}),"Bulk notifications will be sent to parents of students with outstanding dues in the selected categories. This action is tracked in the system audit logs."]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-3 p-4 bg-white/5 rounded-2xl border border-white/5",children:[(0,t.jsx)(j.Label,{className:"text-[10px] font-black uppercase tracking-widest text-emerald-400",children:"Target Classes"}),(0,t.jsxs)("div",{className:"max-h-[300px] overflow-y-auto space-y-2 pr-2 custom-scrollbar",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 pb-2 border-b border-white/5",children:[(0,t.jsx)(N.Checkbox,{id:"all-classes",className:"border-white/20 data-[state=checked]:bg-emerald-500 data-[state=checked]:border-emerald-500",checked:0===H.length,onCheckedChange:e=>e?_([]):null}),(0,t.jsx)(j.Label,{htmlFor:"all-classes",className:"text-sm font-bold opacity-80 cursor-pointer",children:"All Classes"})]}),J.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-3 py-1",children:[(0,t.jsx)(N.Checkbox,{id:`class-${e.id}`,className:"border-white/10 data-[state=checked]:bg-emerald-500 data-[state=checked]:border-emerald-500",checked:H.includes(e.id),onCheckedChange:t=>{t?_([...H,e.id]):_(H.filter(t=>t!==e.id))}}),(0,t.jsx)(j.Label,{htmlFor:`class-${e.id}`,className:"text-xs font-medium opacity-60 cursor-pointer hover:opacity-100 transition-opacity",children:e.name})]},e.id))]})]}),(0,t.jsxs)("div",{className:"space-y-3 p-4 bg-white/5 rounded-2xl border border-white/5",children:[(0,t.jsx)(j.Label,{className:"text-[10px] font-black uppercase tracking-widest text-cyan-400",children:"Target Villages"}),(0,t.jsxs)("div",{className:"max-h-[300px] overflow-y-auto space-y-2 pr-2 custom-scrollbar",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 pb-2 border-b border-white/5",children:[(0,t.jsx)(N.Checkbox,{id:"all-villages",className:"border-white/20 data-[state=checked]:bg-cyan-500 data-[state=checked]:border-cyan-500",checked:0===U.length,onCheckedChange:e=>e?K([]):null}),(0,t.jsx)(j.Label,{htmlFor:"all-villages",className:"text-sm font-bold opacity-80 cursor-pointer",children:"All Villages"})]}),Q.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-3 py-1",children:[(0,t.jsx)(N.Checkbox,{id:`village-${e.id}`,className:"border-white/10 data-[state=checked]:bg-cyan-500 data-[state=checked]:border-cyan-500",checked:U.includes(e.id),onCheckedChange:t=>{t?K([...U,e.id]):K(U.filter(t=>t!==e.id))}}),(0,t.jsx)(j.Label,{htmlFor:`village-${e.id}`,className:"text-xs font-medium opacity-60 cursor-pointer hover:opacity-100 transition-opacity",children:e.name})]},e.id))]})]})]})]}),(0,t.jsxs)(w.DialogFooter,{className:"gap-2",children:[(0,t.jsx)(x.Button,{variant:"ghost",onClick:()=>M(!1),className:"rounded-xl hover:bg-white/5",children:"Cancel"}),(0,t.jsxs)(x.Button,{className:(0,k.cn)("text-white font-black uppercase tracking-tighter gap-2 rounded-xl border-none shadow-lg transition-all","notify"===O?"bg-red-600 hover:bg-red-500 shadow-red-500/20":"bg-gradient-to-r from-emerald-600 to-cyan-600 hover:from-emerald-500 hover:to-cyan-500 shadow-emerald-500/20"),onClick:et,disabled:W,children:[W?(0,t.jsx)(r.Loader2,{className:"animate-spin",size:16}):"csv"===O?(0,t.jsx)(i.Download,{size:16}):"notify"===O?(0,t.jsx)(o.Bell,{size:16}):(0,t.jsx)(n.Printer,{size:16}),"notify"===O?"Dispatch Notifications":"Generate Dataset"]})]})]})})]})}e.s(["default",()=>L],91130)}]);