(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let r=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("rounded-2xl border border-[#64FFDA]/10 bg-[#112240]/40 backdrop-blur-lg text-white shadow-xl transition-all duration-300 hover:bg-[#112240]/60 hover:border-[#64FFDA]/30 hover:shadow-[0_0_20px_-5px_rgba(100,255,218,0.1)] group",e),...a}));r.displayName="Card";let i=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...a}));i.displayName="CardHeader";let l=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("h3",{ref:r,className:(0,s.cn)("font-bold text-xl tracking-tight text-white group-hover:text-accent transition-colors",e),...a}));l.displayName="CardTitle";let d=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("p",{ref:r,className:(0,s.cn)("text-sm text-white/60 font-medium",e),...a}));d.displayName="CardDescription";let o=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",e),...a}));o.displayName="CardContent",a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>o,"CardDescription",()=>d,"CardHeader",()=>i,"CardTitle",()=>l])},3281,e=>{"use strict";let t=(0,e.i(75254).default)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);e.s(["Printer",()=>t],3281)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},93479,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let r=a.forwardRef(({className:e,type:a,...r},i)=>(0,t.jsx)("input",{type:a,className:(0,s.cn)("flex h-12 w-full rounded-full border border-white/10 bg-[#282828] px-4 py-3 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all shadow-inner hover:bg-[#333]",e),ref:i,...r}));r.displayName="Input",e.s(["Input",()=>r])},10204,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(75157);let r=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("label",{ref:r,className:(0,s.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...a}));r.displayName="Label",e.s(["Label",()=>r])},76639,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(26999),r=e.i(37727),i=e.i(75157);let l=s.Root,d=s.Trigger,o=s.Portal;s.Close;let n=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)(s.Overlay,{ref:r,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a}));n.displayName=s.Overlay.displayName;let c=a.forwardRef(({className:e,children:a,...l},d)=>(0,t.jsxs)(o,{children:[(0,t.jsx)(n,{}),(0,t.jsxs)(s.Content,{ref:d,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...l,children:[a,(0,t.jsxs)(s.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(r.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));c.displayName=s.Content.displayName;let m=({className:e,...a})=>(0,t.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...a});m.displayName="DialogHeader";let x=({className:e,...a})=>(0,t.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...a});x.displayName="DialogFooter";let h=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)(s.Title,{ref:r,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",e),...a}));h.displayName=s.Title.displayName;let p=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)(s.Description,{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",e),...a}));p.displayName=s.Description.displayName,e.s(["Dialog",()=>l,"DialogContent",()=>c,"DialogDescription",()=>p,"DialogFooter",()=>x,"DialogHeader",()=>m,"DialogTitle",()=>h,"DialogTrigger",()=>d])},27516,e=>{"use strict";let t=(0,e.i(75254).default)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);e.s(["History",()=>t],27516)},88511,e=>{"use strict";let t=(0,e.i(75254).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>t],88511)},70756,e=>{"use strict";let t=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],70756)},87828,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(76639),r=e.i(19455),i=e.i(93479),l=e.i(10204),d=e.i(31278),o=e.i(70756),n=e.i(78894),c=e.i(32341),m=e.i(80691);function x({isOpen:e,onClose:x,user:h,onSuccess:p}){let{user:u}=(0,c.useAuth)(),[f,g]=(0,a.useState)(""),[y,b]=(0,a.useState)(!1);if(!h)return null;let v=async e=>{if(e.preventDefault(),!h.uid)return void(0,m.toast)({title:"Error",description:"User has no linked account.",type:"error"});b(!0);try{let e=await fetch("/api/admin/users/reset-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await u?.getIdToken()}`},body:JSON.stringify({targetUid:h.uid,schoolId:h.schoolId,role:h.role,newPassword:f})}),t=await e.json();t.success?((0,m.toast)({title:"Password Changed",description:`Proactively updated password for ${h.name}.`,type:"success"}),g(""),p&&p(),x()):(0,m.toast)({title:"Reset Failed",description:t.error||"Could not change password.",type:"error"})}catch(e){(0,m.toast)({title:"Error",description:e.message||"An unexpected error occurred.",type:"error"})}finally{b(!1)}};return(0,t.jsx)(s.Dialog,{open:e,onOpenChange:x,children:(0,t.jsxs)(s.DialogContent,{className:"bg-zinc-950 border-white/10 text-white sm:max-w-[425px]",children:[(0,t.jsxs)(s.DialogHeader,{children:[(0,t.jsxs)(s.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(o.Lock,{className:"w-5 h-5 text-amber-500"}),"Reset Password"]}),(0,t.jsxs)(s.DialogDescription,{children:["Set a new password for ",(0,t.jsx)("span",{className:"font-bold text-white",children:h.name})," (",h.schoolId,")."]})]}),(0,t.jsxs)("form",{onSubmit:v,className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"p-3 bg-amber-500/10 border border-amber-500/20 rounded-lg text-xs text-amber-500 flex gap-2",children:[(0,t.jsx)(n.AlertTriangle,{className:"w-4 h-4 shrink-0"}),(0,t.jsx)("p",{children:"This will immediately update the user's password and log them out of all devices."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{children:"New Password"}),(0,t.jsx)(i.Input,{value:f,onChange:e=>g(e.target.value),className:"bg-black/20",placeholder:"Enter new password",required:!0,minLength:6})]}),(0,t.jsxs)(s.DialogFooter,{children:[(0,t.jsx)(r.Button,{type:"button",variant:"ghost",onClick:x,disabled:y,children:"Cancel"}),(0,t.jsxs)(r.Button,{type:"submit",className:"bg-amber-600 hover:bg-amber-700 text-white",disabled:y,children:[y?(0,t.jsx)(d.Loader2,{className:"animate-spin w-4 h-4 mr-2"}):null,"Update Password"]})]})]})]})})}e.s(["AdminChangePasswordModal",()=>x])},22915,e=>{"use strict";let t=(0,e.i(75254).default)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);e.s(["Archive",()=>t],22915)},29592,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(25913),r=e.i(75157);let i=(0,s.cva)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=a.forwardRef(({className:e,variant:a,...s},l)=>(0,t.jsx)("div",{ref:l,role:"alert",className:(0,r.cn)(i({variant:a}),e),...s}));l.displayName="Alert";let d=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)("h5",{ref:s,className:(0,r.cn)("mb-1 font-medium leading-none tracking-tight",e),...a}));d.displayName="AlertTitle";let o=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)("div",{ref:s,className:(0,r.cn)("text-sm [&_p]:leading-relaxed",e),...a}));o.displayName="AlertDescription",e.s(["Alert",()=>l,"AlertDescription",()=>o,"AlertTitle",()=>d])},51537,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(76639),r=e.i(19455),i=e.i(93479),l=e.i(10204),d=e.i(29592),o=e.i(78894),n=e.i(70756),c=e.i(27612),m=e.i(22915),x=e.i(31278),h=e.i(75157),p=e.i(80691);function u({isOpen:e,onClose:u,user:g,checkEligibility:y,onDeactivate:b,onDelete:v}){let[w,N]=(0,a.useState)("deactivate"),[j,D]=(0,a.useState)(!1),[k,A]=(0,a.useState)(null),[C,T]=(0,a.useState)(""),[R,L]=(0,a.useState)("");(0,a.useEffect)(()=>{e&&(N("deactivate"),T(""),L(""),A(null),y().then(A))},[e,y]);let M="DELETE",z=C===M,S=async()=>{if("delete"!==w||z){D(!0);try{"deactivate"===w?(await b(R||"Admin request"),(0,p.toast)({title:"User Deactivated",description:`${g.name} has been deactivated.`,type:"success"})):(await v(R||"Admin request"),(0,p.toast)({title:"User Deleted",description:`${g.name} has been permanently deleted.`,type:"success"})),u()}catch(e){console.error(e),(0,p.toast)({title:"Action Failed",description:e.message||"Something went wrong. Please try again.",type:"error"})}finally{D(!1)}}};return(0,t.jsx)(s.Dialog,{open:e,onOpenChange:u,children:(0,t.jsxs)(s.DialogContent,{className:"sm:max-w-md bg-black/95 border-white/10 text-white backdrop-blur-xl",children:[(0,t.jsxs)(s.DialogHeader,{children:[(0,t.jsx)(s.DialogTitle,{className:"text-xl font-bold flex items-center gap-2",children:"delete"===w?(0,t.jsxs)("span",{className:"text-red-500 flex items-center gap-2",children:[(0,t.jsx)(c.Trash2,{className:"w-5 h-5"})," Permanent Delete"]}):(0,t.jsxs)("span",{className:"text-yellow-500 flex items-center gap-2",children:[(0,t.jsx)(m.Archive,{className:"w-5 h-5"})," Deactivate User"]})}),(0,t.jsxs)(s.DialogDescription,{className:"text-zinc-400",children:["Managing access for ",(0,t.jsx)("span",{className:"text-white font-medium",children:g.name})," (",g.schoolId,")"]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 bg-white/5 p-1 rounded-lg",children:[(0,t.jsxs)("button",{onClick:()=>N("deactivate"),className:(0,h.cn)("flex items-center justify-center gap-2 py-2 text-sm font-medium rounded-md transition-all","deactivate"===w?"bg-yellow-500/20 text-yellow-500":"text-zinc-500 hover:text-zinc-300"),children:[(0,t.jsx)(m.Archive,{className:"w-4 h-4"})," Deactivate"]}),(0,t.jsxs)("button",{onClick:()=>N("delete"),disabled:!k?.canDelete&&!g.isDemo,className:(0,h.cn)("flex items-center justify-center gap-2 py-2 text-sm font-medium rounded-md transition-all","delete"===w?"bg-red-500/20 text-red-500":k?.canDelete||g.isDemo?"text-zinc-500 hover:text-zinc-300":"opacity-50 cursor-not-allowed text-zinc-600"),children:[!k?.canDelete&&!g.isDemo&&(0,t.jsx)(n.Lock,{className:"w-3 h-3"})," ",(0,t.jsx)(c.Trash2,{className:"w-4 h-4"})," Hard Delete"]})]}),"deactivate"===w&&(0,t.jsxs)("div",{className:"space-y-4 animate-in fade-in zoom-in-95 duration-200",children:[(0,t.jsxs)(d.Alert,{className:"bg-yellow-500/10 border-yellow-500/20",children:[(0,t.jsx)(o.AlertTriangle,{className:"h-4 w-4 text-yellow-500"}),(0,t.jsx)(d.AlertTitle,{className:"text-yellow-500",children:"Recommended Action"}),(0,t.jsx)(d.AlertDescription,{className:"text-yellow-500/80 text-xs",children:"Deactivation immediately revokes login access but preserves historical records (payments, grades, etc.). This is reversible."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{className:"text-xs uppercase text-zinc-500",children:"Reason (Optional)"}),(0,t.jsx)(i.Input,{className:"bg-black/40 border-white/10",placeholder:"e.g. Graduated, Left School",value:R,onChange:e=>L(e.target.value)})]})]}),"delete"===w&&(0,t.jsx)("div",{className:"space-y-4 animate-in fade-in zoom-in-95 duration-200",children:k?.canDelete||g.isDemo?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.Alert,{className:"bg-red-500/10 border-red-500/20",children:[(0,t.jsx)(f,{}),(0,t.jsx)(d.AlertTitle,{className:"text-red-500 font-bold",children:"ACCOUNT DELETION (ARCHIVE)"}),(0,t.jsxs)(d.AlertDescription,{className:"text-red-500/80 text-xs mt-1",children:["This action will deactivate the user account and mark it as ",(0,t.jsx)("strong",{children:"DELETED"}),". All data will be archived and preserved. The user will no longer be able to log in.",(0,t.jsx)("br",{className:"my-2"}),"This action can be reversed by an administrator."]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{className:"text-xs uppercase text-red-400",children:"Type Confirmation"}),(0,t.jsx)("div",{className:"bg-black/40 p-2 rounded border border-red-500/20 text-center font-mono text-xs select-all text-red-300",children:M}),(0,t.jsx)(i.Input,{className:"bg-black/40 border-red-500/30 text-red-500 focus-visible:ring-red-500",placeholder:M,value:C,onChange:e=>T(e.target.value),onPaste:e=>e.preventDefault()})]})]}):(0,t.jsxs)(d.Alert,{className:"bg-red-900/20 border-red-500/20",children:[(0,t.jsx)(n.Lock,{className:"h-4 w-4 text-red-500"}),(0,t.jsx)(d.AlertTitle,{className:"text-red-500",children:"Deletion Blocked"}),(0,t.jsx)(d.AlertDescription,{className:"text-red-400/80 text-xs mt-1",children:k?.reason||"This user has linked records and cannot be hard deleted."})]})})]}),(0,t.jsxs)(s.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,t.jsx)(r.Button,{variant:"ghost",onClick:u,disabled:j,children:"Cancel"}),(0,t.jsxs)(r.Button,{disabled:j||"delete"===w&&!z,className:(0,h.cn)("delete"===w?"bg-red-600 hover:bg-red-700 text-white":"bg-yellow-600 hover:bg-yellow-700 text-white"),onClick:S,children:[j&&(0,t.jsx)(x.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"delete"===w?"Delete Permanently":"Confirm Deactivation"]})]})]})})}function f(){return(0,t.jsx)(o.AlertTriangle,{className:"h-4 w-4 text-red-500"})}e.s(["DeleteUserModal",()=>u])},16715,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},84765,e=>{"use strict";let t=(0,e.i(75254).default)("settings-2",[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);e.s(["Settings2",()=>t],84765)},90281,e=>{"use strict";e.i(36180);var t=e.i(98925),a=e.i(59141);let s=async e=>{try{await (0,t.addDoc)((0,t.collection)(a.db,"notifications"),{...e,status:"UNREAD",createdAt:t.Timestamp.now()})}catch(e){console.error("Failed to create notification:",e)}},r=async e=>{await s({...e,target:"ALL_ADMINS",title:`[Manager Action] ${e.title}`}),(e.userId||e.target&&"ALL_ADMINS"!==e.target)&&await s(e)};e.s(["notifyManagerAction",0,r])}]);