(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var a=e.i(43476),s=e.i(71645),t=e.i(75157);let r=s.forwardRef(({className:e,...s},r)=>(0,a.jsx)("div",{ref:r,className:(0,t.cn)("rounded-2xl border border-[#64FFDA]/10 bg-[#112240]/40 backdrop-blur-lg text-white shadow-xl transition-all duration-300 hover:bg-[#112240]/60 hover:border-[#64FFDA]/30 hover:shadow-[0_0_20px_-5px_rgba(100,255,218,0.1)] group",e),...s}));r.displayName="Card";let i=s.forwardRef(({className:e,...s},r)=>(0,a.jsx)("div",{ref:r,className:(0,t.cn)("flex flex-col space-y-1.5 p-6",e),...s}));i.displayName="CardHeader";let l=s.forwardRef(({className:e,...s},r)=>(0,a.jsx)("h3",{ref:r,className:(0,t.cn)("font-bold text-xl tracking-tight text-white group-hover:text-accent transition-colors",e),...s}));l.displayName="CardTitle";let d=s.forwardRef(({className:e,...s},r)=>(0,a.jsx)("p",{ref:r,className:(0,t.cn)("text-sm text-white/60 font-medium",e),...s}));d.displayName="CardDescription";let c=s.forwardRef(({className:e,...s},r)=>(0,a.jsx)("div",{ref:r,className:(0,t.cn)("p-6 pt-0",e),...s}));c.displayName="CardContent",s.forwardRef(({className:e,...s},r)=>(0,a.jsx)("div",{ref:r,className:(0,t.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>c,"CardDescription",()=>d,"CardHeader",()=>i,"CardTitle",()=>l])},56909,e=>{"use strict";let a=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>a],56909)},81743,e=>{"use strict";var a=e.i(43476),s=e.i(71645);e.i(36180);var t=e.i(98925),r=e.i(59141),i=e.i(19455),l=e.i(67489),d=e.i(15288),c=e.i(31278),n=e.i(56909),o=e.i(72498),m=e.i(32341);function h(){let{user:e}=(0,m.useAuth)(),{classes:h,subjects:x}=(0,o.useMasterData)(),[u,f]=(0,s.useState)(!0),[p,g]=(0,s.useState)("2025-2026"),j=Object.values(h).map(e=>({id:e.id,name:e.name,order:e.order||99})).sort((e,a)=>e.order-a.order),[b,v]=(0,s.useState)([]),[y,w]=(0,s.useState)([]),[N,C]=(0,s.useState)(""),[S,T]=(0,s.useState)({}),[A,k]=(0,s.useState)(!1);(0,s.useEffect)(()=>{I()},[]),(0,s.useEffect)(()=>{v(Object.values(x||{}).filter(e=>!1!==e.isActive).sort((e,a)=>e.name.localeCompare(a.name)))},[x]),(0,s.useEffect)(()=>{N?R(N):T({})},[N]);let I=async()=>{try{let e=await (0,t.getDocs)((0,t.query)((0,t.collection)(r.db,"teachers"),(0,t.where)("status","==","ACTIVE")));w(e.docs.map(e=>({id:e.id,...e.data()})))}catch(e){console.error(e)}finally{f(!1)}},R=async e=>{f(!0);try{let a=await fetch(`/api/admin/timetable/assign?yearId=${p}&classId=${e}`),s=await a.json();s.success&&s.data&&T(s.data.assignments||{})}catch(e){console.error(e)}finally{f(!1)}},V=async()=>{if(N&&e){k(!0);try{let a=await e.getIdToken(),s=await fetch("/api/admin/timetable/assign",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({yearId:p,classId:N,assignments:S})}),t=await s.json();t.success?alert("Assignments Saved!"):alert("Error: "+t.error)}catch(e){alert("Error: "+e.message)}finally{k(!1)}}};return u&&0===j.length?(0,a.jsx)("div",{className:"p-10 flex justify-center",children:(0,a.jsx)(c.Loader2,{className:"animate-spin"})}):(0,a.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto p-6 animate-in fade-in",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-display font-bold",children:"Teaching Assignments"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Assign teachers to subjects for each class."})]}),(0,a.jsx)("div",{className:"w-[200px]",children:(0,a.jsxs)(l.Select,{value:N,onValueChange:C,children:[(0,a.jsx)(l.SelectTrigger,{className:"bg-white/5 border-white/10",children:(0,a.jsx)(l.SelectValue,{placeholder:"Select Class"})}),(0,a.jsx)(l.SelectContent,{children:j.map(e=>(0,a.jsx)(l.SelectItem,{value:e.id,children:e.name},e.id))})]})})]}),N?(0,a.jsxs)(d.Card,{className:"bg-black/20 border-white/10",children:[(0,a.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,a.jsxs)(d.CardTitle,{children:["Subject Mapping for ",j.find(e=>e.id===N)?.name]}),(0,a.jsxs)(i.Button,{onClick:V,disabled:A,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:[A?(0,a.jsx)(c.Loader2,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(n.Save,{className:"w-4 h-4 mr-2"}),"Save Assignments"]})]}),(0,a.jsx)(d.CardContent,{className:"space-y-4",children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:b.map(e=>(0,a.jsxs)("div",{className:"p-4 rounded-lg bg-white/5 border border-white/10 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded bg-blue-500/10 flex items-center justify-center text-blue-400 font-bold",children:e.code||e.name.substring(0,2).toUpperCase()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.type||"Theory"})]})]}),(0,a.jsx)("div",{className:"w-[250px]",children:(0,a.jsxs)(l.Select,{value:S[e.id]||"unassigned",onValueChange:a=>{var s,t;return s=e.id,t="unassigned"===a?"":a,void T(e=>({...e,[s]:t}))},children:[(0,a.jsx)(l.SelectTrigger,{className:"bg-black/40 border-white/10 h-9",children:(0,a.jsx)(l.SelectValue,{placeholder:"Assign Teacher"})}),(0,a.jsxs)(l.SelectContent,{children:[(0,a.jsx)(l.SelectItem,{value:"unassigned",children:"-- Unassigned --"}),y.map(e=>(0,a.jsx)(l.SelectItem,{value:e.id,children:e.name},e.id))]})]})})]},e.id))})})]}):(0,a.jsx)("div",{className:"text-center py-20 text-muted-foreground border border-dashed border-white/10 rounded-lg",children:"Please select a class to begin assignments."})]})}e.s(["default",()=>h])}]);